import{r as Hv,g as La,e as ti,c as ma,a as Kv,E as du,_ as Vv}from"./index-0c2dd713.js";import{s as kv,f as Gv,d as Wv,g as Yv,a as ip,b as Jv,c as Xv,e as Zv,h as us,i as Ma,j as Ul,k as Qv,l as em,m as gu,p as tm,J as Ai,n as yu,o as _u,q as vu,r as xi,t as di,u as mu,v as np,H as Zi}from"./http-6f64bccf.js";var bu={},za={},Ue={},sp={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});function e(f,y){var d=f>>>16&65535,_=f&65535,I=y>>>16&65535,D=y&65535;return _*D+(d*D+_*I<<16>>>0)|0}i.mul=Math.imul||e;function t(f,y){return f+y|0}i.add=t;function s(f,y){return f-y|0}i.sub=s;function a(f,y){return f<<y|f>>>32-y}i.rotl=a;function c(f,y){return f<<32-y|f>>>y}i.rotr=c;function p(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}i.isInteger=Number.isInteger||p,i.MAX_SAFE_INTEGER=9007199254740991,i.isSafeInteger=function(f){return i.isInteger(f)&&f>=-i.MAX_SAFE_INTEGER&&f<=i.MAX_SAFE_INTEGER}})(sp);Object.defineProperty(Ue,"__esModule",{value:!0});var ap=sp;function rm(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])<<16>>16}Ue.readInt16BE=rm;function im(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])>>>0}Ue.readUint16BE=im;function nm(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])<<16>>16}Ue.readInt16LE=nm;function sm(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])>>>0}Ue.readUint16LE=sm;function op(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>8,e[t+1]=i>>>0,e}Ue.writeUint16BE=op;Ue.writeInt16BE=op;function cp(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e}Ue.writeUint16LE=cp;Ue.writeInt16LE=cp;function Bc(i,e){return e===void 0&&(e=0),i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}Ue.readInt32BE=Bc;function Hc(i,e){return e===void 0&&(e=0),(i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3])>>>0}Ue.readUint32BE=Hc;function Kc(i,e){return e===void 0&&(e=0),i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e]}Ue.readInt32LE=Kc;function Vc(i,e){return e===void 0&&(e=0),(i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e])>>>0}Ue.readUint32LE=Vc;function Aa(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>24,e[t+1]=i>>>16,e[t+2]=i>>>8,e[t+3]=i>>>0,e}Ue.writeUint32BE=Aa;Ue.writeInt32BE=Aa;function Ta(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e[t+2]=i>>>16,e[t+3]=i>>>24,e}Ue.writeUint32LE=Ta;Ue.writeInt32LE=Ta;function am(i,e){e===void 0&&(e=0);var t=Bc(i,e),s=Bc(i,e+4);return t*4294967296+s-(s>>31)*4294967296}Ue.readInt64BE=am;function om(i,e){e===void 0&&(e=0);var t=Hc(i,e),s=Hc(i,e+4);return t*4294967296+s}Ue.readUint64BE=om;function cm(i,e){e===void 0&&(e=0);var t=Kc(i,e),s=Kc(i,e+4);return s*4294967296+t-(t>>31)*4294967296}Ue.readInt64LE=cm;function um(i,e){e===void 0&&(e=0);var t=Vc(i,e),s=Vc(i,e+4);return s*4294967296+t}Ue.readUint64LE=um;function up(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Aa(i/4294967296>>>0,e,t),Aa(i>>>0,e,t+4),e}Ue.writeUint64BE=up;Ue.writeInt64BE=up;function hp(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Ta(i>>>0,e,t),Ta(i/4294967296>>>0,e,t+4),e}Ue.writeUint64LE=hp;Ue.writeInt64LE=hp;function hm(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,a=1,c=i/8+t-1;c>=t;c--)s+=e[c]*a,a*=256;return s}Ue.readUintBE=hm;function lm(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,a=1,c=t;c<t+i/8;c++)s+=e[c]*a,a*=256;return s}Ue.readUintLE=lm;function fm(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!ap.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var a=1,c=i/8+s-1;c>=s;c--)t[c]=e/a&255,a*=256;return t}Ue.writeUintBE=fm;function pm(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!ap.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var a=1,c=s;c<s+i/8;c++)t[c]=e/a&255,a*=256;return t}Ue.writeUintLE=pm;function dm(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e)}Ue.readFloat32BE=dm;function gm(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e,!0)}Ue.readFloat32LE=gm;function ym(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e)}Ue.readFloat64BE=ym;function _m(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e,!0)}Ue.readFloat64LE=_m;function vm(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i),e}Ue.writeFloat32BE=vm;function mm(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i,!0),e}Ue.writeFloat32LE=mm;function bm(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i),e}Ue.writeFloat64BE=bm;function wm(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i,!0),e}Ue.writeFloat64LE=wm;var Sr={};Object.defineProperty(Sr,"__esModule",{value:!0});function Em(i){for(var e=0;e<i.length;e++)i[e]=0;return i}Sr.wipe=Em;Object.defineProperty(za,"__esModule",{value:!0});var Qt=Ue,kc=Sr,Dm=20;function Im(i,e,t){for(var s=1634760805,a=857760878,c=2036477234,p=1797285236,f=t[3]<<24|t[2]<<16|t[1]<<8|t[0],y=t[7]<<24|t[6]<<16|t[5]<<8|t[4],d=t[11]<<24|t[10]<<16|t[9]<<8|t[8],_=t[15]<<24|t[14]<<16|t[13]<<8|t[12],I=t[19]<<24|t[18]<<16|t[17]<<8|t[16],D=t[23]<<24|t[22]<<16|t[21]<<8|t[20],O=t[27]<<24|t[26]<<16|t[25]<<8|t[24],A=t[31]<<24|t[30]<<16|t[29]<<8|t[28],B=e[3]<<24|e[2]<<16|e[1]<<8|e[0],G=e[7]<<24|e[6]<<16|e[5]<<8|e[4],ie=e[11]<<24|e[10]<<16|e[9]<<8|e[8],N=e[15]<<24|e[14]<<16|e[13]<<8|e[12],j=s,x=a,C=c,w=p,u=f,b=y,K=d,k=_,ae=I,ce=D,ge=O,$=A,q=B,le=G,te=ie,W=N,ee=0;ee<Dm;ee+=2)j=j+u|0,q^=j,q=q>>>32-16|q<<16,ae=ae+q|0,u^=ae,u=u>>>32-12|u<<12,x=x+b|0,le^=x,le=le>>>32-16|le<<16,ce=ce+le|0,b^=ce,b=b>>>32-12|b<<12,C=C+K|0,te^=C,te=te>>>32-16|te<<16,ge=ge+te|0,K^=ge,K=K>>>32-12|K<<12,w=w+k|0,W^=w,W=W>>>32-16|W<<16,$=$+W|0,k^=$,k=k>>>32-12|k<<12,C=C+K|0,te^=C,te=te>>>32-8|te<<8,ge=ge+te|0,K^=ge,K=K>>>32-7|K<<7,w=w+k|0,W^=w,W=W>>>32-8|W<<8,$=$+W|0,k^=$,k=k>>>32-7|k<<7,x=x+b|0,le^=x,le=le>>>32-8|le<<8,ce=ce+le|0,b^=ce,b=b>>>32-7|b<<7,j=j+u|0,q^=j,q=q>>>32-8|q<<8,ae=ae+q|0,u^=ae,u=u>>>32-7|u<<7,j=j+b|0,W^=j,W=W>>>32-16|W<<16,ge=ge+W|0,b^=ge,b=b>>>32-12|b<<12,x=x+K|0,q^=x,q=q>>>32-16|q<<16,$=$+q|0,K^=$,K=K>>>32-12|K<<12,C=C+k|0,le^=C,le=le>>>32-16|le<<16,ae=ae+le|0,k^=ae,k=k>>>32-12|k<<12,w=w+u|0,te^=w,te=te>>>32-16|te<<16,ce=ce+te|0,u^=ce,u=u>>>32-12|u<<12,C=C+k|0,le^=C,le=le>>>32-8|le<<8,ae=ae+le|0,k^=ae,k=k>>>32-7|k<<7,w=w+u|0,te^=w,te=te>>>32-8|te<<8,ce=ce+te|0,u^=ce,u=u>>>32-7|u<<7,x=x+K|0,q^=x,q=q>>>32-8|q<<8,$=$+q|0,K^=$,K=K>>>32-7|K<<7,j=j+b|0,W^=j,W=W>>>32-8|W<<8,ge=ge+W|0,b^=ge,b=b>>>32-7|b<<7;Qt.writeUint32LE(j+s|0,i,0),Qt.writeUint32LE(x+a|0,i,4),Qt.writeUint32LE(C+c|0,i,8),Qt.writeUint32LE(w+p|0,i,12),Qt.writeUint32LE(u+f|0,i,16),Qt.writeUint32LE(b+y|0,i,20),Qt.writeUint32LE(K+d|0,i,24),Qt.writeUint32LE(k+_|0,i,28),Qt.writeUint32LE(ae+I|0,i,32),Qt.writeUint32LE(ce+D|0,i,36),Qt.writeUint32LE(ge+O|0,i,40),Qt.writeUint32LE($+A|0,i,44),Qt.writeUint32LE(q+B|0,i,48),Qt.writeUint32LE(le+G|0,i,52),Qt.writeUint32LE(te+ie|0,i,56),Qt.writeUint32LE(W+N|0,i,60)}function lp(i,e,t,s,a){if(a===void 0&&(a=0),i.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<t.length)throw new Error("ChaCha: destination is shorter than source");var c,p;if(a===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");c=new Uint8Array(16),p=c.length-e.length,c.set(e,p)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");c=e,p=a}for(var f=new Uint8Array(64),y=0;y<t.length;y+=64){Im(f,c,i);for(var d=y;d<y+64&&d<t.length;d++)s[d]=t[d]^f[d-y];xm(c,0,p)}return kc.wipe(f),a===0&&kc.wipe(c),s}za.streamXOR=lp;function Sm(i,e,t,s){return s===void 0&&(s=0),kc.wipe(t),lp(i,e,t,t,s)}za.stream=Sm;function xm(i,e,t){for(var s=1;t--;)s=s+(i[e]&255)|0,i[e]=s&255,s>>>=8,e++;if(s>0)throw new Error("ChaCha: counter overflow")}var fp={},Ti={};Object.defineProperty(Ti,"__esModule",{value:!0});function Om(i,e,t){return~(i-1)&e|i-1&t}Ti.select=Om;function Pm(i,e){return(i|0)-(e|0)-1>>>31&1}Ti.lessOrEqual=Pm;function pp(i,e){if(i.length!==e.length)return 0;for(var t=0,s=0;s<i.length;s++)t|=i[s]^e[s];return 1&t-1>>>8}Ti.compare=pp;function Cm(i,e){return i.length===0||e.length===0?!1:pp(i,e)!==0}Ti.equal=Cm;(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Ti,t=Sr;i.DIGEST_LENGTH=16;var s=function(){function p(f){this.digestLength=i.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var y=f[0]|f[1]<<8;this._r[0]=y&8191;var d=f[2]|f[3]<<8;this._r[1]=(y>>>13|d<<3)&8191;var _=f[4]|f[5]<<8;this._r[2]=(d>>>10|_<<6)&7939;var I=f[6]|f[7]<<8;this._r[3]=(_>>>7|I<<9)&8191;var D=f[8]|f[9]<<8;this._r[4]=(I>>>4|D<<12)&255,this._r[5]=D>>>1&8190;var O=f[10]|f[11]<<8;this._r[6]=(D>>>14|O<<2)&8191;var A=f[12]|f[13]<<8;this._r[7]=(O>>>11|A<<5)&8065;var B=f[14]|f[15]<<8;this._r[8]=(A>>>8|B<<8)&8191,this._r[9]=B>>>5&127,this._pad[0]=f[16]|f[17]<<8,this._pad[1]=f[18]|f[19]<<8,this._pad[2]=f[20]|f[21]<<8,this._pad[3]=f[22]|f[23]<<8,this._pad[4]=f[24]|f[25]<<8,this._pad[5]=f[26]|f[27]<<8,this._pad[6]=f[28]|f[29]<<8,this._pad[7]=f[30]|f[31]<<8}return p.prototype._blocks=function(f,y,d){for(var _=this._fin?0:2048,I=this._h[0],D=this._h[1],O=this._h[2],A=this._h[3],B=this._h[4],G=this._h[5],ie=this._h[6],N=this._h[7],j=this._h[8],x=this._h[9],C=this._r[0],w=this._r[1],u=this._r[2],b=this._r[3],K=this._r[4],k=this._r[5],ae=this._r[6],ce=this._r[7],ge=this._r[8],$=this._r[9];d>=16;){var q=f[y+0]|f[y+1]<<8;I+=q&8191;var le=f[y+2]|f[y+3]<<8;D+=(q>>>13|le<<3)&8191;var te=f[y+4]|f[y+5]<<8;O+=(le>>>10|te<<6)&8191;var W=f[y+6]|f[y+7]<<8;A+=(te>>>7|W<<9)&8191;var ee=f[y+8]|f[y+9]<<8;B+=(W>>>4|ee<<12)&8191,G+=ee>>>1&8191;var Y=f[y+10]|f[y+11]<<8;ie+=(ee>>>14|Y<<2)&8191;var re=f[y+12]|f[y+13]<<8;N+=(Y>>>11|re<<5)&8191;var xe=f[y+14]|f[y+15]<<8;j+=(re>>>8|xe<<8)&8191,x+=xe>>>5|_;var ne=0,be=ne;be+=I*C,be+=D*(5*$),be+=O*(5*ge),be+=A*(5*ce),be+=B*(5*ae),ne=be>>>13,be&=8191,be+=G*(5*k),be+=ie*(5*K),be+=N*(5*b),be+=j*(5*u),be+=x*(5*w),ne+=be>>>13,be&=8191;var he=ne;he+=I*w,he+=D*C,he+=O*(5*$),he+=A*(5*ge),he+=B*(5*ce),ne=he>>>13,he&=8191,he+=G*(5*ae),he+=ie*(5*k),he+=N*(5*K),he+=j*(5*b),he+=x*(5*u),ne+=he>>>13,he&=8191;var ve=ne;ve+=I*u,ve+=D*w,ve+=O*C,ve+=A*(5*$),ve+=B*(5*ge),ne=ve>>>13,ve&=8191,ve+=G*(5*ce),ve+=ie*(5*ae),ve+=N*(5*k),ve+=j*(5*K),ve+=x*(5*b),ne+=ve>>>13,ve&=8191;var z=ne;z+=I*b,z+=D*u,z+=O*w,z+=A*C,z+=B*(5*$),ne=z>>>13,z&=8191,z+=G*(5*ge),z+=ie*(5*ce),z+=N*(5*ae),z+=j*(5*k),z+=x*(5*K),ne+=z>>>13,z&=8191;var M=ne;M+=I*K,M+=D*b,M+=O*u,M+=A*w,M+=B*C,ne=M>>>13,M&=8191,M+=G*(5*$),M+=ie*(5*ge),M+=N*(5*ce),M+=j*(5*ae),M+=x*(5*k),ne+=M>>>13,M&=8191;var R=ne;R+=I*k,R+=D*K,R+=O*b,R+=A*u,R+=B*w,ne=R>>>13,R&=8191,R+=G*C,R+=ie*(5*$),R+=N*(5*ge),R+=j*(5*ce),R+=x*(5*ae),ne+=R>>>13,R&=8191;var l=ne;l+=I*ae,l+=D*k,l+=O*K,l+=A*b,l+=B*u,ne=l>>>13,l&=8191,l+=G*w,l+=ie*C,l+=N*(5*$),l+=j*(5*ge),l+=x*(5*ce),ne+=l>>>13,l&=8191;var P=ne;P+=I*ce,P+=D*ae,P+=O*k,P+=A*K,P+=B*b,ne=P>>>13,P&=8191,P+=G*u,P+=ie*w,P+=N*C,P+=j*(5*$),P+=x*(5*ge),ne+=P>>>13,P&=8191;var se=ne;se+=I*ge,se+=D*ce,se+=O*ae,se+=A*k,se+=B*K,ne=se>>>13,se&=8191,se+=G*b,se+=ie*u,se+=N*w,se+=j*C,se+=x*(5*$),ne+=se>>>13,se&=8191;var fe=ne;fe+=I*$,fe+=D*ge,fe+=O*ce,fe+=A*ae,fe+=B*k,ne=fe>>>13,fe&=8191,fe+=G*K,fe+=ie*b,fe+=N*u,fe+=j*w,fe+=x*C,ne+=fe>>>13,fe&=8191,ne=(ne<<2)+ne|0,ne=ne+be|0,be=ne&8191,ne=ne>>>13,he+=ne,I=be,D=he,O=ve,A=z,B=M,G=R,ie=l,N=P,j=se,x=fe,y+=16,d-=16}this._h[0]=I,this._h[1]=D,this._h[2]=O,this._h[3]=A,this._h[4]=B,this._h[5]=G,this._h[6]=ie,this._h[7]=N,this._h[8]=j,this._h[9]=x},p.prototype.finish=function(f,y){y===void 0&&(y=0);var d=new Uint16Array(10),_,I,D,O;if(this._leftover){for(O=this._leftover,this._buffer[O++]=1;O<16;O++)this._buffer[O]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(_=this._h[1]>>>13,this._h[1]&=8191,O=2;O<10;O++)this._h[O]+=_,_=this._h[O]>>>13,this._h[O]&=8191;for(this._h[0]+=_*5,_=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=_,_=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=_,d[0]=this._h[0]+5,_=d[0]>>>13,d[0]&=8191,O=1;O<10;O++)d[O]=this._h[O]+_,_=d[O]>>>13,d[O]&=8191;for(d[9]-=8192,I=(_^1)-1,O=0;O<10;O++)d[O]&=I;for(I=~I,O=0;O<10;O++)this._h[O]=this._h[O]&I|d[O];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,D=this._h[0]+this._pad[0],this._h[0]=D&65535,O=1;O<8;O++)D=(this._h[O]+this._pad[O]|0)+(D>>>16)|0,this._h[O]=D&65535;return f[y+0]=this._h[0]>>>0,f[y+1]=this._h[0]>>>8,f[y+2]=this._h[1]>>>0,f[y+3]=this._h[1]>>>8,f[y+4]=this._h[2]>>>0,f[y+5]=this._h[2]>>>8,f[y+6]=this._h[3]>>>0,f[y+7]=this._h[3]>>>8,f[y+8]=this._h[4]>>>0,f[y+9]=this._h[4]>>>8,f[y+10]=this._h[5]>>>0,f[y+11]=this._h[5]>>>8,f[y+12]=this._h[6]>>>0,f[y+13]=this._h[6]>>>8,f[y+14]=this._h[7]>>>0,f[y+15]=this._h[7]>>>8,this._finished=!0,this},p.prototype.update=function(f){var y=0,d=f.length,_;if(this._leftover){_=16-this._leftover,_>d&&(_=d);for(var I=0;I<_;I++)this._buffer[this._leftover+I]=f[y+I];if(d-=_,y+=_,this._leftover+=_,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(d>=16&&(_=d-d%16,this._blocks(f,y,_),y+=_,d-=_),d){for(var I=0;I<d;I++)this._buffer[this._leftover+I]=f[y+I];this._leftover+=d}return this},p.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var f=new Uint8Array(16);return this.finish(f),f},p.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},p}();i.Poly1305=s;function a(p,f){var y=new s(p);y.update(f);var d=y.digest();return y.clean(),d}i.oneTimeAuth=a;function c(p,f){return p.length!==i.DIGEST_LENGTH||f.length!==i.DIGEST_LENGTH?!1:e.equal(p,f)}i.equal=c})(fp);(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=za,t=fp,s=Sr,a=Ue,c=Ti;i.KEY_LENGTH=32,i.NONCE_LENGTH=12,i.TAG_LENGTH=16;var p=new Uint8Array(16),f=function(){function y(d){if(this.nonceLength=i.NONCE_LENGTH,this.tagLength=i.TAG_LENGTH,d.length!==i.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(d)}return y.prototype.seal=function(d,_,I,D){if(d.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var O=new Uint8Array(16);O.set(d,O.length-d.length);var A=new Uint8Array(32);e.stream(this._key,O,A,4);var B=_.length+this.tagLength,G;if(D){if(D.length!==B)throw new Error("ChaCha20Poly1305: incorrect destination length");G=D}else G=new Uint8Array(B);return e.streamXOR(this._key,O,_,G,4),this._authenticate(G.subarray(G.length-this.tagLength,G.length),A,G.subarray(0,G.length-this.tagLength),I),s.wipe(O),G},y.prototype.open=function(d,_,I,D){if(d.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(_.length<this.tagLength)return null;var O=new Uint8Array(16);O.set(d,O.length-d.length);var A=new Uint8Array(32);e.stream(this._key,O,A,4);var B=new Uint8Array(this.tagLength);if(this._authenticate(B,A,_.subarray(0,_.length-this.tagLength),I),!c.equal(B,_.subarray(_.length-this.tagLength,_.length)))return null;var G=_.length-this.tagLength,ie;if(D){if(D.length!==G)throw new Error("ChaCha20Poly1305: incorrect destination length");ie=D}else ie=new Uint8Array(G);return e.streamXOR(this._key,O,_.subarray(0,_.length-this.tagLength),ie,4),s.wipe(O),ie},y.prototype.clean=function(){return s.wipe(this._key),this},y.prototype._authenticate=function(d,_,I,D){var O=new t.Poly1305(_);D&&(O.update(D),D.length%16>0&&O.update(p.subarray(D.length%16))),O.update(I),I.length%16>0&&O.update(p.subarray(I.length%16));var A=new Uint8Array(8);D&&a.writeUint64LE(D.length,A),O.update(A),a.writeUint64LE(I.length,A),O.update(A);for(var B=O.digest(),G=0;G<B.length;G++)d[G]=B[G];O.clean(),s.wipe(B),s.wipe(A)},y}();i.ChaCha20Poly1305=f})(bu);var dp={},hs={},wu={};Object.defineProperty(wu,"__esModule",{value:!0});function Am(i){return typeof i.saveState<"u"&&typeof i.restoreState<"u"&&typeof i.cleanSavedState<"u"}wu.isSerializableHash=Am;Object.defineProperty(hs,"__esModule",{value:!0});var Xr=wu,Tm=Ti,Nm=Sr,gp=function(){function i(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(s).clean():s.set(t);for(var a=0;a<s.length;a++)s[a]^=54;this._inner.update(s);for(var a=0;a<s.length;a++)s[a]^=106;this._outer.update(s),Xr.isSerializableHash(this._inner)&&Xr.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Nm.wipe(s)}return i.prototype.reset=function(){if(!Xr.isSerializableHash(this._inner)||!Xr.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.clean=function(){Xr.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Xr.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},i.prototype.update=function(e){return this._inner.update(e),this},i.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},i.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},i.prototype.saveState=function(){if(!Xr.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},i.prototype.restoreState=function(e){if(!Xr.isSerializableHash(this._inner)||!Xr.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.cleanSavedState=function(e){if(!Xr.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},i}();hs.HMAC=gp;function Rm(i,e,t){var s=new gp(i,e);s.update(t);var a=s.digest();return s.clean(),a}hs.hmac=Rm;hs.equal=Tm.equal;Object.defineProperty(dp,"__esModule",{value:!0});var jl=hs,Ll=Sr,$m=function(){function i(e,t,s,a){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=a;var c=jl.hmac(this._hash,s,t);this._hmac=new jl.HMAC(e,c),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return i.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},i.prototype.expand=function(e){for(var t=new Uint8Array(e),s=0;s<t.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[s]=this._buffer[this._bufpos++];return t},i.prototype.clean=function(){this._hmac.clean(),Ll.wipe(this._buffer),Ll.wipe(this._counter),this._bufpos=0},i}(),Fm=dp.HKDF=$m,On={},qa={},Ba={};Object.defineProperty(Ba,"__esModule",{value:!0});Ba.BrowserRandomSource=void 0;const Ml=65536;class Um{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let s=0;s<t.length;s+=Ml)this._crypto.getRandomValues(t.subarray(s,s+Math.min(t.length-s,Ml)));return t}}Ba.BrowserRandomSource=Um;function jm(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ha={};Object.defineProperty(Ha,"__esModule",{value:!0});Ha.NodeRandomSource=void 0;const Lm=Sr;class Mm{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof jm<"u"){const e=Hv;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(e);for(let a=0;a<s.length;a++)s[a]=t[a];return(0,Lm.wipe)(t),s}}Ha.NodeRandomSource=Mm;Object.defineProperty(qa,"__esModule",{value:!0});qa.SystemRandomSource=void 0;const zm=Ba,qm=Ha;class Bm{constructor(){if(this.isAvailable=!1,this.name="",this._source=new zm.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new qm.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}qa.SystemRandomSource=Bm;(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.randomStringForEntropy=i.randomString=i.randomUint32=i.randomBytes=i.defaultRandomSource=void 0;const e=qa,t=Ue,s=Sr;i.defaultRandomSource=new e.SystemRandomSource;function a(d,_=i.defaultRandomSource){return _.randomBytes(d)}i.randomBytes=a;function c(d=i.defaultRandomSource){const _=a(4,d),I=(0,t.readUint32LE)(_);return(0,s.wipe)(_),I}i.randomUint32=c;const p="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function f(d,_=p,I=i.defaultRandomSource){if(_.length<2)throw new Error("randomString charset is too short");if(_.length>256)throw new Error("randomString charset is too long");let D="";const O=_.length,A=256-256%O;for(;d>0;){const B=a(Math.ceil(d*256/A),I);for(let G=0;G<B.length&&d>0;G++){const ie=B[G];ie<A&&(D+=_.charAt(ie%O),d--)}(0,s.wipe)(B)}return D}i.randomString=f;function y(d,_=p,I=i.defaultRandomSource){const D=Math.ceil(d/(Math.log(_.length)/Math.LN2));return f(D,_,I)}i.randomStringForEntropy=y})(On);var Ka={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Ue,t=Sr;i.DIGEST_LENGTH=32,i.BLOCK_SIZE=64;var s=function(){function f(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},f.prototype.update=function(y,d){if(d===void 0&&(d=y.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var _=0;if(this._bytesHashed+=d,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&d>0;)this._buffer[this._bufferLength++]=y[_++],d--;this._bufferLength===this.blockSize&&(c(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(d>=this.blockSize&&(_=c(this._temp,this._state,y,_,d),d%=this.blockSize);d>0;)this._buffer[this._bufferLength++]=y[_++],d--;return this},f.prototype.finish=function(y){if(!this._finished){var d=this._bytesHashed,_=this._bufferLength,I=d/536870912|0,D=d<<3,O=d%64<56?64:128;this._buffer[_]=128;for(var A=_+1;A<O-8;A++)this._buffer[A]=0;e.writeUint32BE(I,this._buffer,O-8),e.writeUint32BE(D,this._buffer,O-4),c(this._temp,this._state,this._buffer,0,O),this._finished=!0}for(var A=0;A<this.digestLength/4;A++)e.writeUint32BE(this._state[A],y,A*4);return this},f.prototype.digest=function(){var y=new Uint8Array(this.digestLength);return this.finish(y),y},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(y){return this._state.set(y.state),this._bufferLength=y.bufferLength,y.buffer&&this._buffer.set(y.buffer),this._bytesHashed=y.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(y){t.wipe(y.state),y.buffer&&t.wipe(y.buffer),y.bufferLength=0,y.bytesHashed=0},f}();i.SHA256=s;var a=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function c(f,y,d,_,I){for(;I>=64;){for(var D=y[0],O=y[1],A=y[2],B=y[3],G=y[4],ie=y[5],N=y[6],j=y[7],x=0;x<16;x++){var C=_+x*4;f[x]=e.readUint32BE(d,C)}for(var x=16;x<64;x++){var w=f[x-2],u=(w>>>17|w<<32-17)^(w>>>19|w<<32-19)^w>>>10;w=f[x-15];var b=(w>>>7|w<<32-7)^(w>>>18|w<<32-18)^w>>>3;f[x]=(u+f[x-7]|0)+(b+f[x-16]|0)}for(var x=0;x<64;x++){var u=(((G>>>6|G<<26)^(G>>>11|G<<21)^(G>>>25|G<<7))+(G&ie^~G&N)|0)+(j+(a[x]+f[x]|0)|0)|0,b=((D>>>2|D<<32-2)^(D>>>13|D<<32-13)^(D>>>22|D<<32-22))+(D&O^D&A^O&A)|0;j=N,N=ie,ie=G,G=B+u|0,B=A,A=O,O=D,D=u+b|0}y[0]+=D,y[1]+=O,y[2]+=A,y[3]+=B,y[4]+=G,y[5]+=ie,y[6]+=N,y[7]+=j,_+=64,I-=64}return _}function p(f){var y=new s;y.update(f);var d=y.digest();return y.clean(),d}i.hash=p})(Ka);var Eu={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.sharedKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.scalarMultBase=i.scalarMult=i.SHARED_KEY_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=void 0;const e=On,t=Sr;i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=32,i.SHARED_KEY_LENGTH=32;function s(x){const C=new Float64Array(16);if(x)for(let w=0;w<x.length;w++)C[w]=x[w];return C}const a=new Uint8Array(32);a[0]=9;const c=s([56129,1]);function p(x){let C=1;for(let w=0;w<16;w++){let u=x[w]+C+65535;C=Math.floor(u/65536),x[w]=u-C*65536}x[0]+=C-1+37*(C-1)}function f(x,C,w){const u=~(w-1);for(let b=0;b<16;b++){const K=u&(x[b]^C[b]);x[b]^=K,C[b]^=K}}function y(x,C){const w=s(),u=s();for(let b=0;b<16;b++)u[b]=C[b];p(u),p(u),p(u);for(let b=0;b<2;b++){w[0]=u[0]-65517;for(let k=1;k<15;k++)w[k]=u[k]-65535-(w[k-1]>>16&1),w[k-1]&=65535;w[15]=u[15]-32767-(w[14]>>16&1);const K=w[15]>>16&1;w[14]&=65535,f(u,w,1-K)}for(let b=0;b<16;b++)x[2*b]=u[b]&255,x[2*b+1]=u[b]>>8}function d(x,C){for(let w=0;w<16;w++)x[w]=C[2*w]+(C[2*w+1]<<8);x[15]&=32767}function _(x,C,w){for(let u=0;u<16;u++)x[u]=C[u]+w[u]}function I(x,C,w){for(let u=0;u<16;u++)x[u]=C[u]-w[u]}function D(x,C,w){let u,b,K=0,k=0,ae=0,ce=0,ge=0,$=0,q=0,le=0,te=0,W=0,ee=0,Y=0,re=0,xe=0,ne=0,be=0,he=0,ve=0,z=0,M=0,R=0,l=0,P=0,se=0,fe=0,Ie=0,Be=0,Ve=0,je=0,pt=0,dt=0,Me=w[0],Se=w[1],Re=w[2],$e=w[3],ze=w[4],Pe=w[5],Fe=w[6],De=w[7],Ce=w[8],He=w[9],Oe=w[10],ke=w[11],We=w[12],et=w[13],tt=w[14],Je=w[15];u=C[0],K+=u*Me,k+=u*Se,ae+=u*Re,ce+=u*$e,ge+=u*ze,$+=u*Pe,q+=u*Fe,le+=u*De,te+=u*Ce,W+=u*He,ee+=u*Oe,Y+=u*ke,re+=u*We,xe+=u*et,ne+=u*tt,be+=u*Je,u=C[1],k+=u*Me,ae+=u*Se,ce+=u*Re,ge+=u*$e,$+=u*ze,q+=u*Pe,le+=u*Fe,te+=u*De,W+=u*Ce,ee+=u*He,Y+=u*Oe,re+=u*ke,xe+=u*We,ne+=u*et,be+=u*tt,he+=u*Je,u=C[2],ae+=u*Me,ce+=u*Se,ge+=u*Re,$+=u*$e,q+=u*ze,le+=u*Pe,te+=u*Fe,W+=u*De,ee+=u*Ce,Y+=u*He,re+=u*Oe,xe+=u*ke,ne+=u*We,be+=u*et,he+=u*tt,ve+=u*Je,u=C[3],ce+=u*Me,ge+=u*Se,$+=u*Re,q+=u*$e,le+=u*ze,te+=u*Pe,W+=u*Fe,ee+=u*De,Y+=u*Ce,re+=u*He,xe+=u*Oe,ne+=u*ke,be+=u*We,he+=u*et,ve+=u*tt,z+=u*Je,u=C[4],ge+=u*Me,$+=u*Se,q+=u*Re,le+=u*$e,te+=u*ze,W+=u*Pe,ee+=u*Fe,Y+=u*De,re+=u*Ce,xe+=u*He,ne+=u*Oe,be+=u*ke,he+=u*We,ve+=u*et,z+=u*tt,M+=u*Je,u=C[5],$+=u*Me,q+=u*Se,le+=u*Re,te+=u*$e,W+=u*ze,ee+=u*Pe,Y+=u*Fe,re+=u*De,xe+=u*Ce,ne+=u*He,be+=u*Oe,he+=u*ke,ve+=u*We,z+=u*et,M+=u*tt,R+=u*Je,u=C[6],q+=u*Me,le+=u*Se,te+=u*Re,W+=u*$e,ee+=u*ze,Y+=u*Pe,re+=u*Fe,xe+=u*De,ne+=u*Ce,be+=u*He,he+=u*Oe,ve+=u*ke,z+=u*We,M+=u*et,R+=u*tt,l+=u*Je,u=C[7],le+=u*Me,te+=u*Se,W+=u*Re,ee+=u*$e,Y+=u*ze,re+=u*Pe,xe+=u*Fe,ne+=u*De,be+=u*Ce,he+=u*He,ve+=u*Oe,z+=u*ke,M+=u*We,R+=u*et,l+=u*tt,P+=u*Je,u=C[8],te+=u*Me,W+=u*Se,ee+=u*Re,Y+=u*$e,re+=u*ze,xe+=u*Pe,ne+=u*Fe,be+=u*De,he+=u*Ce,ve+=u*He,z+=u*Oe,M+=u*ke,R+=u*We,l+=u*et,P+=u*tt,se+=u*Je,u=C[9],W+=u*Me,ee+=u*Se,Y+=u*Re,re+=u*$e,xe+=u*ze,ne+=u*Pe,be+=u*Fe,he+=u*De,ve+=u*Ce,z+=u*He,M+=u*Oe,R+=u*ke,l+=u*We,P+=u*et,se+=u*tt,fe+=u*Je,u=C[10],ee+=u*Me,Y+=u*Se,re+=u*Re,xe+=u*$e,ne+=u*ze,be+=u*Pe,he+=u*Fe,ve+=u*De,z+=u*Ce,M+=u*He,R+=u*Oe,l+=u*ke,P+=u*We,se+=u*et,fe+=u*tt,Ie+=u*Je,u=C[11],Y+=u*Me,re+=u*Se,xe+=u*Re,ne+=u*$e,be+=u*ze,he+=u*Pe,ve+=u*Fe,z+=u*De,M+=u*Ce,R+=u*He,l+=u*Oe,P+=u*ke,se+=u*We,fe+=u*et,Ie+=u*tt,Be+=u*Je,u=C[12],re+=u*Me,xe+=u*Se,ne+=u*Re,be+=u*$e,he+=u*ze,ve+=u*Pe,z+=u*Fe,M+=u*De,R+=u*Ce,l+=u*He,P+=u*Oe,se+=u*ke,fe+=u*We,Ie+=u*et,Be+=u*tt,Ve+=u*Je,u=C[13],xe+=u*Me,ne+=u*Se,be+=u*Re,he+=u*$e,ve+=u*ze,z+=u*Pe,M+=u*Fe,R+=u*De,l+=u*Ce,P+=u*He,se+=u*Oe,fe+=u*ke,Ie+=u*We,Be+=u*et,Ve+=u*tt,je+=u*Je,u=C[14],ne+=u*Me,be+=u*Se,he+=u*Re,ve+=u*$e,z+=u*ze,M+=u*Pe,R+=u*Fe,l+=u*De,P+=u*Ce,se+=u*He,fe+=u*Oe,Ie+=u*ke,Be+=u*We,Ve+=u*et,je+=u*tt,pt+=u*Je,u=C[15],be+=u*Me,he+=u*Se,ve+=u*Re,z+=u*$e,M+=u*ze,R+=u*Pe,l+=u*Fe,P+=u*De,se+=u*Ce,fe+=u*He,Ie+=u*Oe,Be+=u*ke,Ve+=u*We,je+=u*et,pt+=u*tt,dt+=u*Je,K+=38*he,k+=38*ve,ae+=38*z,ce+=38*M,ge+=38*R,$+=38*l,q+=38*P,le+=38*se,te+=38*fe,W+=38*Ie,ee+=38*Be,Y+=38*Ve,re+=38*je,xe+=38*pt,ne+=38*dt,b=1,u=K+b+65535,b=Math.floor(u/65536),K=u-b*65536,u=k+b+65535,b=Math.floor(u/65536),k=u-b*65536,u=ae+b+65535,b=Math.floor(u/65536),ae=u-b*65536,u=ce+b+65535,b=Math.floor(u/65536),ce=u-b*65536,u=ge+b+65535,b=Math.floor(u/65536),ge=u-b*65536,u=$+b+65535,b=Math.floor(u/65536),$=u-b*65536,u=q+b+65535,b=Math.floor(u/65536),q=u-b*65536,u=le+b+65535,b=Math.floor(u/65536),le=u-b*65536,u=te+b+65535,b=Math.floor(u/65536),te=u-b*65536,u=W+b+65535,b=Math.floor(u/65536),W=u-b*65536,u=ee+b+65535,b=Math.floor(u/65536),ee=u-b*65536,u=Y+b+65535,b=Math.floor(u/65536),Y=u-b*65536,u=re+b+65535,b=Math.floor(u/65536),re=u-b*65536,u=xe+b+65535,b=Math.floor(u/65536),xe=u-b*65536,u=ne+b+65535,b=Math.floor(u/65536),ne=u-b*65536,u=be+b+65535,b=Math.floor(u/65536),be=u-b*65536,K+=b-1+37*(b-1),b=1,u=K+b+65535,b=Math.floor(u/65536),K=u-b*65536,u=k+b+65535,b=Math.floor(u/65536),k=u-b*65536,u=ae+b+65535,b=Math.floor(u/65536),ae=u-b*65536,u=ce+b+65535,b=Math.floor(u/65536),ce=u-b*65536,u=ge+b+65535,b=Math.floor(u/65536),ge=u-b*65536,u=$+b+65535,b=Math.floor(u/65536),$=u-b*65536,u=q+b+65535,b=Math.floor(u/65536),q=u-b*65536,u=le+b+65535,b=Math.floor(u/65536),le=u-b*65536,u=te+b+65535,b=Math.floor(u/65536),te=u-b*65536,u=W+b+65535,b=Math.floor(u/65536),W=u-b*65536,u=ee+b+65535,b=Math.floor(u/65536),ee=u-b*65536,u=Y+b+65535,b=Math.floor(u/65536),Y=u-b*65536,u=re+b+65535,b=Math.floor(u/65536),re=u-b*65536,u=xe+b+65535,b=Math.floor(u/65536),xe=u-b*65536,u=ne+b+65535,b=Math.floor(u/65536),ne=u-b*65536,u=be+b+65535,b=Math.floor(u/65536),be=u-b*65536,K+=b-1+37*(b-1),x[0]=K,x[1]=k,x[2]=ae,x[3]=ce,x[4]=ge,x[5]=$,x[6]=q,x[7]=le,x[8]=te,x[9]=W,x[10]=ee,x[11]=Y,x[12]=re,x[13]=xe,x[14]=ne,x[15]=be}function O(x,C){D(x,C,C)}function A(x,C){const w=s();for(let u=0;u<16;u++)w[u]=C[u];for(let u=253;u>=0;u--)O(w,w),u!==2&&u!==4&&D(w,w,C);for(let u=0;u<16;u++)x[u]=w[u]}function B(x,C){const w=new Uint8Array(32),u=new Float64Array(80),b=s(),K=s(),k=s(),ae=s(),ce=s(),ge=s();for(let te=0;te<31;te++)w[te]=x[te];w[31]=x[31]&127|64,w[0]&=248,d(u,C);for(let te=0;te<16;te++)K[te]=u[te];b[0]=ae[0]=1;for(let te=254;te>=0;--te){const W=w[te>>>3]>>>(te&7)&1;f(b,K,W),f(k,ae,W),_(ce,b,k),I(b,b,k),_(k,K,ae),I(K,K,ae),O(ae,ce),O(ge,b),D(b,k,b),D(k,K,ce),_(ce,b,k),I(b,b,k),O(K,b),I(k,ae,ge),D(b,k,c),_(b,b,ae),D(k,k,b),D(b,ae,ge),D(ae,K,u),O(K,ce),f(b,K,W),f(k,ae,W)}for(let te=0;te<16;te++)u[te+16]=b[te],u[te+32]=k[te],u[te+48]=K[te],u[te+64]=ae[te];const $=u.subarray(32),q=u.subarray(16);A($,$),D(q,q,$);const le=new Uint8Array(32);return y(le,q),le}i.scalarMult=B;function G(x){return B(x,a)}i.scalarMultBase=G;function ie(x){if(x.length!==i.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${i.SECRET_KEY_LENGTH} bytes`);const C=new Uint8Array(x);return{publicKey:G(C),secretKey:C}}i.generateKeyPairFromSeed=ie;function N(x){const C=(0,e.randomBytes)(32,x),w=ie(C);return(0,t.wipe)(C),w}i.generateKeyPair=N;function j(x,C,w=!1){if(x.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(C.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const u=B(x,C);if(w){let b=0;for(let K=0;K<u.length;K++)b|=u[K];if(b===0)throw new Error("X25519: invalid shared key")}return u}i.sharedKey=j})(Eu);function Du(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function yp(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Du(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function Gc(i,e){e||(e=i.reduce((a,c)=>a+c.length,0));const t=yp(e);let s=0;for(const a of i)t.set(a,s),s+=a.length;return Du(t)}function Hm(i,e){if(i.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var a=0;a<i.length;a++){var c=i.charAt(a),p=c.charCodeAt(0);if(t[p]!==255)throw new TypeError(c+" is ambiguous");t[p]=a}var f=i.length,y=i.charAt(0),d=Math.log(f)/Math.log(256),_=Math.log(256)/Math.log(f);function I(A){if(A instanceof Uint8Array||(ArrayBuffer.isView(A)?A=new Uint8Array(A.buffer,A.byteOffset,A.byteLength):Array.isArray(A)&&(A=Uint8Array.from(A))),!(A instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(A.length===0)return"";for(var B=0,G=0,ie=0,N=A.length;ie!==N&&A[ie]===0;)ie++,B++;for(var j=(N-ie)*_+1>>>0,x=new Uint8Array(j);ie!==N;){for(var C=A[ie],w=0,u=j-1;(C!==0||w<G)&&u!==-1;u--,w++)C+=256*x[u]>>>0,x[u]=C%f>>>0,C=C/f>>>0;if(C!==0)throw new Error("Non-zero carry");G=w,ie++}for(var b=j-G;b!==j&&x[b]===0;)b++;for(var K=y.repeat(B);b<j;++b)K+=i.charAt(x[b]);return K}function D(A){if(typeof A!="string")throw new TypeError("Expected String");if(A.length===0)return new Uint8Array;var B=0;if(A[B]!==" "){for(var G=0,ie=0;A[B]===y;)G++,B++;for(var N=(A.length-B)*d+1>>>0,j=new Uint8Array(N);A[B];){var x=t[A.charCodeAt(B)];if(x===255)return;for(var C=0,w=N-1;(x!==0||C<ie)&&w!==-1;w--,C++)x+=f*j[w]>>>0,j[w]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");ie=C,B++}if(A[B]!==" "){for(var u=N-ie;u!==N&&j[u]===0;)u++;for(var b=new Uint8Array(G+(N-u)),K=G;u!==N;)b[K++]=j[u++];return b}}}function O(A){var B=D(A);if(B)return B;throw new Error(`Non-${e} character`)}return{encode:I,decodeUnsafe:D,decode:O}}var Km=Hm,Vm=Km;const km=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},Gm=i=>new TextEncoder().encode(i),Wm=i=>new TextDecoder().decode(i);class Ym{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Jm{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return _p(this,e)}}class Xm{constructor(e){this.decoders=e}or(e){return _p(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const _p=(i,e)=>new Xm({...i.decoders||{[i.prefix]:i},...e.decoders||{[e.prefix]:e}});class Zm{constructor(e,t,s,a){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=a,this.encoder=new Ym(e,t,s),this.decoder=new Jm(e,t,a)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Va=({name:i,prefix:e,encode:t,decode:s})=>new Zm(i,e,t,s),ls=({prefix:i,name:e,alphabet:t})=>{const{encode:s,decode:a}=Vm(t,e);return Va({prefix:i,name:e,encode:s,decode:c=>km(a(c))})},Qm=(i,e,t,s)=>{const a={};for(let _=0;_<e.length;++_)a[e[_]]=_;let c=i.length;for(;i[c-1]==="=";)--c;const p=new Uint8Array(c*t/8|0);let f=0,y=0,d=0;for(let _=0;_<c;++_){const I=a[i[_]];if(I===void 0)throw new SyntaxError(`Non-${s} character`);y=y<<t|I,f+=t,f>=8&&(f-=8,p[d++]=255&y>>f)}if(f>=t||255&y<<8-f)throw new SyntaxError("Unexpected end of data");return p},eb=(i,e,t)=>{const s=e[e.length-1]==="=",a=(1<<t)-1;let c="",p=0,f=0;for(let y=0;y<i.length;++y)for(f=f<<8|i[y],p+=8;p>t;)p-=t,c+=e[a&f>>p];if(p&&(c+=e[a&f<<t-p]),s)for(;c.length*t&7;)c+="=";return c},Yt=({name:i,prefix:e,bitsPerChar:t,alphabet:s})=>Va({prefix:e,name:i,encode(a){return eb(a,s,t)},decode(a){return Qm(a,s,t,i)}}),tb=Va({prefix:"\0",name:"identity",encode:i=>Wm(i),decode:i=>Gm(i)}),rb=Object.freeze(Object.defineProperty({__proto__:null,identity:tb},Symbol.toStringTag,{value:"Module"})),ib=Yt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),nb=Object.freeze(Object.defineProperty({__proto__:null,base2:ib},Symbol.toStringTag,{value:"Module"})),sb=Yt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),ab=Object.freeze(Object.defineProperty({__proto__:null,base8:sb},Symbol.toStringTag,{value:"Module"})),ob=ls({prefix:"9",name:"base10",alphabet:"0123456789"}),cb=Object.freeze(Object.defineProperty({__proto__:null,base10:ob},Symbol.toStringTag,{value:"Module"})),ub=Yt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),hb=Yt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),lb=Object.freeze(Object.defineProperty({__proto__:null,base16:ub,base16upper:hb},Symbol.toStringTag,{value:"Module"})),fb=Yt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),pb=Yt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),db=Yt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),gb=Yt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),yb=Yt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),_b=Yt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),vb=Yt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),mb=Yt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),bb=Yt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),wb=Object.freeze(Object.defineProperty({__proto__:null,base32:fb,base32hex:yb,base32hexpad:vb,base32hexpadupper:mb,base32hexupper:_b,base32pad:db,base32padupper:gb,base32upper:pb,base32z:bb},Symbol.toStringTag,{value:"Module"})),Eb=ls({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Db=ls({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Ib=Object.freeze(Object.defineProperty({__proto__:null,base36:Eb,base36upper:Db},Symbol.toStringTag,{value:"Module"})),Sb=ls({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),xb=ls({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Ob=Object.freeze(Object.defineProperty({__proto__:null,base58btc:Sb,base58flickr:xb},Symbol.toStringTag,{value:"Module"})),Pb=Yt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Cb=Yt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ab=Yt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Tb=Yt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Nb=Object.freeze(Object.defineProperty({__proto__:null,base64:Pb,base64pad:Cb,base64url:Ab,base64urlpad:Tb},Symbol.toStringTag,{value:"Module"})),vp=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),Rb=vp.reduce((i,e,t)=>(i[t]=e,i),[]),$b=vp.reduce((i,e,t)=>(i[e.codePointAt(0)]=t,i),[]);function Fb(i){return i.reduce((e,t)=>(e+=Rb[t],e),"")}function Ub(i){const e=[];for(const t of i){const s=$b[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const jb=Va({prefix:"ðŸš€",name:"base256emoji",encode:Fb,decode:Ub}),Lb=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:jb},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const zl={...rb,...nb,...ab,...cb,...lb,...wb,...Ib,...Ob,...Nb,...Lb};function mp(i,e,t,s){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:t},decoder:{decode:s}}}const ql=mp("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),wc=mp("ascii","a",i=>{let e="a";for(let t=0;t<i.length;t++)e+=String.fromCharCode(i[t]);return e},i=>{i=i.substring(1);const e=yp(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}),bp={utf8:ql,"utf-8":ql,hex:zl.base16,latin1:wc,ascii:wc,binary:wc,...zl};function vr(i,e="utf8"){const t=bp[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Du(globalThis.Buffer.from(i,"utf-8")):t.decoder.decode(`${t.prefix}${i}`)}function ur(i,e="utf8"){const t=bp[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(i.buffer,i.byteOffset,i.byteLength).toString("utf8"):t.encoder.encode(i).substring(1)}var _e={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Wc=function(i,e){return Wc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var a in s)s.hasOwnProperty(a)&&(t[a]=s[a])},Wc(i,e)};function Mb(i,e){Wc(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Yc=function(){return Yc=Object.assign||function(e){for(var t,s=1,a=arguments.length;s<a;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Yc.apply(this,arguments)};function zb(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(i);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(i,s[a])&&(t[s[a]]=i[s[a]]);return t}function qb(i,e,t,s){var a=arguments.length,c=a<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(p=i[f])&&(c=(a<3?p(c):a>3?p(e,t,c):p(e,t))||c);return a>3&&c&&Object.defineProperty(e,t,c),c}function Bb(i,e){return function(t,s){e(t,s,i)}}function Hb(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function Kb(i,e,t,s){function a(c){return c instanceof t?c:new t(function(p){p(c)})}return new(t||(t=Promise))(function(c,p){function f(_){try{d(s.next(_))}catch(I){p(I)}}function y(_){try{d(s.throw(_))}catch(I){p(I)}}function d(_){_.done?c(_.value):a(_.value).then(f,y)}d((s=s.apply(i,e||[])).next())})}function Vb(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,a,c,p;return p={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function f(d){return function(_){return y([d,_])}}function y(d){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,a&&(c=d[0]&2?a.return:d[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,d[1])).done)return c;switch(a=0,c&&(d=[d[0]&2,c.value]),d[0]){case 0:case 1:c=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,a=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!c||d[1]>c[0]&&d[1]<c[3])){t.label=d[1];break}if(d[0]===6&&t.label<c[1]){t.label=c[1],c=d;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(d);break}c[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(i,t)}catch(_){d=[6,_],a=0}finally{s=c=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function kb(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function Gb(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function Jc(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function wp(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),a,c=[],p;try{for(;(e===void 0||e-- >0)&&!(a=s.next()).done;)c.push(a.value)}catch(f){p={error:f}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(p)throw p.error}}return c}function Wb(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(wp(arguments[e]));return i}function Yb(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),a=0,e=0;e<t;e++)for(var c=arguments[e],p=0,f=c.length;p<f;p++,a++)s[a]=c[p];return s}function ss(i){return this instanceof ss?(this.v=i,this):new ss(i)}function Jb(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),a,c=[];return a={},p("next"),p("throw"),p("return"),a[Symbol.asyncIterator]=function(){return this},a;function p(D){s[D]&&(a[D]=function(O){return new Promise(function(A,B){c.push([D,O,A,B])>1||f(D,O)})})}function f(D,O){try{y(s[D](O))}catch(A){I(c[0][3],A)}}function y(D){D.value instanceof ss?Promise.resolve(D.value.v).then(d,_):I(c[0][2],D)}function d(D){f("next",D)}function _(D){f("throw",D)}function I(D,O){D(O),c.shift(),c.length&&f(c[0][0],c[0][1])}}function Xb(i){var e,t;return e={},s("next"),s("throw",function(a){throw a}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(a,c){e[a]=i[a]?function(p){return(t=!t)?{value:ss(i[a](p)),done:a==="return"}:c?c(p):p}:c}}function Zb(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof Jc=="function"?Jc(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(p){return new Promise(function(f,y){p=i[c](p),a(f,y,p.done,p.value)})}}function a(c,p,f,y){Promise.resolve(y).then(function(d){c({value:d,done:f})},p)}}function Qb(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function ew(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function tw(i){return i&&i.__esModule?i:{default:i}}function rw(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function iw(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const nw=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Yc},__asyncDelegator:Xb,__asyncGenerator:Jb,__asyncValues:Zb,__await:ss,__awaiter:Kb,__classPrivateFieldGet:rw,__classPrivateFieldSet:iw,__createBinding:kb,__decorate:qb,__exportStar:Gb,__extends:Mb,__generator:Vb,__importDefault:tw,__importStar:ew,__makeTemplateObject:Qb,__metadata:Hb,__param:Bb,__read:wp,__rest:zb,__spread:Wb,__spreadArrays:Yb,__values:Jc},Symbol.toStringTag,{value:"Module"})),ka=La(nw);var Ec={},Yn={},Bl;function sw(){if(Bl)return Yn;Bl=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.delay=void 0;function i(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return Yn.delay=i,Yn}var Gi={},Dc={},Wi={},Hl;function aw(){return Hl||(Hl=1,Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.ONE_THOUSAND=Wi.ONE_HUNDRED=void 0,Wi.ONE_HUNDRED=100,Wi.ONE_THOUSAND=1e3),Wi}var Ic={},Kl;function ow(){return Kl||(Kl=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ONE_YEAR=i.FOUR_WEEKS=i.THREE_WEEKS=i.TWO_WEEKS=i.ONE_WEEK=i.THIRTY_DAYS=i.SEVEN_DAYS=i.FIVE_DAYS=i.THREE_DAYS=i.ONE_DAY=i.TWENTY_FOUR_HOURS=i.TWELVE_HOURS=i.SIX_HOURS=i.THREE_HOURS=i.ONE_HOUR=i.SIXTY_MINUTES=i.THIRTY_MINUTES=i.TEN_MINUTES=i.FIVE_MINUTES=i.ONE_MINUTE=i.SIXTY_SECONDS=i.THIRTY_SECONDS=i.TEN_SECONDS=i.FIVE_SECONDS=i.ONE_SECOND=void 0,i.ONE_SECOND=1,i.FIVE_SECONDS=5,i.TEN_SECONDS=10,i.THIRTY_SECONDS=30,i.SIXTY_SECONDS=60,i.ONE_MINUTE=i.SIXTY_SECONDS,i.FIVE_MINUTES=i.ONE_MINUTE*5,i.TEN_MINUTES=i.ONE_MINUTE*10,i.THIRTY_MINUTES=i.ONE_MINUTE*30,i.SIXTY_MINUTES=i.ONE_MINUTE*60,i.ONE_HOUR=i.SIXTY_MINUTES,i.THREE_HOURS=i.ONE_HOUR*3,i.SIX_HOURS=i.ONE_HOUR*6,i.TWELVE_HOURS=i.ONE_HOUR*12,i.TWENTY_FOUR_HOURS=i.ONE_HOUR*24,i.ONE_DAY=i.TWENTY_FOUR_HOURS,i.THREE_DAYS=i.ONE_DAY*3,i.FIVE_DAYS=i.ONE_DAY*5,i.SEVEN_DAYS=i.ONE_DAY*7,i.THIRTY_DAYS=i.ONE_DAY*30,i.ONE_WEEK=i.SEVEN_DAYS,i.TWO_WEEKS=i.ONE_WEEK*2,i.THREE_WEEKS=i.ONE_WEEK*3,i.FOUR_WEEKS=i.ONE_WEEK*4,i.ONE_YEAR=i.ONE_DAY*365}(Ic)),Ic}var Vl;function Ep(){return Vl||(Vl=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ka;e.__exportStar(aw(),i),e.__exportStar(ow(),i)}(Dc)),Dc}var kl;function cw(){if(kl)return Gi;kl=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.fromMiliseconds=Gi.toMiliseconds=void 0;const i=Ep();function e(s){return s*i.ONE_THOUSAND}Gi.toMiliseconds=e;function t(s){return Math.floor(s/i.ONE_THOUSAND)}return Gi.fromMiliseconds=t,Gi}var Gl;function uw(){return Gl||(Gl=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ka;e.__exportStar(sw(),i),e.__exportStar(cw(),i)}(Ec)),Ec}var Dn={},Wl;function hw(){if(Wl)return Dn;Wl=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.Watch=void 0;class i{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const s=this.get(t);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const a=Date.now()-s.started;this.timestamps.set(t,{started:s.started,elapsed:a})}get(t){const s=this.timestamps.get(t);if(typeof s>"u")throw new Error(`No timestamp found for label: ${t}`);return s}elapsed(t){const s=this.get(t);return s.elapsed||Date.now()-s.started}}return Dn.Watch=i,Dn.default=i,Dn}var Sc={},Jn={},Yl;function lw(){if(Yl)return Jn;Yl=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.IWatch=void 0;class i{}return Jn.IWatch=i,Jn}var Jl;function fw(){return Jl||(Jl=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),ka.__exportStar(lw(),i)}(Sc)),Sc}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ka;e.__exportStar(uw(),i),e.__exportStar(hw(),i),e.__exportStar(fw(),i),e.__exportStar(Ep(),i)})(_e);var as={},pw=i=>encodeURIComponent(i).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`);(function(i){const e=pw,t=Wv,s=kv,a=Gv,c=N=>N==null,p=Symbol("encodeFragmentIdentifier");function f(N){switch(N.arrayFormat){case"index":return j=>(x,C)=>{const w=x.length;return C===void 0||N.skipNull&&C===null||N.skipEmptyString&&C===""?x:C===null?[...x,[_(j,N),"[",w,"]"].join("")]:[...x,[_(j,N),"[",_(w,N),"]=",_(C,N)].join("")]};case"bracket":return j=>(x,C)=>C===void 0||N.skipNull&&C===null||N.skipEmptyString&&C===""?x:C===null?[...x,[_(j,N),"[]"].join("")]:[...x,[_(j,N),"[]=",_(C,N)].join("")];case"colon-list-separator":return j=>(x,C)=>C===void 0||N.skipNull&&C===null||N.skipEmptyString&&C===""?x:C===null?[...x,[_(j,N),":list="].join("")]:[...x,[_(j,N),":list=",_(C,N)].join("")];case"comma":case"separator":case"bracket-separator":{const j=N.arrayFormat==="bracket-separator"?"[]=":"=";return x=>(C,w)=>w===void 0||N.skipNull&&w===null||N.skipEmptyString&&w===""?C:(w=w===null?"":w,C.length===0?[[_(x,N),j,_(w,N)].join("")]:[[C,_(w,N)].join(N.arrayFormatSeparator)])}default:return j=>(x,C)=>C===void 0||N.skipNull&&C===null||N.skipEmptyString&&C===""?x:C===null?[...x,_(j,N)]:[...x,[_(j,N),"=",_(C,N)].join("")]}}function y(N){let j;switch(N.arrayFormat){case"index":return(x,C,w)=>{if(j=/\[(\d*)\]$/.exec(x),x=x.replace(/\[\d*\]$/,""),!j){w[x]=C;return}w[x]===void 0&&(w[x]={}),w[x][j[1]]=C};case"bracket":return(x,C,w)=>{if(j=/(\[\])$/.exec(x),x=x.replace(/\[\]$/,""),!j){w[x]=C;return}if(w[x]===void 0){w[x]=[C];return}w[x]=[].concat(w[x],C)};case"colon-list-separator":return(x,C,w)=>{if(j=/(:list)$/.exec(x),x=x.replace(/:list$/,""),!j){w[x]=C;return}if(w[x]===void 0){w[x]=[C];return}w[x]=[].concat(w[x],C)};case"comma":case"separator":return(x,C,w)=>{const u=typeof C=="string"&&C.includes(N.arrayFormatSeparator),b=typeof C=="string"&&!u&&I(C,N).includes(N.arrayFormatSeparator);C=b?I(C,N):C;const K=u||b?C.split(N.arrayFormatSeparator).map(k=>I(k,N)):C===null?C:I(C,N);w[x]=K};case"bracket-separator":return(x,C,w)=>{const u=/(\[\])$/.test(x);if(x=x.replace(/\[\]$/,""),!u){w[x]=C&&I(C,N);return}const b=C===null?[]:C.split(N.arrayFormatSeparator).map(K=>I(K,N));if(w[x]===void 0){w[x]=b;return}w[x]=[].concat(w[x],b)};default:return(x,C,w)=>{if(w[x]===void 0){w[x]=C;return}w[x]=[].concat(w[x],C)}}}function d(N){if(typeof N!="string"||N.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function _(N,j){return j.encode?j.strict?e(N):encodeURIComponent(N):N}function I(N,j){return j.decode?t(N):N}function D(N){return Array.isArray(N)?N.sort():typeof N=="object"?D(Object.keys(N)).sort((j,x)=>Number(j)-Number(x)).map(j=>N[j]):N}function O(N){const j=N.indexOf("#");return j!==-1&&(N=N.slice(0,j)),N}function A(N){let j="";const x=N.indexOf("#");return x!==-1&&(j=N.slice(x)),j}function B(N){N=O(N);const j=N.indexOf("?");return j===-1?"":N.slice(j+1)}function G(N,j){return j.parseNumbers&&!Number.isNaN(Number(N))&&typeof N=="string"&&N.trim()!==""?N=Number(N):j.parseBooleans&&N!==null&&(N.toLowerCase()==="true"||N.toLowerCase()==="false")&&(N=N.toLowerCase()==="true"),N}function ie(N,j){j=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},j),d(j.arrayFormatSeparator);const x=y(j),C=Object.create(null);if(typeof N!="string"||(N=N.trim().replace(/^[?#&]/,""),!N))return C;for(const w of N.split("&")){if(w==="")continue;let[u,b]=s(j.decode?w.replace(/\+/g," "):w,"=");b=b===void 0?null:["comma","separator","bracket-separator"].includes(j.arrayFormat)?b:I(b,j),x(I(u,j),b,C)}for(const w of Object.keys(C)){const u=C[w];if(typeof u=="object"&&u!==null)for(const b of Object.keys(u))u[b]=G(u[b],j);else C[w]=G(u,j)}return j.sort===!1?C:(j.sort===!0?Object.keys(C).sort():Object.keys(C).sort(j.sort)).reduce((w,u)=>{const b=C[u];return b&&typeof b=="object"&&!Array.isArray(b)?w[u]=D(b):w[u]=b,w},Object.create(null))}i.extract=B,i.parse=ie,i.stringify=(N,j)=>{if(!N)return"";j=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},j),d(j.arrayFormatSeparator);const x=b=>j.skipNull&&c(N[b])||j.skipEmptyString&&N[b]==="",C=f(j),w={};for(const b of Object.keys(N))x(b)||(w[b]=N[b]);const u=Object.keys(w);return j.sort!==!1&&u.sort(j.sort),u.map(b=>{const K=N[b];return K===void 0?"":K===null?_(b,j):Array.isArray(K)?K.length===0&&j.arrayFormat==="bracket-separator"?_(b,j)+"[]":K.reduce(C(b),[]).join("&"):_(b,j)+"="+_(K,j)}).filter(b=>b.length>0).join("&")},i.parseUrl=(N,j)=>{j=Object.assign({decode:!0},j);const[x,C]=s(N,"#");return Object.assign({url:x.split("?")[0]||"",query:ie(B(N),j)},j&&j.parseFragmentIdentifier&&C?{fragmentIdentifier:I(C,j)}:{})},i.stringifyUrl=(N,j)=>{j=Object.assign({encode:!0,strict:!0,[p]:!0},j);const x=O(N.url).split("?")[0]||"",C=i.extract(N.url),w=i.parse(C,{sort:!1}),u=Object.assign(w,N.query);let b=i.stringify(u,j);b&&(b=`?${b}`);let K=A(N.url);return N.fragmentIdentifier&&(K=`#${j[p]?_(N.fragmentIdentifier,j):N.fragmentIdentifier}`),`${x}${b}${K}`},i.pick=(N,j,x)=>{x=Object.assign({parseFragmentIdentifier:!0,[p]:!1},x);const{url:C,query:w,fragmentIdentifier:u}=i.parseUrl(N,x);return i.stringifyUrl({url:C,query:a(w,j),fragmentIdentifier:u},x)},i.exclude=(N,j,x)=>{const C=Array.isArray(j)?w=>!j.includes(w):(w,u)=>!j(w,u);return i.pick(N,C,x)}})(as);const dw={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function gw(i,e=[]){const t=[];return Object.keys(i).forEach(s=>{if(e.length&&!e.includes(s))return;const a=i[s];t.push(...a.accounts)}),t}function Dp(i,e){return i.includes(":")?[i]:e.chains||[]}const Ip="base10",cr="base16",Xc="base64pad",Iu="utf8",Sp=0,Qi=1,yw=0,Xl=1,Zc=12,Su=32;function _w(){const i=Eu.generateKeyPair();return{privateKey:ur(i.secretKey,cr),publicKey:ur(i.publicKey,cr)}}function Qc(){const i=On.randomBytes(Su);return ur(i,cr)}function vw(i,e){const t=Eu.sharedKey(vr(i,cr),vr(e,cr)),s=new Fm(Ka.SHA256,t).expand(Su);return ur(s,cr)}function mw(i){const e=Ka.hash(vr(i,cr));return ur(e,cr)}function Sn(i){const e=Ka.hash(vr(i,Iu));return ur(e,cr)}function bw(i){return vr(`${i}`,Ip)}function fs(i){return Number(ur(i,Ip))}function ww(i){const e=bw(typeof i.type<"u"?i.type:Sp);if(fs(e)===Qi&&typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof i.senderPublicKey<"u"?vr(i.senderPublicKey,cr):void 0,s=typeof i.iv<"u"?vr(i.iv,cr):On.randomBytes(Zc),a=new bu.ChaCha20Poly1305(vr(i.symKey,cr)).seal(s,vr(i.message,Iu));return Dw({type:e,sealed:a,iv:s,senderPublicKey:t})}function Ew(i){const e=new bu.ChaCha20Poly1305(vr(i.symKey,cr)),{sealed:t,iv:s}=Na(i.encoded),a=e.open(s,t);if(a===null)throw new Error("Failed to decrypt");return ur(a,Iu)}function Dw(i){if(fs(i.type)===Qi){if(typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ur(Gc([i.type,i.senderPublicKey,i.iv,i.sealed]),Xc)}return ur(Gc([i.type,i.iv,i.sealed]),Xc)}function Na(i){const e=vr(i,Xc),t=e.slice(yw,Xl),s=Xl;if(fs(t)===Qi){const f=s+Su,y=f+Zc,d=e.slice(s,f),_=e.slice(f,y),I=e.slice(y);return{type:t,sealed:I,iv:_,senderPublicKey:d}}const a=s+Zc,c=e.slice(s,a),p=e.slice(a);return{type:t,sealed:p,iv:c}}function Iw(i,e){const t=Na(i);return xp({type:fs(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?ur(t.senderPublicKey,cr):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function xp(i){const e=(i==null?void 0:i.type)||Sp;if(e===Qi){if(typeof(i==null?void 0:i.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(i==null?void 0:i.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:i==null?void 0:i.senderPublicKey,receiverPublicKey:i==null?void 0:i.receiverPublicKey}}function Zl(i){return i.type===Qi&&typeof i.senderPublicKey=="string"&&typeof i.receiverPublicKey=="string"}var Sw=Object.defineProperty,Ql=Object.getOwnPropertySymbols,xw=Object.prototype.hasOwnProperty,Ow=Object.prototype.propertyIsEnumerable,ef=(i,e,t)=>e in i?Sw(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,tf=(i,e)=>{for(var t in e||(e={}))xw.call(e,t)&&ef(i,t,e[t]);if(Ql)for(var t of Ql(e))Ow.call(e,t)&&ef(i,t,e[t]);return i};const Pw="ReactNative",Pi={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Cw="js";function xu(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Op(){return!Jv()&&!!ip()&&navigator.product===Pw}function Ou(){return!xu()&&!!ip()}function Pu(){return Op()?Pi.reactNative:xu()?Pi.node:Ou()?Pi.browser:Pi.unknown}function Aw(i,e){let t=as.parse(i);return t=tf(tf({},t),e),i=as.stringify(t),i}function Tw(){return Yv()||{name:"",description:"",url:"",icons:[""]}}function Nw(){if(Pu()===Pi.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:s}=global.Platform;return[t,s].join("-")}const i=Xv();if(i===null)return"unknown";const e=i.os?i.os.replace(" ","").toLowerCase():"unknown";return i.type==="browser"?[e,i.name,i.version].join("-"):[e,i.version].join("-")}function Rw(){var i;const e=Pu();return e===Pi.browser?[e,((i=Zv())==null?void 0:i.host)||"unknown"].join(":"):e}function $w(i,e,t){const s=Nw(),a=Rw();return[[i,e].join("-"),[Cw,t].join("-"),s,a].join("/")}function Fw({protocol:i,version:e,relayUrl:t,sdkVersion:s,auth:a,projectId:c,useOnCloseEvent:p}){const f=t.split("?"),y=$w(i,e,s),d={auth:a,ua:y,projectId:c,useOnCloseEvent:p||void 0},_=Aw(f[1]||"",d);return f[0]+"?"+_}function Xi(i,e){return i.filter(t=>e.includes(t)).length===i.length}function Pp(i){return Object.fromEntries(i.entries())}function Cp(i){return new Map(Object.entries(i))}function In(i=_e.FIVE_MINUTES,e){const t=_e.toMiliseconds(i||_e.FIVE_MINUTES);let s,a,c;return{resolve:p=>{c&&s&&(clearTimeout(c),s(p))},reject:p=>{c&&a&&(clearTimeout(c),a(p))},done:()=>new Promise((p,f)=>{c=setTimeout(()=>{f(new Error(e))},t),s=p,a=f})}}function Ra(i,e,t){return new Promise(async(s,a)=>{const c=setTimeout(()=>a(new Error(t)),e);try{const p=await i;s(p)}catch(p){a(p)}clearTimeout(c)})}function Ap(i,e){if(typeof e=="string"&&e.startsWith(`${i}:`))return e;if(i.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(i.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${i}`)}function Uw(i){return Ap("topic",i)}function jw(i){return Ap("id",i)}function Tp(i){const[e,t]=i.split(":"),s={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")s.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))s.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return s}function Kr(i,e){return _e.fromMiliseconds((e||Date.now())+_e.toMiliseconds(i))}function Oi(i){return Date.now()>=_e.toMiliseconds(i)}function qt(i,e){return`${i}${e?`:${e}`:""}`}function xc(i=[],e=[]){return[...new Set([...i,...e])]}async function Lw({id:i,topic:e,wcDeepLink:t}){try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t;let a=s==null?void 0:s.href;if(typeof a!="string")return;a.endsWith("/")&&(a=a.slice(0,-1));const c=`${a}/wc?requestId=${i}&sessionTopic=${e}`,p=Pu();p===Pi.browser?c.startsWith("https://")?window.open(c,"_blank","noreferrer noopener"):window.open(c,"_self","noreferrer noopener"):p===Pi.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(c)}catch(s){console.error(s)}}const Mw="irn";function eu(i){return(i==null?void 0:i.relay)||{protocol:Mw}}function Sa(i){const e=dw[i];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${i}`);return e}var zw=Object.defineProperty,rf=Object.getOwnPropertySymbols,qw=Object.prototype.hasOwnProperty,Bw=Object.prototype.propertyIsEnumerable,nf=(i,e,t)=>e in i?zw(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Hw=(i,e)=>{for(var t in e||(e={}))qw.call(e,t)&&nf(i,t,e[t]);if(rf)for(var t of rf(e))Bw.call(e,t)&&nf(i,t,e[t]);return i};function Kw(i,e="-"){const t={},s="relay"+e;return Object.keys(i).forEach(a=>{if(a.startsWith(s)){const c=a.replace(s,""),p=i[a];t[c]=p}}),t}function Vw(i){const e=i.indexOf(":"),t=i.indexOf("?")!==-1?i.indexOf("?"):void 0,s=i.substring(0,e),a=i.substring(e+1,t).split("@"),c=typeof t<"u"?i.substring(t):"",p=as.parse(c);return{protocol:s,topic:kw(a[0]),version:parseInt(a[1],10),symKey:p.symKey,relay:Kw(p)}}function kw(i){return i.startsWith("//")?i.substring(2):i}function Gw(i,e="-"){const t="relay",s={};return Object.keys(i).forEach(a=>{const c=t+e+a;i[a]&&(s[c]=i[a])}),s}function Ww(i){return`${i.protocol}:${i.topic}@${i.version}?`+as.stringify(Hw({symKey:i.symKey},Gw(i.relay)))}function Pn(i){const e=[];return i.forEach(t=>{const[s,a]=t.split(":");e.push(`${s}:${a}`)}),e}function Yw(i){const e=[];return Object.values(i).forEach(t=>{e.push(...Pn(t.accounts))}),e}function Jw(i,e){const t=[];return Object.values(i).forEach(s=>{Pn(s.accounts).includes(e)&&t.push(...s.methods)}),t}function Xw(i,e){const t=[];return Object.values(i).forEach(s=>{Pn(s.accounts).includes(e)&&t.push(...s.events)}),t}function Zw(i,e){const t=Oa(i,e);if(t)throw new Error(t.message);const s={};for(const[a,c]of Object.entries(i))s[a]={methods:c.methods,events:c.events,chains:c.accounts.map(p=>`${p.split(":")[0]}:${p.split(":")[1]}`)};return s}function Cu(i){return i.includes(":")}function xa(i){return Cu(i)?i.split(":")[0]:i}const Qw={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},eE={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ue(i,e){const{message:t,code:s}=eE[i];return{message:e?`${t} ${e}`:t,code:s}}function Nt(i,e){const{message:t,code:s}=Qw[i];return{message:e?`${t} ${e}`:t,code:s}}function ei(i,e){return Array.isArray(i)?typeof e<"u"&&i.length?i.every(e):!0:!1}function xn(i){return Object.getPrototypeOf(i)===Object.prototype&&Object.keys(i).length}function or(i){return typeof i>"u"}function Gt(i,e){return e&&or(i)?!0:typeof i=="string"&&!!i.trim().length}function Au(i,e){return e&&or(i)?!0:typeof i=="number"&&!isNaN(i)}function tE(i,e){const{requiredNamespaces:t}=e,s=Object.keys(i.namespaces),a=Object.keys(t);let c=!0;return Xi(a,s)?(s.forEach(p=>{const{accounts:f,methods:y,events:d}=i.namespaces[p],_=Pn(f),I=t[p];(!Xi(Dp(p,I),_)||!Xi(I.methods,y)||!Xi(I.events,d))&&(c=!1)}),c):!1}function $a(i){return Gt(i,!1)&&i.includes(":")?i.split(":").length===2:!1}function rE(i){if(Gt(i,!1)&&i.includes(":")){const e=i.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&$a(t)}}return!1}function iE(i){if(Gt(i,!1))try{return typeof new URL(i)<"u"}catch{return!1}return!1}function nE(i){var e;return(e=i==null?void 0:i.proposer)==null?void 0:e.publicKey}function sE(i){return i==null?void 0:i.topic}function aE(i,e){let t=null;return Gt(i==null?void 0:i.publicKey,!1)||(t=ue("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function sf(i){let e=!0;return ei(i)?i.length&&(e=i.every(t=>Gt(t,!1))):e=!1,e}function oE(i,e,t){let s=null;return ei(e)&&e.length?e.forEach(a=>{s||$a(a)||(s=Nt("UNSUPPORTED_CHAINS",`${t}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):$a(i)||(s=Nt("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function cE(i,e,t){let s=null;return Object.entries(i).forEach(([a,c])=>{if(s)return;const p=oE(a,Dp(a,c),`${e} ${t}`);p&&(s=p)}),s}function uE(i,e){let t=null;return ei(i)?i.forEach(s=>{t||rE(s)||(t=Nt("UNSUPPORTED_ACCOUNTS",`${e}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):t=Nt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function hE(i,e){let t=null;return Object.values(i).forEach(s=>{if(t)return;const a=uE(s==null?void 0:s.accounts,`${e} namespace`);a&&(t=a)}),t}function lE(i,e){let t=null;return sf(i==null?void 0:i.methods)?sf(i==null?void 0:i.events)||(t=Nt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=Nt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function Np(i,e){let t=null;return Object.values(i).forEach(s=>{if(t)return;const a=lE(s,`${e}, namespace`);a&&(t=a)}),t}function fE(i,e,t){let s=null;if(i&&xn(i)){const a=Np(i,e);a&&(s=a);const c=cE(i,e,t);c&&(s=c)}else s=ue("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return s}function Oa(i,e){let t=null;if(i&&xn(i)){const s=Np(i,e);s&&(t=s);const a=hE(i,e);a&&(t=a)}else t=ue("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function Rp(i){return Gt(i.protocol,!0)}function pE(i,e){let t=!1;return e&&!i?t=!0:i&&ei(i)&&i.length&&i.forEach(s=>{t=Rp(s)}),t}function dE(i){return typeof i=="number"}function _r(i){return typeof i<"u"&&typeof i!==null}function gE(i){return!(!i||typeof i!="object"||!i.code||!Au(i.code,!1)||!i.message||!Gt(i.message,!1))}function yE(i){return!(or(i)||!Gt(i.method,!1))}function _E(i){return!(or(i)||or(i.result)&&or(i.error)||!Au(i.id,!1)||!Gt(i.jsonrpc,!1))}function vE(i){return!(or(i)||!Gt(i.name,!1))}function af(i,e){return!(!$a(e)||!Yw(i).includes(e))}function mE(i,e,t){return Gt(t,!1)?Jw(i,e).includes(t):!1}function bE(i,e,t){return Gt(t,!1)?Xw(i,e).includes(t):!1}function of(i,e,t){let s=null;const a=wE(i),c=EE(e),p=Object.keys(a),f=Object.keys(c),y=cf(Object.keys(i)),d=cf(Object.keys(e)),_=y.filter(I=>!d.includes(I));return _.length&&(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${_.toString()}
      Received: ${Object.keys(e).toString()}`)),Xi(p,f)||(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${p.toString()}
      Approved: ${f.toString()}`)),Object.keys(e).forEach(I=>{if(!I.includes(":")||s)return;const D=Pn(e[I].accounts);D.includes(I)||(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${I}
        Required: ${I}
        Approved: ${D.toString()}`))}),p.forEach(I=>{s||(Xi(a[I].methods,c[I].methods)?Xi(a[I].events,c[I].events)||(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${I}`)):s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${I}`))}),s}function wE(i){const e={};return Object.keys(i).forEach(t=>{var s;t.includes(":")?e[t]=i[t]:(s=i[t].chains)==null||s.forEach(a=>{e[a]={methods:i[t].methods,events:i[t].events}})}),e}function cf(i){return[...new Set(i.map(e=>e.includes(":")?e.split(":")[0]:e))]}function EE(i){const e={};return Object.keys(i).forEach(t=>{if(t.includes(":"))e[t]=i[t];else{const s=Pn(i[t].accounts);s==null||s.forEach(a=>{e[a]={accounts:i[t].accounts.filter(c=>c.includes(`${a}:`)),methods:i[t].methods,events:i[t].events}})}}),e}function DE(i,e){return Au(i,!1)&&i<=e.max&&i>=e.min}const IE=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,SE=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,xE=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function OE(i,e){if(i==="__proto__"||i==="constructor"&&e&&typeof e=="object"&&"prototype"in e){PE(i);return}return e}function PE(i){console.warn(`[destr] Dropping "${i}" key to prevent prototype pollution.`)}function ba(i,e={}){if(typeof i!="string")return i;const t=i.trim();if(i[0]==='"'&&i.at(-1)==='"'&&!i.includes("\\"))return t.slice(1,-1);if(t.length<=9){const s=t.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!xE.test(i)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return i}try{if(IE.test(i)||SE.test(i)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(i,OE)}return JSON.parse(i)}catch(s){if(e.strict)throw s;return i}}function CE(i){return!i||typeof i.then!="function"?Promise.resolve(i):i}function kt(i,...e){try{return CE(i(...e))}catch(t){return Promise.reject(t)}}function AE(i){const e=typeof i;return i===null||e!=="object"&&e!=="function"}function TE(i){const e=Object.getPrototypeOf(i);return!e||e.isPrototypeOf(Object)}function Pa(i){if(AE(i))return String(i);if(TE(i)||Array.isArray(i))return JSON.stringify(i);if(typeof i.toJSON=="function")return Pa(i.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function $p(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const tu="base64:";function NE(i){if(typeof i=="string")return i;$p();const e=Buffer.from(i).toString("base64");return tu+e}function RE(i){return typeof i!="string"||!i.startsWith(tu)?i:($p(),Buffer.from(i.slice(tu.length),"base64"))}function yr(i){return i?i.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function $E(...i){return yr(i.join(":"))}function wa(i){return i=yr(i),i?i+":":""}const FE="memory",UE=()=>{const i=new Map;return{name:FE,options:{},hasItem(e){return i.has(e)},getItem(e){return i.get(e)??null},getItemRaw(e){return i.get(e)??null},setItem(e,t){i.set(e,t)},setItemRaw(e,t){i.set(e,t)},removeItem(e){i.delete(e)},getKeys(){return Array.from(i.keys())},clear(){i.clear()},dispose(){i.clear()}}};function jE(i={}){const e={mounts:{"":i.driver||UE()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=d=>{for(const _ of e.mountpoints)if(d.startsWith(_))return{base:_,relativeKey:d.slice(_.length),driver:e.mounts[_]};return{base:"",relativeKey:d,driver:e.mounts[""]}},s=(d,_)=>e.mountpoints.filter(I=>I.startsWith(d)||_&&d.startsWith(I)).map(I=>({relativeBase:d.length>I.length?d.slice(I.length):void 0,mountpoint:I,driver:e.mounts[I]})),a=(d,_)=>{if(e.watching){_=yr(_);for(const I of e.watchListeners)I(d,_)}},c=async()=>{if(!e.watching){e.watching=!0;for(const d in e.mounts)e.unwatch[d]=await uf(e.mounts[d],a,d)}},p=async()=>{if(e.watching){for(const d in e.unwatch)await e.unwatch[d]();e.unwatch={},e.watching=!1}},f=(d,_,I)=>{const D=new Map,O=A=>{let B=D.get(A.base);return B||(B={driver:A.driver,base:A.base,items:[]},D.set(A.base,B)),B};for(const A of d){const B=typeof A=="string",G=yr(B?A:A.key),ie=B?void 0:A.value,N=B||!A.options?_:{..._,...A.options},j=t(G);O(j).items.push({key:G,value:ie,relativeKey:j.relativeKey,options:N})}return Promise.all([...D.values()].map(A=>I(A))).then(A=>A.flat())},y={hasItem(d,_={}){d=yr(d);const{relativeKey:I,driver:D}=t(d);return kt(D.hasItem,I,_)},getItem(d,_={}){d=yr(d);const{relativeKey:I,driver:D}=t(d);return kt(D.getItem,I,_).then(O=>ba(O))},getItems(d,_){return f(d,_,I=>I.driver.getItems?kt(I.driver.getItems,I.items.map(D=>({key:D.relativeKey,options:D.options})),_).then(D=>D.map(O=>({key:$E(I.base,O.key),value:ba(O.value)}))):Promise.all(I.items.map(D=>kt(I.driver.getItem,D.relativeKey,D.options).then(O=>({key:D.key,value:ba(O)})))))},getItemRaw(d,_={}){d=yr(d);const{relativeKey:I,driver:D}=t(d);return D.getItemRaw?kt(D.getItemRaw,I,_):kt(D.getItem,I,_).then(O=>RE(O))},async setItem(d,_,I={}){if(_===void 0)return y.removeItem(d);d=yr(d);const{relativeKey:D,driver:O}=t(d);O.setItem&&(await kt(O.setItem,D,Pa(_),I),O.watch||a("update",d))},async setItems(d,_){await f(d,_,async I=>{I.driver.setItems&&await kt(I.driver.setItems,I.items.map(D=>({key:D.relativeKey,value:Pa(D.value),options:D.options})),_),I.driver.setItem&&await Promise.all(I.items.map(D=>kt(I.driver.setItem,D.relativeKey,Pa(D.value),D.options)))})},async setItemRaw(d,_,I={}){if(_===void 0)return y.removeItem(d,I);d=yr(d);const{relativeKey:D,driver:O}=t(d);if(O.setItemRaw)await kt(O.setItemRaw,D,_,I);else if(O.setItem)await kt(O.setItem,D,NE(_),I);else return;O.watch||a("update",d)},async removeItem(d,_={}){typeof _=="boolean"&&(_={removeMeta:_}),d=yr(d);const{relativeKey:I,driver:D}=t(d);D.removeItem&&(await kt(D.removeItem,I,_),(_.removeMeta||_.removeMata)&&await kt(D.removeItem,I+"$",_),D.watch||a("remove",d))},async getMeta(d,_={}){typeof _=="boolean"&&(_={nativeOnly:_}),d=yr(d);const{relativeKey:I,driver:D}=t(d),O=Object.create(null);if(D.getMeta&&Object.assign(O,await kt(D.getMeta,I,_)),!_.nativeOnly){const A=await kt(D.getItem,I+"$",_).then(B=>ba(B));A&&typeof A=="object"&&(typeof A.atime=="string"&&(A.atime=new Date(A.atime)),typeof A.mtime=="string"&&(A.mtime=new Date(A.mtime)),Object.assign(O,A))}return O},setMeta(d,_,I={}){return this.setItem(d+"$",_,I)},removeMeta(d,_={}){return this.removeItem(d+"$",_)},async getKeys(d,_={}){d=wa(d);const I=s(d,!0);let D=[];const O=[];for(const A of I){const G=(await kt(A.driver.getKeys,A.relativeBase,_)).map(ie=>A.mountpoint+yr(ie)).filter(ie=>!D.some(N=>ie.startsWith(N)));O.push(...G),D=[A.mountpoint,...D.filter(ie=>!ie.startsWith(A.mountpoint))]}return d?O.filter(A=>A.startsWith(d)&&!A.endsWith("$")):O.filter(A=>!A.endsWith("$"))},async clear(d,_={}){d=wa(d),await Promise.all(s(d,!1).map(async I=>{if(I.driver.clear)return kt(I.driver.clear,I.relativeBase,_);if(I.driver.removeItem){const D=await I.driver.getKeys(I.relativeBase||"",_);return Promise.all(D.map(O=>I.driver.removeItem(O,_)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(d=>hf(d)))},async watch(d){return await c(),e.watchListeners.push(d),async()=>{e.watchListeners=e.watchListeners.filter(_=>_!==d),e.watchListeners.length===0&&await p()}},async unwatch(){e.watchListeners=[],await p()},mount(d,_){if(d=wa(d),d&&e.mounts[d])throw new Error(`already mounted at ${d}`);return d&&(e.mountpoints.push(d),e.mountpoints.sort((I,D)=>D.length-I.length)),e.mounts[d]=_,e.watching&&Promise.resolve(uf(_,a,d)).then(I=>{e.unwatch[d]=I}).catch(console.error),y},async unmount(d,_=!0){d=wa(d),!(!d||!e.mounts[d])&&(e.watching&&d in e.unwatch&&(e.unwatch[d](),delete e.unwatch[d]),_&&await hf(e.mounts[d]),e.mountpoints=e.mountpoints.filter(I=>I!==d),delete e.mounts[d])},getMount(d=""){d=yr(d)+":";const _=t(d);return{driver:_.driver,base:_.base}},getMounts(d="",_={}){return d=yr(d),s(d,_.parents).map(D=>({driver:D.driver,base:D.mountpoint}))}};return y}function uf(i,e,t){return i.watch?i.watch((s,a)=>e(s,t+a)):()=>{}}async function hf(i){typeof i.dispose=="function"&&await kt(i.dispose)}function en(i){return new Promise((e,t)=>{i.oncomplete=i.onsuccess=()=>e(i.result),i.onabort=i.onerror=()=>t(i.error)})}function Fp(i,e){const t=indexedDB.open(i);t.onupgradeneeded=()=>t.result.createObjectStore(e);const s=en(t);return(a,c)=>s.then(p=>c(p.transaction(e,a).objectStore(e)))}let Oc;function ps(){return Oc||(Oc=Fp("keyval-store","keyval")),Oc}function lf(i,e=ps()){return e("readonly",t=>en(t.get(i)))}function LE(i,e,t=ps()){return t("readwrite",s=>(s.put(e,i),en(s.transaction)))}function ME(i,e=ps()){return e("readwrite",t=>(t.delete(i),en(t.transaction)))}function zE(i=ps()){return i("readwrite",e=>(e.clear(),en(e.transaction)))}function qE(i,e){return i.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},en(i.transaction)}function BE(i=ps()){return i("readonly",e=>{if(e.getAllKeys)return en(e.getAllKeys());const t=[];return qE(e,s=>t.push(s.key)).then(()=>t)})}const HE="idb-keyval";var KE=(i={})=>{const e=i.base&&i.base.length>0?`${i.base}:`:"",t=a=>e+a;let s;return i.dbName&&i.storeName&&(s=Fp(i.dbName,i.storeName)),{name:HE,options:i,async hasItem(a){return!(typeof await lf(t(a),s)>"u")},async getItem(a){return await lf(t(a),s)??null},setItem(a,c){return LE(t(a),c,s)},removeItem(a){return ME(t(a),s)},getKeys(){return BE(s)},clear(){return zE(s)}}};const VE="WALLET_CONNECT_V2_INDEXED_DB",kE="keyvaluestorage";let GE=class{constructor(){this.indexedDb=jE({driver:KE({dbName:VE,storeName:kE})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,us(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var Pc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ca={exports:{}};(function(){let i;function e(){}i=e,i.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},i.prototype.setItem=function(t,s){this[t]=String(s)},i.prototype.removeItem=function(t){delete this[t]},i.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(s){t[s]=void 0,delete t[s]})},i.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},i.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Pc<"u"&&Pc.localStorage?Ca.exports=Pc.localStorage:typeof window<"u"&&window.localStorage?Ca.exports=window.localStorage:Ca.exports=new e})();function WE(i){var e;return[i[0],Ma((e=i[1])!=null?e:"")]}let YE=class{constructor(){this.localStorage=Ca.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(WE)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return Ma(t)}async setItem(e,t){this.localStorage.setItem(e,us(t))}async removeItem(e){this.localStorage.removeItem(e)}};const JE="wc_storage_version",ff=1,XE=async(i,e,t)=>{const s=JE,a=await e.getItem(s);if(a&&a>=ff){t(e);return}const c=await i.getKeys();if(!c.length){t(e);return}const p=[];for(;c.length;){const f=c.shift();if(!f)continue;const y=f.toLowerCase();if(y.includes("wc@")||y.includes("walletconnect")||y.includes("wc_")||y.includes("wallet_connect")){const d=await i.getItem(f);await e.setItem(f,d),p.push(f)}}await e.setItem(s,ff),t(e),ZE(i,p)},ZE=async(i,e)=>{e.length&&e.forEach(async t=>{await i.removeItem(t)})};let QE=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new YE;this.storage=e;try{const t=new GE;XE(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};var Cn={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ru=function(i,e){return ru=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var a in s)s.hasOwnProperty(a)&&(t[a]=s[a])},ru(i,e)};function e3(i,e){ru(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var iu=function(){return iu=Object.assign||function(e){for(var t,s=1,a=arguments.length;s<a;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},iu.apply(this,arguments)};function t3(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(i);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(i,s[a])&&(t[s[a]]=i[s[a]]);return t}function r3(i,e,t,s){var a=arguments.length,c=a<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(p=i[f])&&(c=(a<3?p(c):a>3?p(e,t,c):p(e,t))||c);return a>3&&c&&Object.defineProperty(e,t,c),c}function i3(i,e){return function(t,s){e(t,s,i)}}function n3(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function s3(i,e,t,s){function a(c){return c instanceof t?c:new t(function(p){p(c)})}return new(t||(t=Promise))(function(c,p){function f(_){try{d(s.next(_))}catch(I){p(I)}}function y(_){try{d(s.throw(_))}catch(I){p(I)}}function d(_){_.done?c(_.value):a(_.value).then(f,y)}d((s=s.apply(i,e||[])).next())})}function a3(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,a,c,p;return p={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function f(d){return function(_){return y([d,_])}}function y(d){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,a&&(c=d[0]&2?a.return:d[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,d[1])).done)return c;switch(a=0,c&&(d=[d[0]&2,c.value]),d[0]){case 0:case 1:c=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,a=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!c||d[1]>c[0]&&d[1]<c[3])){t.label=d[1];break}if(d[0]===6&&t.label<c[1]){t.label=c[1],c=d;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(d);break}c[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(i,t)}catch(_){d=[6,_],a=0}finally{s=c=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function o3(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function c3(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function nu(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Up(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),a,c=[],p;try{for(;(e===void 0||e-- >0)&&!(a=s.next()).done;)c.push(a.value)}catch(f){p={error:f}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(p)throw p.error}}return c}function u3(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(Up(arguments[e]));return i}function h3(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),a=0,e=0;e<t;e++)for(var c=arguments[e],p=0,f=c.length;p<f;p++,a++)s[a]=c[p];return s}function os(i){return this instanceof os?(this.v=i,this):new os(i)}function l3(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),a,c=[];return a={},p("next"),p("throw"),p("return"),a[Symbol.asyncIterator]=function(){return this},a;function p(D){s[D]&&(a[D]=function(O){return new Promise(function(A,B){c.push([D,O,A,B])>1||f(D,O)})})}function f(D,O){try{y(s[D](O))}catch(A){I(c[0][3],A)}}function y(D){D.value instanceof os?Promise.resolve(D.value.v).then(d,_):I(c[0][2],D)}function d(D){f("next",D)}function _(D){f("throw",D)}function I(D,O){D(O),c.shift(),c.length&&f(c[0][0],c[0][1])}}function f3(i){var e,t;return e={},s("next"),s("throw",function(a){throw a}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(a,c){e[a]=i[a]?function(p){return(t=!t)?{value:os(i[a](p)),done:a==="return"}:c?c(p):p}:c}}function p3(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof nu=="function"?nu(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(p){return new Promise(function(f,y){p=i[c](p),a(f,y,p.done,p.value)})}}function a(c,p,f,y){Promise.resolve(y).then(function(d){c({value:d,done:f})},p)}}function d3(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function g3(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function y3(i){return i&&i.__esModule?i:{default:i}}function _3(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function v3(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const m3=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return iu},__asyncDelegator:f3,__asyncGenerator:l3,__asyncValues:p3,__await:os,__awaiter:s3,__classPrivateFieldGet:_3,__classPrivateFieldSet:v3,__createBinding:o3,__decorate:r3,__exportStar:c3,__extends:e3,__generator:a3,__importDefault:y3,__importStar:g3,__makeTemplateObject:d3,__metadata:n3,__param:i3,__read:Up,__rest:t3,__spread:u3,__spreadArrays:h3,__values:nu},Symbol.toStringTag,{value:"Module"})),Ga=La(m3);var Xn={},Cc={},Zn={};class tn{}const b3=Object.freeze(Object.defineProperty({__proto__:null,IEvents:tn},Symbol.toStringTag,{value:"Module"})),w3=La(b3);var pf;function E3(){if(pf)return Zn;pf=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.IHeartBeat=void 0;const i=w3;class e extends i.IEvents{constructor(s){super()}}return Zn.IHeartBeat=e,Zn}var df;function jp(){return df||(df=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),Ga.__exportStar(E3(),i)}(Cc)),Cc}var Ac={},Yi={},gf;function D3(){if(gf)return Yi;gf=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.HEARTBEAT_EVENTS=Yi.HEARTBEAT_INTERVAL=void 0;const i=_e;return Yi.HEARTBEAT_INTERVAL=i.FIVE_SECONDS,Yi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Yi}var yf;function Lp(){return yf||(yf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),Ga.__exportStar(D3(),i)}(Ac)),Ac}var _f;function I3(){if(_f)return Xn;_f=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.HeartBeat=void 0;const i=Ga,e=ti,t=_e,s=jp(),a=Lp();class c extends s.IHeartBeat{constructor(f){super(f),this.events=new e.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(f==null?void 0:f.interval)||a.HEARTBEAT_INTERVAL}static init(f){return i.__awaiter(this,void 0,void 0,function*(){const y=new c(f);return yield y.init(),y})}init(){return i.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(f,y){this.events.on(f,y)}once(f,y){this.events.once(f,y)}off(f,y){this.events.off(f,y)}removeListener(f,y){this.events.removeListener(f,y)}initialize(){return i.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return Xn.HeartBeat=c,Xn}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=Ga;e.__exportStar(I3(),i),e.__exportStar(jp(),i),e.__exportStar(Lp(),i)})(Cn);var Qe={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var su=function(i,e){return su=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var a in s)s.hasOwnProperty(a)&&(t[a]=s[a])},su(i,e)};function S3(i,e){su(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var au=function(){return au=Object.assign||function(e){for(var t,s=1,a=arguments.length;s<a;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},au.apply(this,arguments)};function x3(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(i);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(i,s[a])&&(t[s[a]]=i[s[a]]);return t}function O3(i,e,t,s){var a=arguments.length,c=a<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(p=i[f])&&(c=(a<3?p(c):a>3?p(e,t,c):p(e,t))||c);return a>3&&c&&Object.defineProperty(e,t,c),c}function P3(i,e){return function(t,s){e(t,s,i)}}function C3(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function A3(i,e,t,s){function a(c){return c instanceof t?c:new t(function(p){p(c)})}return new(t||(t=Promise))(function(c,p){function f(_){try{d(s.next(_))}catch(I){p(I)}}function y(_){try{d(s.throw(_))}catch(I){p(I)}}function d(_){_.done?c(_.value):a(_.value).then(f,y)}d((s=s.apply(i,e||[])).next())})}function T3(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,a,c,p;return p={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function f(d){return function(_){return y([d,_])}}function y(d){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,a&&(c=d[0]&2?a.return:d[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,d[1])).done)return c;switch(a=0,c&&(d=[d[0]&2,c.value]),d[0]){case 0:case 1:c=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,a=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!c||d[1]>c[0]&&d[1]<c[3])){t.label=d[1];break}if(d[0]===6&&t.label<c[1]){t.label=c[1],c=d;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(d);break}c[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(i,t)}catch(_){d=[6,_],a=0}finally{s=c=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function N3(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function R3(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function ou(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Mp(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),a,c=[],p;try{for(;(e===void 0||e-- >0)&&!(a=s.next()).done;)c.push(a.value)}catch(f){p={error:f}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(p)throw p.error}}return c}function $3(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(Mp(arguments[e]));return i}function F3(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),a=0,e=0;e<t;e++)for(var c=arguments[e],p=0,f=c.length;p<f;p++,a++)s[a]=c[p];return s}function cs(i){return this instanceof cs?(this.v=i,this):new cs(i)}function U3(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),a,c=[];return a={},p("next"),p("throw"),p("return"),a[Symbol.asyncIterator]=function(){return this},a;function p(D){s[D]&&(a[D]=function(O){return new Promise(function(A,B){c.push([D,O,A,B])>1||f(D,O)})})}function f(D,O){try{y(s[D](O))}catch(A){I(c[0][3],A)}}function y(D){D.value instanceof cs?Promise.resolve(D.value.v).then(d,_):I(c[0][2],D)}function d(D){f("next",D)}function _(D){f("throw",D)}function I(D,O){D(O),c.shift(),c.length&&f(c[0][0],c[0][1])}}function j3(i){var e,t;return e={},s("next"),s("throw",function(a){throw a}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(a,c){e[a]=i[a]?function(p){return(t=!t)?{value:cs(i[a](p)),done:a==="return"}:c?c(p):p}:c}}function L3(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof ou=="function"?ou(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(p){return new Promise(function(f,y){p=i[c](p),a(f,y,p.done,p.value)})}}function a(c,p,f,y){Promise.resolve(y).then(function(d){c({value:d,done:f})},p)}}function M3(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function z3(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function q3(i){return i&&i.__esModule?i:{default:i}}function B3(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function H3(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const K3=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return au},__asyncDelegator:j3,__asyncGenerator:U3,__asyncValues:L3,__await:cs,__awaiter:A3,__classPrivateFieldGet:B3,__classPrivateFieldSet:H3,__createBinding:N3,__decorate:O3,__exportStar:R3,__extends:S3,__generator:T3,__importDefault:q3,__importStar:z3,__makeTemplateObject:M3,__metadata:C3,__param:P3,__read:Mp,__rest:x3,__spread:$3,__spreadArrays:F3,__values:ou},Symbol.toStringTag,{value:"Module"})),V3=La(K3);var Tc,vf;function k3(){if(vf)return Tc;vf=1;function i(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}Tc=e;function e(t,s,a){var c=a&&a.stringify||i,p=1;if(typeof t=="object"&&t!==null){var f=s.length+p;if(f===1)return t;var y=new Array(f);y[0]=c(t);for(var d=1;d<f;d++)y[d]=c(s[d]);return y.join(" ")}if(typeof t!="string")return t;var _=s.length;if(_===0)return t;for(var I="",D=1-p,O=-1,A=t&&t.length||0,B=0;B<A;){if(t.charCodeAt(B)===37&&B+1<A){switch(O=O>-1?O:0,t.charCodeAt(B+1)){case 100:case 102:if(D>=_||s[D]==null)break;O<B&&(I+=t.slice(O,B)),I+=Number(s[D]),O=B+2,B++;break;case 105:if(D>=_||s[D]==null)break;O<B&&(I+=t.slice(O,B)),I+=Math.floor(Number(s[D])),O=B+2,B++;break;case 79:case 111:case 106:if(D>=_||s[D]===void 0)break;O<B&&(I+=t.slice(O,B));var G=typeof s[D];if(G==="string"){I+="'"+s[D]+"'",O=B+2,B++;break}if(G==="function"){I+=s[D].name||"<anonymous>",O=B+2,B++;break}I+=c(s[D]),O=B+2,B++;break;case 115:if(D>=_)break;O<B&&(I+=t.slice(O,B)),I+=String(s[D]),O=B+2,B++;break;case 37:O<B&&(I+=t.slice(O,B)),I+="%",O=B+2,B++,D--;break}++D}++B}return O===-1?t:(O<A&&(I+=t.slice(O)),I)}return Tc}var Nc,mf;function G3(){if(mf)return Nc;mf=1;const i=k3();Nc=a;const e=C().console||{},t={mapHttpRequest:A,mapHttpResponse:A,wrapRequestSerializer:B,wrapResponseSerializer:B,wrapErrorSerializer:B,req:A,res:A,err:D};function s(w,u){return Array.isArray(w)?w.filter(function(K){return K!=="!stdSerializers.err"}):w===!0?Object.keys(u):!1}function a(w){w=w||{},w.browser=w.browser||{};const u=w.browser.transmit;if(u&&typeof u.send!="function")throw Error("pino: transmit option must have a send function");const b=w.browser.write||e;w.browser.write&&(w.browser.asObject=!0);const K=w.serializers||{},k=s(w.browser.serialize,K);let ae=w.browser.serialize;Array.isArray(w.browser.serialize)&&w.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ae=!1);const ce=["error","fatal","warn","info","debug","trace"];typeof b=="function"&&(b.error=b.fatal=b.warn=b.info=b.debug=b.trace=b),w.enabled===!1&&(w.level="silent");const ge=w.level||"info",$=Object.create(b);$.log||($.log=G),Object.defineProperty($,"levelVal",{get:le}),Object.defineProperty($,"level",{get:te,set:W});const q={transmit:u,serialize:k,asObject:w.browser.asObject,levels:ce,timestamp:O(w)};$.levels=a.levels,$.level=ge,$.setMaxListeners=$.getMaxListeners=$.emit=$.addListener=$.on=$.prependListener=$.once=$.prependOnceListener=$.removeListener=$.removeAllListeners=$.listeners=$.listenerCount=$.eventNames=$.write=$.flush=G,$.serializers=K,$._serialize=k,$._stdErrSerialize=ae,$.child=ee,u&&($._logEvent=I());function le(){return this.level==="silent"?1/0:this.levels.values[this.level]}function te(){return this._level}function W(Y){if(Y!=="silent"&&!this.levels.values[Y])throw Error("unknown level "+Y);this._level=Y,c(q,$,"error","log"),c(q,$,"fatal","error"),c(q,$,"warn","error"),c(q,$,"info","log"),c(q,$,"debug","log"),c(q,$,"trace","log")}function ee(Y,re){if(!Y)throw new Error("missing bindings for child Pino");re=re||{},k&&Y.serializers&&(re.serializers=Y.serializers);const xe=re.serializers;if(k&&xe){var ne=Object.assign({},K,xe),be=w.browser.serialize===!0?Object.keys(ne):k;delete Y.serializers,y([Y],be,ne,this._stdErrSerialize)}function he(ve){this._childLevel=(ve._childLevel|0)+1,this.error=d(ve,Y,"error"),this.fatal=d(ve,Y,"fatal"),this.warn=d(ve,Y,"warn"),this.info=d(ve,Y,"info"),this.debug=d(ve,Y,"debug"),this.trace=d(ve,Y,"trace"),ne&&(this.serializers=ne,this._serialize=be),u&&(this._logEvent=I([].concat(ve._logEvent.bindings,Y)))}return he.prototype=this,new he(this)}return $}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=t,a.stdTimeFunctions=Object.assign({},{nullTime:ie,epochTime:N,unixTime:j,isoTime:x});function c(w,u,b,K){const k=Object.getPrototypeOf(u);u[b]=u.levelVal>u.levels.values[b]?G:k[b]?k[b]:e[b]||e[K]||G,p(w,u,b)}function p(w,u,b){!w.transmit&&u[b]===G||(u[b]=function(K){return function(){const ae=w.timestamp(),ce=new Array(arguments.length),ge=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var $=0;$<ce.length;$++)ce[$]=arguments[$];if(w.serialize&&!w.asObject&&y(ce,this._serialize,this.serializers,this._stdErrSerialize),w.asObject?K.call(ge,f(this,b,ce,ae)):K.apply(ge,ce),w.transmit){const q=w.transmit.level||u.level,le=a.levels.values[q],te=a.levels.values[b];if(te<le)return;_(this,{ts:ae,methodLevel:b,methodValue:te,transmitLevel:q,transmitValue:a.levels.values[w.transmit.level||u.level],send:w.transmit.send,val:u.levelVal},ce)}}}(u[b]))}function f(w,u,b,K){w._serialize&&y(b,w._serialize,w.serializers,w._stdErrSerialize);const k=b.slice();let ae=k[0];const ce={};K&&(ce.time=K),ce.level=a.levels.values[u];let ge=(w._childLevel|0)+1;if(ge<1&&(ge=1),ae!==null&&typeof ae=="object"){for(;ge--&&typeof k[0]=="object";)Object.assign(ce,k.shift());ae=k.length?i(k.shift(),k):void 0}else typeof ae=="string"&&(ae=i(k.shift(),k));return ae!==void 0&&(ce.msg=ae),ce}function y(w,u,b,K){for(const k in w)if(K&&w[k]instanceof Error)w[k]=a.stdSerializers.err(w[k]);else if(typeof w[k]=="object"&&!Array.isArray(w[k]))for(const ae in w[k])u&&u.indexOf(ae)>-1&&ae in b&&(w[k][ae]=b[ae](w[k][ae]))}function d(w,u,b){return function(){const K=new Array(1+arguments.length);K[0]=u;for(var k=1;k<K.length;k++)K[k]=arguments[k-1];return w[b].apply(this,K)}}function _(w,u,b){const K=u.send,k=u.ts,ae=u.methodLevel,ce=u.methodValue,ge=u.val,$=w._logEvent.bindings;y(b,w._serialize||Object.keys(w.serializers),w.serializers,w._stdErrSerialize===void 0?!0:w._stdErrSerialize),w._logEvent.ts=k,w._logEvent.messages=b.filter(function(q){return $.indexOf(q)===-1}),w._logEvent.level.label=ae,w._logEvent.level.value=ce,K(ae,w._logEvent,ge),w._logEvent=I($)}function I(w){return{ts:0,messages:[],bindings:w||[],level:{label:"",value:0}}}function D(w){const u={type:w.constructor.name,msg:w.message,stack:w.stack};for(const b in w)u[b]===void 0&&(u[b]=w[b]);return u}function O(w){return typeof w.timestamp=="function"?w.timestamp:w.timestamp===!1?ie:N}function A(){return{}}function B(w){return w}function G(){}function ie(){return!1}function N(){return Date.now()}function j(){return Math.round(Date.now()/1e3)}function x(){return new Date(Date.now()).toISOString()}function C(){function w(u){return typeof u<"u"&&u}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return w(self)||w(window)||w(this)||{}}}return Nc}var Ji={},bf;function zp(){return bf||(bf=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.PINO_CUSTOM_CONTEXT_KEY=Ji.PINO_LOGGER_DEFAULTS=void 0,Ji.PINO_LOGGER_DEFAULTS={level:"info"},Ji.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Ji}var ar={},wf;function W3(){if(wf)return ar;wf=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.generateChildLogger=ar.formatChildLoggerContext=ar.getLoggerContext=ar.setBrowserLoggerContext=ar.getBrowserLoggerContext=ar.getDefaultLoggerOptions=void 0;const i=zp();function e(f){return Object.assign(Object.assign({},f),{level:(f==null?void 0:f.level)||i.PINO_LOGGER_DEFAULTS.level})}ar.getDefaultLoggerOptions=e;function t(f,y=i.PINO_CUSTOM_CONTEXT_KEY){return f[y]||""}ar.getBrowserLoggerContext=t;function s(f,y,d=i.PINO_CUSTOM_CONTEXT_KEY){return f[d]=y,f}ar.setBrowserLoggerContext=s;function a(f,y=i.PINO_CUSTOM_CONTEXT_KEY){let d="";return typeof f.bindings>"u"?d=t(f,y):d=f.bindings().context||"",d}ar.getLoggerContext=a;function c(f,y,d=i.PINO_CUSTOM_CONTEXT_KEY){const _=a(f,d);return _.trim()?`${_}/${y}`:y}ar.formatChildLoggerContext=c;function p(f,y,d=i.PINO_CUSTOM_CONTEXT_KEY){const _=c(f,y,d),I=f.child({context:_});return s(I,_,d)}return ar.generateChildLogger=p,ar}(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.pino=void 0;const e=V3,t=e.__importDefault(G3());Object.defineProperty(i,"pino",{enumerable:!0,get:function(){return t.default}}),e.__exportStar(zp(),i),e.__exportStar(W3(),i)})(Qe);class Y3 extends tn{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class J3 extends tn{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}}class X3{constructor(e,t){this.logger=e,this.core=t}}let Z3=class extends tn{constructor(e,t){super(),this.relayer=e,this.logger=t}},Q3=class extends tn{constructor(e){super()}},e6=class{constructor(e,t,s,a){this.core=e,this.logger=t,this.name=s}};class t6 extends tn{constructor(e,t){super(),this.relayer=e,this.logger=t}}let r6=class extends tn{constructor(e,t){super(),this.core=e,this.logger=t}},i6=class{constructor(e,t){this.projectId=e,this.logger=t}},n6=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},s6=class{constructor(e){this.client=e}};var Tu={},qp={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Ue,t=Sr;i.DIGEST_LENGTH=64,i.BLOCK_SIZE=128;var s=function(){function f(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},f.prototype.update=function(y,d){if(d===void 0&&(d=y.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var _=0;if(this._bytesHashed+=d,this._bufferLength>0){for(;this._bufferLength<i.BLOCK_SIZE&&d>0;)this._buffer[this._bufferLength++]=y[_++],d--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(d>=this.blockSize&&(_=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,y,_,d),d%=this.blockSize);d>0;)this._buffer[this._bufferLength++]=y[_++],d--;return this},f.prototype.finish=function(y){if(!this._finished){var d=this._bytesHashed,_=this._bufferLength,I=d/536870912|0,D=d<<3,O=d%128<112?128:256;this._buffer[_]=128;for(var A=_+1;A<O-8;A++)this._buffer[A]=0;e.writeUint32BE(I,this._buffer,O-8),e.writeUint32BE(D,this._buffer,O-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,O),this._finished=!0}for(var A=0;A<this.digestLength/8;A++)e.writeUint32BE(this._stateHi[A],y,A*8),e.writeUint32BE(this._stateLo[A],y,A*8+4);return this},f.prototype.digest=function(){var y=new Uint8Array(this.digestLength);return this.finish(y),y},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(y){return this._stateHi.set(y.stateHi),this._stateLo.set(y.stateLo),this._bufferLength=y.bufferLength,y.buffer&&this._buffer.set(y.buffer),this._bytesHashed=y.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(y){t.wipe(y.stateHi),t.wipe(y.stateLo),y.buffer&&t.wipe(y.buffer),y.bufferLength=0,y.bytesHashed=0},f}();i.SHA512=s;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(f,y,d,_,I,D,O){for(var A=d[0],B=d[1],G=d[2],ie=d[3],N=d[4],j=d[5],x=d[6],C=d[7],w=_[0],u=_[1],b=_[2],K=_[3],k=_[4],ae=_[5],ce=_[6],ge=_[7],$,q,le,te,W,ee,Y,re;O>=128;){for(var xe=0;xe<16;xe++){var ne=8*xe+D;f[xe]=e.readUint32BE(I,ne),y[xe]=e.readUint32BE(I,ne+4)}for(var xe=0;xe<80;xe++){var be=A,he=B,ve=G,z=ie,M=N,R=j,l=x,P=C,se=w,fe=u,Ie=b,Be=K,Ve=k,je=ae,pt=ce,dt=ge;if($=C,q=ge,W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=(N>>>14|k<<32-14)^(N>>>18|k<<32-18)^(k>>>41-32|N<<32-(41-32)),q=(k>>>14|N<<32-14)^(k>>>18|N<<32-18)^(N>>>41-32|k<<32-(41-32)),W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,$=N&j^~N&x,q=k&ae^~k&ce,W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,$=a[xe*2],q=a[xe*2+1],W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,$=f[xe%16],q=y[xe%16],W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,le=Y&65535|re<<16,te=W&65535|ee<<16,$=le,q=te,W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=(A>>>28|w<<32-28)^(w>>>34-32|A<<32-(34-32))^(w>>>39-32|A<<32-(39-32)),q=(w>>>28|A<<32-28)^(A>>>34-32|w<<32-(34-32))^(A>>>39-32|w<<32-(39-32)),W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,$=A&B^A&G^B&G,q=w&u^w&b^u&b,W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,P=Y&65535|re<<16,dt=W&65535|ee<<16,$=z,q=Be,W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=le,q=te,W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,z=Y&65535|re<<16,Be=W&65535|ee<<16,B=be,G=he,ie=ve,N=z,j=M,x=R,C=l,A=P,u=se,b=fe,K=Ie,k=Be,ae=Ve,ce=je,ge=pt,w=dt,xe%16===15)for(var ne=0;ne<16;ne++)$=f[ne],q=y[ne],W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=f[(ne+9)%16],q=y[(ne+9)%16],W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,le=f[(ne+1)%16],te=y[(ne+1)%16],$=(le>>>1|te<<32-1)^(le>>>8|te<<32-8)^le>>>7,q=(te>>>1|le<<32-1)^(te>>>8|le<<32-8)^(te>>>7|le<<32-7),W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,le=f[(ne+14)%16],te=y[(ne+14)%16],$=(le>>>19|te<<32-19)^(te>>>61-32|le<<32-(61-32))^le>>>6,q=(te>>>19|le<<32-19)^(le>>>61-32|te<<32-(61-32))^(te>>>6|le<<32-6),W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,f[ne]=Y&65535|re<<16,y[ne]=W&65535|ee<<16}$=A,q=w,W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=d[0],q=_[0],W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,d[0]=A=Y&65535|re<<16,_[0]=w=W&65535|ee<<16,$=B,q=u,W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=d[1],q=_[1],W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,d[1]=B=Y&65535|re<<16,_[1]=u=W&65535|ee<<16,$=G,q=b,W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=d[2],q=_[2],W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,d[2]=G=Y&65535|re<<16,_[2]=b=W&65535|ee<<16,$=ie,q=K,W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=d[3],q=_[3],W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,d[3]=ie=Y&65535|re<<16,_[3]=K=W&65535|ee<<16,$=N,q=k,W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=d[4],q=_[4],W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,d[4]=N=Y&65535|re<<16,_[4]=k=W&65535|ee<<16,$=j,q=ae,W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=d[5],q=_[5],W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,d[5]=j=Y&65535|re<<16,_[5]=ae=W&65535|ee<<16,$=x,q=ce,W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=d[6],q=_[6],W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,d[6]=x=Y&65535|re<<16,_[6]=ce=W&65535|ee<<16,$=C,q=ge,W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=d[7],q=_[7],W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,d[7]=C=Y&65535|re<<16,_[7]=ge=W&65535|ee<<16,D+=128,O-=128}return D}function p(f){var y=new s;y.update(f);var d=y.digest();return y.clean(),d}i.hash=p})(qp);(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.convertSecretKeyToX25519=i.convertPublicKeyToX25519=i.verify=i.sign=i.extractPublicKeyFromSecretKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.SEED_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=i.SIGNATURE_LENGTH=void 0;const e=On,t=qp,s=Sr;i.SIGNATURE_LENGTH=64,i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=64,i.SEED_LENGTH=32;function a(z){const M=new Float64Array(16);if(z)for(let R=0;R<z.length;R++)M[R]=z[R];return M}const c=new Uint8Array(32);c[0]=9;const p=a(),f=a([1]),y=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),d=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),_=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),I=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),D=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function O(z,M){for(let R=0;R<16;R++)z[R]=M[R]|0}function A(z){let M=1;for(let R=0;R<16;R++){let l=z[R]+M+65535;M=Math.floor(l/65536),z[R]=l-M*65536}z[0]+=M-1+37*(M-1)}function B(z,M,R){const l=~(R-1);for(let P=0;P<16;P++){const se=l&(z[P]^M[P]);z[P]^=se,M[P]^=se}}function G(z,M){const R=a(),l=a();for(let P=0;P<16;P++)l[P]=M[P];A(l),A(l),A(l);for(let P=0;P<2;P++){R[0]=l[0]-65517;for(let fe=1;fe<15;fe++)R[fe]=l[fe]-65535-(R[fe-1]>>16&1),R[fe-1]&=65535;R[15]=l[15]-32767-(R[14]>>16&1);const se=R[15]>>16&1;R[14]&=65535,B(l,R,1-se)}for(let P=0;P<16;P++)z[2*P]=l[P]&255,z[2*P+1]=l[P]>>8}function ie(z,M){let R=0;for(let l=0;l<32;l++)R|=z[l]^M[l];return(1&R-1>>>8)-1}function N(z,M){const R=new Uint8Array(32),l=new Uint8Array(32);return G(R,z),G(l,M),ie(R,l)}function j(z){const M=new Uint8Array(32);return G(M,z),M[0]&1}function x(z,M){for(let R=0;R<16;R++)z[R]=M[2*R]+(M[2*R+1]<<8);z[15]&=32767}function C(z,M,R){for(let l=0;l<16;l++)z[l]=M[l]+R[l]}function w(z,M,R){for(let l=0;l<16;l++)z[l]=M[l]-R[l]}function u(z,M,R){let l,P,se=0,fe=0,Ie=0,Be=0,Ve=0,je=0,pt=0,dt=0,Me=0,Se=0,Re=0,$e=0,ze=0,Pe=0,Fe=0,De=0,Ce=0,He=0,Oe=0,ke=0,We=0,et=0,tt=0,Je=0,er=0,hr=0,Vr=0,tr=0,ri=0,gi=0,Ri=0,bt=R[0],gt=R[1],wt=R[2],Et=R[3],vt=R[4],yt=R[5],$t=R[6],Ft=R[7],Dt=R[8],Ut=R[9],It=R[10],Pt=R[11],St=R[12],ht=R[13],jt=R[14],Lt=R[15];l=M[0],se+=l*bt,fe+=l*gt,Ie+=l*wt,Be+=l*Et,Ve+=l*vt,je+=l*yt,pt+=l*$t,dt+=l*Ft,Me+=l*Dt,Se+=l*Ut,Re+=l*It,$e+=l*Pt,ze+=l*St,Pe+=l*ht,Fe+=l*jt,De+=l*Lt,l=M[1],fe+=l*bt,Ie+=l*gt,Be+=l*wt,Ve+=l*Et,je+=l*vt,pt+=l*yt,dt+=l*$t,Me+=l*Ft,Se+=l*Dt,Re+=l*Ut,$e+=l*It,ze+=l*Pt,Pe+=l*St,Fe+=l*ht,De+=l*jt,Ce+=l*Lt,l=M[2],Ie+=l*bt,Be+=l*gt,Ve+=l*wt,je+=l*Et,pt+=l*vt,dt+=l*yt,Me+=l*$t,Se+=l*Ft,Re+=l*Dt,$e+=l*Ut,ze+=l*It,Pe+=l*Pt,Fe+=l*St,De+=l*ht,Ce+=l*jt,He+=l*Lt,l=M[3],Be+=l*bt,Ve+=l*gt,je+=l*wt,pt+=l*Et,dt+=l*vt,Me+=l*yt,Se+=l*$t,Re+=l*Ft,$e+=l*Dt,ze+=l*Ut,Pe+=l*It,Fe+=l*Pt,De+=l*St,Ce+=l*ht,He+=l*jt,Oe+=l*Lt,l=M[4],Ve+=l*bt,je+=l*gt,pt+=l*wt,dt+=l*Et,Me+=l*vt,Se+=l*yt,Re+=l*$t,$e+=l*Ft,ze+=l*Dt,Pe+=l*Ut,Fe+=l*It,De+=l*Pt,Ce+=l*St,He+=l*ht,Oe+=l*jt,ke+=l*Lt,l=M[5],je+=l*bt,pt+=l*gt,dt+=l*wt,Me+=l*Et,Se+=l*vt,Re+=l*yt,$e+=l*$t,ze+=l*Ft,Pe+=l*Dt,Fe+=l*Ut,De+=l*It,Ce+=l*Pt,He+=l*St,Oe+=l*ht,ke+=l*jt,We+=l*Lt,l=M[6],pt+=l*bt,dt+=l*gt,Me+=l*wt,Se+=l*Et,Re+=l*vt,$e+=l*yt,ze+=l*$t,Pe+=l*Ft,Fe+=l*Dt,De+=l*Ut,Ce+=l*It,He+=l*Pt,Oe+=l*St,ke+=l*ht,We+=l*jt,et+=l*Lt,l=M[7],dt+=l*bt,Me+=l*gt,Se+=l*wt,Re+=l*Et,$e+=l*vt,ze+=l*yt,Pe+=l*$t,Fe+=l*Ft,De+=l*Dt,Ce+=l*Ut,He+=l*It,Oe+=l*Pt,ke+=l*St,We+=l*ht,et+=l*jt,tt+=l*Lt,l=M[8],Me+=l*bt,Se+=l*gt,Re+=l*wt,$e+=l*Et,ze+=l*vt,Pe+=l*yt,Fe+=l*$t,De+=l*Ft,Ce+=l*Dt,He+=l*Ut,Oe+=l*It,ke+=l*Pt,We+=l*St,et+=l*ht,tt+=l*jt,Je+=l*Lt,l=M[9],Se+=l*bt,Re+=l*gt,$e+=l*wt,ze+=l*Et,Pe+=l*vt,Fe+=l*yt,De+=l*$t,Ce+=l*Ft,He+=l*Dt,Oe+=l*Ut,ke+=l*It,We+=l*Pt,et+=l*St,tt+=l*ht,Je+=l*jt,er+=l*Lt,l=M[10],Re+=l*bt,$e+=l*gt,ze+=l*wt,Pe+=l*Et,Fe+=l*vt,De+=l*yt,Ce+=l*$t,He+=l*Ft,Oe+=l*Dt,ke+=l*Ut,We+=l*It,et+=l*Pt,tt+=l*St,Je+=l*ht,er+=l*jt,hr+=l*Lt,l=M[11],$e+=l*bt,ze+=l*gt,Pe+=l*wt,Fe+=l*Et,De+=l*vt,Ce+=l*yt,He+=l*$t,Oe+=l*Ft,ke+=l*Dt,We+=l*Ut,et+=l*It,tt+=l*Pt,Je+=l*St,er+=l*ht,hr+=l*jt,Vr+=l*Lt,l=M[12],ze+=l*bt,Pe+=l*gt,Fe+=l*wt,De+=l*Et,Ce+=l*vt,He+=l*yt,Oe+=l*$t,ke+=l*Ft,We+=l*Dt,et+=l*Ut,tt+=l*It,Je+=l*Pt,er+=l*St,hr+=l*ht,Vr+=l*jt,tr+=l*Lt,l=M[13],Pe+=l*bt,Fe+=l*gt,De+=l*wt,Ce+=l*Et,He+=l*vt,Oe+=l*yt,ke+=l*$t,We+=l*Ft,et+=l*Dt,tt+=l*Ut,Je+=l*It,er+=l*Pt,hr+=l*St,Vr+=l*ht,tr+=l*jt,ri+=l*Lt,l=M[14],Fe+=l*bt,De+=l*gt,Ce+=l*wt,He+=l*Et,Oe+=l*vt,ke+=l*yt,We+=l*$t,et+=l*Ft,tt+=l*Dt,Je+=l*Ut,er+=l*It,hr+=l*Pt,Vr+=l*St,tr+=l*ht,ri+=l*jt,gi+=l*Lt,l=M[15],De+=l*bt,Ce+=l*gt,He+=l*wt,Oe+=l*Et,ke+=l*vt,We+=l*yt,et+=l*$t,tt+=l*Ft,Je+=l*Dt,er+=l*Ut,hr+=l*It,Vr+=l*Pt,tr+=l*St,ri+=l*ht,gi+=l*jt,Ri+=l*Lt,se+=38*Ce,fe+=38*He,Ie+=38*Oe,Be+=38*ke,Ve+=38*We,je+=38*et,pt+=38*tt,dt+=38*Je,Me+=38*er,Se+=38*hr,Re+=38*Vr,$e+=38*tr,ze+=38*ri,Pe+=38*gi,Fe+=38*Ri,P=1,l=se+P+65535,P=Math.floor(l/65536),se=l-P*65536,l=fe+P+65535,P=Math.floor(l/65536),fe=l-P*65536,l=Ie+P+65535,P=Math.floor(l/65536),Ie=l-P*65536,l=Be+P+65535,P=Math.floor(l/65536),Be=l-P*65536,l=Ve+P+65535,P=Math.floor(l/65536),Ve=l-P*65536,l=je+P+65535,P=Math.floor(l/65536),je=l-P*65536,l=pt+P+65535,P=Math.floor(l/65536),pt=l-P*65536,l=dt+P+65535,P=Math.floor(l/65536),dt=l-P*65536,l=Me+P+65535,P=Math.floor(l/65536),Me=l-P*65536,l=Se+P+65535,P=Math.floor(l/65536),Se=l-P*65536,l=Re+P+65535,P=Math.floor(l/65536),Re=l-P*65536,l=$e+P+65535,P=Math.floor(l/65536),$e=l-P*65536,l=ze+P+65535,P=Math.floor(l/65536),ze=l-P*65536,l=Pe+P+65535,P=Math.floor(l/65536),Pe=l-P*65536,l=Fe+P+65535,P=Math.floor(l/65536),Fe=l-P*65536,l=De+P+65535,P=Math.floor(l/65536),De=l-P*65536,se+=P-1+37*(P-1),P=1,l=se+P+65535,P=Math.floor(l/65536),se=l-P*65536,l=fe+P+65535,P=Math.floor(l/65536),fe=l-P*65536,l=Ie+P+65535,P=Math.floor(l/65536),Ie=l-P*65536,l=Be+P+65535,P=Math.floor(l/65536),Be=l-P*65536,l=Ve+P+65535,P=Math.floor(l/65536),Ve=l-P*65536,l=je+P+65535,P=Math.floor(l/65536),je=l-P*65536,l=pt+P+65535,P=Math.floor(l/65536),pt=l-P*65536,l=dt+P+65535,P=Math.floor(l/65536),dt=l-P*65536,l=Me+P+65535,P=Math.floor(l/65536),Me=l-P*65536,l=Se+P+65535,P=Math.floor(l/65536),Se=l-P*65536,l=Re+P+65535,P=Math.floor(l/65536),Re=l-P*65536,l=$e+P+65535,P=Math.floor(l/65536),$e=l-P*65536,l=ze+P+65535,P=Math.floor(l/65536),ze=l-P*65536,l=Pe+P+65535,P=Math.floor(l/65536),Pe=l-P*65536,l=Fe+P+65535,P=Math.floor(l/65536),Fe=l-P*65536,l=De+P+65535,P=Math.floor(l/65536),De=l-P*65536,se+=P-1+37*(P-1),z[0]=se,z[1]=fe,z[2]=Ie,z[3]=Be,z[4]=Ve,z[5]=je,z[6]=pt,z[7]=dt,z[8]=Me,z[9]=Se,z[10]=Re,z[11]=$e,z[12]=ze,z[13]=Pe,z[14]=Fe,z[15]=De}function b(z,M){u(z,M,M)}function K(z,M){const R=a();let l;for(l=0;l<16;l++)R[l]=M[l];for(l=253;l>=0;l--)b(R,R),l!==2&&l!==4&&u(R,R,M);for(l=0;l<16;l++)z[l]=R[l]}function k(z,M){const R=a();let l;for(l=0;l<16;l++)R[l]=M[l];for(l=250;l>=0;l--)b(R,R),l!==1&&u(R,R,M);for(l=0;l<16;l++)z[l]=R[l]}function ae(z,M){const R=a(),l=a(),P=a(),se=a(),fe=a(),Ie=a(),Be=a(),Ve=a(),je=a();w(R,z[1],z[0]),w(je,M[1],M[0]),u(R,R,je),C(l,z[0],z[1]),C(je,M[0],M[1]),u(l,l,je),u(P,z[3],M[3]),u(P,P,d),u(se,z[2],M[2]),C(se,se,se),w(fe,l,R),w(Ie,se,P),C(Be,se,P),C(Ve,l,R),u(z[0],fe,Ie),u(z[1],Ve,Be),u(z[2],Be,Ie),u(z[3],fe,Ve)}function ce(z,M,R){for(let l=0;l<4;l++)B(z[l],M[l],R)}function ge(z,M){const R=a(),l=a(),P=a();K(P,M[2]),u(R,M[0],P),u(l,M[1],P),G(z,l),z[31]^=j(R)<<7}function $(z,M,R){O(z[0],p),O(z[1],f),O(z[2],f),O(z[3],p);for(let l=255;l>=0;--l){const P=R[l/8|0]>>(l&7)&1;ce(z,M,P),ae(M,z),ae(z,z),ce(z,M,P)}}function q(z,M){const R=[a(),a(),a(),a()];O(R[0],_),O(R[1],I),O(R[2],f),u(R[3],_,I),$(z,R,M)}function le(z){if(z.length!==i.SEED_LENGTH)throw new Error(`ed25519: seed must be ${i.SEED_LENGTH} bytes`);const M=(0,t.hash)(z);M[0]&=248,M[31]&=127,M[31]|=64;const R=new Uint8Array(32),l=[a(),a(),a(),a()];q(l,M),ge(R,l);const P=new Uint8Array(64);return P.set(z),P.set(R,32),{publicKey:R,secretKey:P}}i.generateKeyPairFromSeed=le;function te(z){const M=(0,e.randomBytes)(32,z),R=le(M);return(0,s.wipe)(M),R}i.generateKeyPair=te;function W(z){if(z.length!==i.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${i.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(z.subarray(32))}i.extractPublicKeyFromSecretKey=W;const ee=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Y(z,M){let R,l,P,se;for(l=63;l>=32;--l){for(R=0,P=l-32,se=l-12;P<se;++P)M[P]+=R-16*M[l]*ee[P-(l-32)],R=Math.floor((M[P]+128)/256),M[P]-=R*256;M[P]+=R,M[l]=0}for(R=0,P=0;P<32;P++)M[P]+=R-(M[31]>>4)*ee[P],R=M[P]>>8,M[P]&=255;for(P=0;P<32;P++)M[P]-=R*ee[P];for(l=0;l<32;l++)M[l+1]+=M[l]>>8,z[l]=M[l]&255}function re(z){const M=new Float64Array(64);for(let R=0;R<64;R++)M[R]=z[R];for(let R=0;R<64;R++)z[R]=0;Y(z,M)}function xe(z,M){const R=new Float64Array(64),l=[a(),a(),a(),a()],P=(0,t.hash)(z.subarray(0,32));P[0]&=248,P[31]&=127,P[31]|=64;const se=new Uint8Array(64);se.set(P.subarray(32),32);const fe=new t.SHA512;fe.update(se.subarray(32)),fe.update(M);const Ie=fe.digest();fe.clean(),re(Ie),q(l,Ie),ge(se,l),fe.reset(),fe.update(se.subarray(0,32)),fe.update(z.subarray(32)),fe.update(M);const Be=fe.digest();re(Be);for(let Ve=0;Ve<32;Ve++)R[Ve]=Ie[Ve];for(let Ve=0;Ve<32;Ve++)for(let je=0;je<32;je++)R[Ve+je]+=Be[Ve]*P[je];return Y(se.subarray(32),R),se}i.sign=xe;function ne(z,M){const R=a(),l=a(),P=a(),se=a(),fe=a(),Ie=a(),Be=a();return O(z[2],f),x(z[1],M),b(P,z[1]),u(se,P,y),w(P,P,z[2]),C(se,z[2],se),b(fe,se),b(Ie,fe),u(Be,Ie,fe),u(R,Be,P),u(R,R,se),k(R,R),u(R,R,P),u(R,R,se),u(R,R,se),u(z[0],R,se),b(l,z[0]),u(l,l,se),N(l,P)&&u(z[0],z[0],D),b(l,z[0]),u(l,l,se),N(l,P)?-1:(j(z[0])===M[31]>>7&&w(z[0],p,z[0]),u(z[3],z[0],z[1]),0)}function be(z,M,R){const l=new Uint8Array(32),P=[a(),a(),a(),a()],se=[a(),a(),a(),a()];if(R.length!==i.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${i.SIGNATURE_LENGTH} bytes`);if(ne(se,z))return!1;const fe=new t.SHA512;fe.update(R.subarray(0,32)),fe.update(z),fe.update(M);const Ie=fe.digest();return re(Ie),$(P,se,Ie),q(se,R.subarray(32)),ae(P,se),ge(l,P),!ie(R,l)}i.verify=be;function he(z){let M=[a(),a(),a(),a()];if(ne(M,z))throw new Error("Ed25519: invalid public key");let R=a(),l=a(),P=M[1];C(R,f,P),w(l,f,P),K(l,l),u(R,R,l);let se=new Uint8Array(32);return G(se,R),se}i.convertPublicKeyToX25519=he;function ve(z){const M=(0,t.hash)(z.subarray(0,32));M[0]&=248,M[31]&=127,M[31]|=64;const R=new Uint8Array(M.subarray(0,32));return(0,s.wipe)(M),R}i.convertSecretKeyToX25519=ve})(Tu);const a6="EdDSA",o6="JWT",Bp=".",Hp="base64url",c6="utf8",u6="utf8",h6=":",l6="did",f6="key",Ef="base58btc",p6="z",d6="K36",g6=32;function Fa(i){return ur(vr(us(i),c6),Hp)}function Kp(i){const e=vr(d6,Ef),t=p6+ur(Gc([e,i]),Ef);return[l6,f6,t].join(h6)}function y6(i){return ur(i,Hp)}function _6(i){return vr([Fa(i.header),Fa(i.payload)].join(Bp),u6)}function v6(i){return[Fa(i.header),Fa(i.payload),y6(i.signature)].join(Bp)}function Df(i=On.randomBytes(g6)){return Tu.generateKeyPairFromSeed(i)}async function m6(i,e,t,s,a=_e.fromMiliseconds(Date.now())){const c={alg:a6,typ:o6},p=Kp(s.publicKey),f=a+t,y={iss:p,sub:i,aud:e,iat:a,exp:f},d=_6({header:c,payload:y}),_=Tu.sign(s.secretKey,d);return v6({header:c,payload:y,signature:_})}const b6=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),w6=()=>typeof window<"u",If=i=>i.split("?")[0],Sf=10,E6=b6();class D6{constructor(e){if(this.url=e,this.events=new ti.EventEmitter,this.registering=!1,!Ul(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),e()},this.socket.close()})}async send(e,t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(us(e))}catch(s){this.onError(e.id,s)}}register(e=this.url){if(!Ul(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,a)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),a(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,s)=>{const a=Qv.isReactNative()?void 0:{rejectUnauthorized:!em(e)},c=new E6(e,[],a);w6()?c.onerror=p=>{const f=p;s(this.emitError(f.error))}:c.on("error",p=>{s(this.emitError(p))}),c.onopen=()=>{this.onOpen(c),t(c)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Ma(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),a=s.message||s.toString(),c=gu(e,a);this.events.emit("payload",c)}parseError(e,t=this.url){return tm(e,If(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Sf&&this.events.setMaxListeners(Sf)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${If(this.url)}`));return this.events.emit("register_error",t),t}}var Ua={exports:{}};Ua.exports;(function(i,e){var t=200,s="__lodash_hash_undefined__",a=1,c=2,p=9007199254740991,f="[object Arguments]",y="[object Array]",d="[object AsyncFunction]",_="[object Boolean]",I="[object Date]",D="[object Error]",O="[object Function]",A="[object GeneratorFunction]",B="[object Map]",G="[object Number]",ie="[object Null]",N="[object Object]",j="[object Promise]",x="[object Proxy]",C="[object RegExp]",w="[object Set]",u="[object String]",b="[object Symbol]",K="[object Undefined]",k="[object WeakMap]",ae="[object ArrayBuffer]",ce="[object DataView]",ge="[object Float32Array]",$="[object Float64Array]",q="[object Int8Array]",le="[object Int16Array]",te="[object Int32Array]",W="[object Uint8Array]",ee="[object Uint8ClampedArray]",Y="[object Uint16Array]",re="[object Uint32Array]",xe=/[\\^$.*+?()[\]{}|]/g,ne=/^\[object .+?Constructor\]$/,be=/^(?:0|[1-9]\d*)$/,he={};he[ge]=he[$]=he[q]=he[le]=he[te]=he[W]=he[ee]=he[Y]=he[re]=!0,he[f]=he[y]=he[ae]=he[_]=he[ce]=he[I]=he[D]=he[O]=he[B]=he[G]=he[N]=he[C]=he[w]=he[u]=he[k]=!1;var ve=typeof ma=="object"&&ma&&ma.Object===Object&&ma,z=typeof self=="object"&&self&&self.Object===Object&&self,M=ve||z||Function("return this")(),R=e&&!e.nodeType&&e,l=R&&!0&&i&&!i.nodeType&&i,P=l&&l.exports===R,se=P&&ve.process,fe=function(){try{return se&&se.binding&&se.binding("util")}catch{}}(),Ie=fe&&fe.isTypedArray;function Be(E,F){for(var Z=-1,pe=E==null?0:E.length,ot=0,Te=[];++Z<pe;){var lt=E[Z];F(lt,Z,E)&&(Te[ot++]=lt)}return Te}function Ve(E,F){for(var Z=-1,pe=F.length,ot=E.length;++Z<pe;)E[ot+Z]=F[Z];return E}function je(E,F){for(var Z=-1,pe=E==null?0:E.length;++Z<pe;)if(F(E[Z],Z,E))return!0;return!1}function pt(E,F){for(var Z=-1,pe=Array(E);++Z<E;)pe[Z]=F(Z);return pe}function dt(E){return function(F){return E(F)}}function Me(E,F){return E.has(F)}function Se(E,F){return E==null?void 0:E[F]}function Re(E){var F=-1,Z=Array(E.size);return E.forEach(function(pe,ot){Z[++F]=[ot,pe]}),Z}function $e(E,F){return function(Z){return E(F(Z))}}function ze(E){var F=-1,Z=Array(E.size);return E.forEach(function(pe){Z[++F]=pe}),Z}var Pe=Array.prototype,Fe=Function.prototype,De=Object.prototype,Ce=M["__core-js_shared__"],He=Fe.toString,Oe=De.hasOwnProperty,ke=function(){var E=/[^.]+$/.exec(Ce&&Ce.keys&&Ce.keys.IE_PROTO||"");return E?"Symbol(src)_1."+E:""}(),We=De.toString,et=RegExp("^"+He.call(Oe).replace(xe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=P?M.Buffer:void 0,Je=M.Symbol,er=M.Uint8Array,hr=De.propertyIsEnumerable,Vr=Pe.splice,tr=Je?Je.toStringTag:void 0,ri=Object.getOwnPropertySymbols,gi=tt?tt.isBuffer:void 0,Ri=$e(Object.keys,Object),bt=mr(M,"DataView"),gt=mr(M,"Map"),wt=mr(M,"Promise"),Et=mr(M,"Set"),vt=mr(M,"WeakMap"),yt=mr(Object,"create"),$t=ni(bt),Ft=ni(gt),Dt=ni(wt),Ut=ni(Et),It=ni(vt),Pt=Je?Je.prototype:void 0,St=Pt?Pt.valueOf:void 0;function ht(E){var F=-1,Z=E==null?0:E.length;for(this.clear();++F<Z;){var pe=E[F];this.set(pe[0],pe[1])}}function jt(){this.__data__=yt?yt(null):{},this.size=0}function Lt(E){var F=this.has(E)&&delete this.__data__[E];return this.size-=F?1:0,F}function Ja(E){var F=this.__data__;if(yt){var Z=F[E];return Z===s?void 0:Z}return Oe.call(F,E)?F[E]:void 0}function Xa(E){var F=this.__data__;return yt?F[E]!==void 0:Oe.call(F,E)}function Za(E,F){var Z=this.__data__;return this.size+=this.has(E)?0:1,Z[E]=yt&&F===void 0?s:F,this}ht.prototype.clear=jt,ht.prototype.delete=Lt,ht.prototype.get=Ja,ht.prototype.has=Xa,ht.prototype.set=Za;function xr(E){var F=-1,Z=E==null?0:E.length;for(this.clear();++F<Z;){var pe=E[F];this.set(pe[0],pe[1])}}function Qa(){this.__data__=[],this.size=0}function eo(E){var F=this.__data__,Z=$i(F,E);if(Z<0)return!1;var pe=F.length-1;return Z==pe?F.pop():Vr.call(F,Z,1),--this.size,!0}function to(E){var F=this.__data__,Z=$i(F,E);return Z<0?void 0:F[Z][1]}function ro(E){return $i(this.__data__,E)>-1}function io(E,F){var Z=this.__data__,pe=$i(Z,E);return pe<0?(++this.size,Z.push([E,F])):Z[pe][1]=F,this}xr.prototype.clear=Qa,xr.prototype.delete=eo,xr.prototype.get=to,xr.prototype.has=ro,xr.prototype.set=io;function ii(E){var F=-1,Z=E==null?0:E.length;for(this.clear();++F<Z;){var pe=E[F];this.set(pe[0],pe[1])}}function rn(){this.size=0,this.__data__={hash:new ht,map:new(gt||xr),string:new ht}}function no(E){var F=yi(this,E).delete(E);return this.size-=F?1:0,F}function nn(E){return yi(this,E).get(E)}function so(E){return yi(this,E).has(E)}function ao(E,F){var Z=yi(this,E),pe=Z.size;return Z.set(E,F),this.size+=Z.size==pe?0:1,this}ii.prototype.clear=rn,ii.prototype.delete=no,ii.prototype.get=nn,ii.prototype.has=so,ii.prototype.set=ao;function sn(E){var F=-1,Z=E==null?0:E.length;for(this.__data__=new ii;++F<Z;)this.add(E[F])}function gs(E){return this.__data__.set(E,s),this}function ys(E){return this.__data__.has(E)}sn.prototype.add=sn.prototype.push=gs,sn.prototype.has=ys;function Lr(E){var F=this.__data__=new xr(E);this.size=F.size}function oo(){this.__data__=new xr,this.size=0}function co(E){var F=this.__data__,Z=F.delete(E);return this.size=F.size,Z}function uo(E){return this.__data__.get(E)}function ho(E){return this.__data__.has(E)}function _s(E,F){var Z=this.__data__;if(Z instanceof xr){var pe=Z.__data__;if(!gt||pe.length<t-1)return pe.push([E,F]),this.size=++Z.size,this;Z=this.__data__=new ii(pe)}return Z.set(E,F),this.size=Z.size,this}Lr.prototype.clear=oo,Lr.prototype.delete=co,Lr.prototype.get=uo,Lr.prototype.has=ho,Lr.prototype.set=_s;function vs(E,F){var Z=cn(E),pe=!Z&&As(E),ot=!Z&&!pe&&Nn(E),Te=!Z&&!pe&&!ot&&Rs(E),lt=Z||pe||ot||Te,Mt=lt?pt(E.length,String):[],Xe=Mt.length;for(var ct in E)(F||Oe.call(E,ct))&&!(lt&&(ct=="length"||ot&&(ct=="offset"||ct=="parent")||Te&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||Ss(ct,Xe)))&&Mt.push(ct);return Mt}function $i(E,F){for(var Z=E.length;Z--;)if(Cs(E[Z][0],F))return Z;return-1}function An(E,F,Z){var pe=F(E);return cn(E)?pe:Ve(pe,Z(E))}function Fi(E){return E==null?E===void 0?K:ie:tr&&tr in Object(E)?Ds(E):po(E)}function Tn(E){return ji(E)&&Fi(E)==f}function Ui(E,F,Z,pe,ot){return E===F?!0:E==null||F==null||!ji(E)&&!ji(F)?E!==E&&F!==F:ms(E,F,Z,pe,Ui,ot)}function ms(E,F,Z,pe,ot,Te){var lt=cn(E),Mt=cn(F),Xe=lt?y:kr(E),ct=Mt?y:kr(F);Xe=Xe==f?N:Xe,ct=ct==f?N:ct;var Ct=Xe==N,lr=ct==N,zt=Xe==ct;if(zt&&Nn(E)){if(!Nn(F))return!1;lt=!0,Ct=!1}if(zt&&!Ct)return Te||(Te=new Lr),lt||Rs(E)?an(E,F,Z,pe,ot,Te):fo(E,F,Xe,Z,pe,ot,Te);if(!(Z&a)){var ft=Ct&&Oe.call(E,"__wrapped__"),rr=lr&&Oe.call(F,"__wrapped__");if(ft||rr){var Mr=ft?E.value():E,Or=rr?F.value():F;return Te||(Te=new Lr),ot(Mr,Or,Z,pe,Te)}}return zt?(Te||(Te=new Lr),Es(E,F,Z,pe,ot,Te)):!1}function lo(E){if(!Ns(E)||Os(E))return!1;var F=un(E)?et:ne;return F.test(ni(E))}function bs(E){return ji(E)&&Ts(E.length)&&!!he[Fi(E)]}function ws(E){if(!Ps(E))return Ri(E);var F=[];for(var Z in Object(E))Oe.call(E,Z)&&Z!="constructor"&&F.push(Z);return F}function an(E,F,Z,pe,ot,Te){var lt=Z&a,Mt=E.length,Xe=F.length;if(Mt!=Xe&&!(lt&&Xe>Mt))return!1;var ct=Te.get(E);if(ct&&Te.get(F))return ct==F;var Ct=-1,lr=!0,zt=Z&c?new sn:void 0;for(Te.set(E,F),Te.set(F,E);++Ct<Mt;){var ft=E[Ct],rr=F[Ct];if(pe)var Mr=lt?pe(rr,ft,Ct,F,E,Te):pe(ft,rr,Ct,E,F,Te);if(Mr!==void 0){if(Mr)continue;lr=!1;break}if(zt){if(!je(F,function(Or,Gr){if(!Me(zt,Gr)&&(ft===Or||ot(ft,Or,Z,pe,Te)))return zt.push(Gr)})){lr=!1;break}}else if(!(ft===rr||ot(ft,rr,Z,pe,Te))){lr=!1;break}}return Te.delete(E),Te.delete(F),lr}function fo(E,F,Z,pe,ot,Te,lt){switch(Z){case ce:if(E.byteLength!=F.byteLength||E.byteOffset!=F.byteOffset)return!1;E=E.buffer,F=F.buffer;case ae:return!(E.byteLength!=F.byteLength||!Te(new er(E),new er(F)));case _:case I:case G:return Cs(+E,+F);case D:return E.name==F.name&&E.message==F.message;case C:case u:return E==F+"";case B:var Mt=Re;case w:var Xe=pe&a;if(Mt||(Mt=ze),E.size!=F.size&&!Xe)return!1;var ct=lt.get(E);if(ct)return ct==F;pe|=c,lt.set(E,F);var Ct=an(Mt(E),Mt(F),pe,ot,Te,lt);return lt.delete(E),Ct;case b:if(St)return St.call(E)==St.call(F)}return!1}function Es(E,F,Z,pe,ot,Te){var lt=Z&a,Mt=on(E),Xe=Mt.length,ct=on(F),Ct=ct.length;if(Xe!=Ct&&!lt)return!1;for(var lr=Xe;lr--;){var zt=Mt[lr];if(!(lt?zt in F:Oe.call(F,zt)))return!1}var ft=Te.get(E);if(ft&&Te.get(F))return ft==F;var rr=!0;Te.set(E,F),Te.set(F,E);for(var Mr=lt;++lr<Xe;){zt=Mt[lr];var Or=E[zt],Gr=F[zt];if(pe)var Rn=lt?pe(Gr,Or,zt,F,E,Te):pe(Or,Gr,zt,E,F,Te);if(!(Rn===void 0?Or===Gr||ot(Or,Gr,Z,pe,Te):Rn)){rr=!1;break}Mr||(Mr=zt=="constructor")}if(rr&&!Mr){var Li=E.constructor,Kt=F.constructor;Li!=Kt&&"constructor"in E&&"constructor"in F&&!(typeof Li=="function"&&Li instanceof Li&&typeof Kt=="function"&&Kt instanceof Kt)&&(rr=!1)}return Te.delete(E),Te.delete(F),rr}function on(E){return An(E,_o,Is)}function yi(E,F){var Z=E.__data__;return xs(F)?Z[typeof F=="string"?"string":"hash"]:Z.map}function mr(E,F){var Z=Se(E,F);return lo(Z)?Z:void 0}function Ds(E){var F=Oe.call(E,tr),Z=E[tr];try{E[tr]=void 0;var pe=!0}catch{}var ot=We.call(E);return pe&&(F?E[tr]=Z:delete E[tr]),ot}var Is=ri?function(E){return E==null?[]:(E=Object(E),Be(ri(E),function(F){return hr.call(E,F)}))}:at,kr=Fi;(bt&&kr(new bt(new ArrayBuffer(1)))!=ce||gt&&kr(new gt)!=B||wt&&kr(wt.resolve())!=j||Et&&kr(new Et)!=w||vt&&kr(new vt)!=k)&&(kr=function(E){var F=Fi(E),Z=F==N?E.constructor:void 0,pe=Z?ni(Z):"";if(pe)switch(pe){case $t:return ce;case Ft:return B;case Dt:return j;case Ut:return w;case It:return k}return F});function Ss(E,F){return F=F??p,!!F&&(typeof E=="number"||be.test(E))&&E>-1&&E%1==0&&E<F}function xs(E){var F=typeof E;return F=="string"||F=="number"||F=="symbol"||F=="boolean"?E!=="__proto__":E===null}function Os(E){return!!ke&&ke in E}function Ps(E){var F=E&&E.constructor,Z=typeof F=="function"&&F.prototype||De;return E===Z}function po(E){return We.call(E)}function ni(E){if(E!=null){try{return He.call(E)}catch{}try{return E+""}catch{}}return""}function Cs(E,F){return E===F||E!==E&&F!==F}var As=Tn(function(){return arguments}())?Tn:function(E){return ji(E)&&Oe.call(E,"callee")&&!hr.call(E,"callee")},cn=Array.isArray;function go(E){return E!=null&&Ts(E.length)&&!un(E)}var Nn=gi||st;function yo(E,F){return Ui(E,F)}function un(E){if(!Ns(E))return!1;var F=Fi(E);return F==O||F==A||F==d||F==x}function Ts(E){return typeof E=="number"&&E>-1&&E%1==0&&E<=p}function Ns(E){var F=typeof E;return E!=null&&(F=="object"||F=="function")}function ji(E){return E!=null&&typeof E=="object"}var Rs=Ie?dt(Ie):bs;function _o(E){return go(E)?vs(E):ws(E)}function at(){return[]}function st(){return!1}i.exports=yo})(Ua,Ua.exports);var I6=Ua.exports;const S6=Kv(I6);function x6(i,e){if(i.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var a=0;a<i.length;a++){var c=i.charAt(a),p=c.charCodeAt(0);if(t[p]!==255)throw new TypeError(c+" is ambiguous");t[p]=a}var f=i.length,y=i.charAt(0),d=Math.log(f)/Math.log(256),_=Math.log(256)/Math.log(f);function I(A){if(A instanceof Uint8Array||(ArrayBuffer.isView(A)?A=new Uint8Array(A.buffer,A.byteOffset,A.byteLength):Array.isArray(A)&&(A=Uint8Array.from(A))),!(A instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(A.length===0)return"";for(var B=0,G=0,ie=0,N=A.length;ie!==N&&A[ie]===0;)ie++,B++;for(var j=(N-ie)*_+1>>>0,x=new Uint8Array(j);ie!==N;){for(var C=A[ie],w=0,u=j-1;(C!==0||w<G)&&u!==-1;u--,w++)C+=256*x[u]>>>0,x[u]=C%f>>>0,C=C/f>>>0;if(C!==0)throw new Error("Non-zero carry");G=w,ie++}for(var b=j-G;b!==j&&x[b]===0;)b++;for(var K=y.repeat(B);b<j;++b)K+=i.charAt(x[b]);return K}function D(A){if(typeof A!="string")throw new TypeError("Expected String");if(A.length===0)return new Uint8Array;var B=0;if(A[B]!==" "){for(var G=0,ie=0;A[B]===y;)G++,B++;for(var N=(A.length-B)*d+1>>>0,j=new Uint8Array(N);A[B];){var x=t[A.charCodeAt(B)];if(x===255)return;for(var C=0,w=N-1;(x!==0||C<ie)&&w!==-1;w--,C++)x+=f*j[w]>>>0,j[w]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");ie=C,B++}if(A[B]!==" "){for(var u=N-ie;u!==N&&j[u]===0;)u++;for(var b=new Uint8Array(G+(N-u)),K=G;u!==N;)b[K++]=j[u++];return b}}}function O(A){var B=D(A);if(B)return B;throw new Error(`Non-${e} character`)}return{encode:I,decodeUnsafe:D,decode:O}}var O6=x6,P6=O6;const Vp=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},C6=i=>new TextEncoder().encode(i),A6=i=>new TextDecoder().decode(i);class T6{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class N6{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return kp(this,e)}}class R6{constructor(e){this.decoders=e}or(e){return kp(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const kp=(i,e)=>new R6({...i.decoders||{[i.prefix]:i},...e.decoders||{[e.prefix]:e}});class $6{constructor(e,t,s,a){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=a,this.encoder=new T6(e,t,s),this.decoder=new N6(e,t,a)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Wa=({name:i,prefix:e,encode:t,decode:s})=>new $6(i,e,t,s),ds=({prefix:i,name:e,alphabet:t})=>{const{encode:s,decode:a}=P6(t,e);return Wa({prefix:i,name:e,encode:s,decode:c=>Vp(a(c))})},F6=(i,e,t,s)=>{const a={};for(let _=0;_<e.length;++_)a[e[_]]=_;let c=i.length;for(;i[c-1]==="=";)--c;const p=new Uint8Array(c*t/8|0);let f=0,y=0,d=0;for(let _=0;_<c;++_){const I=a[i[_]];if(I===void 0)throw new SyntaxError(`Non-${s} character`);y=y<<t|I,f+=t,f>=8&&(f-=8,p[d++]=255&y>>f)}if(f>=t||255&y<<8-f)throw new SyntaxError("Unexpected end of data");return p},U6=(i,e,t)=>{const s=e[e.length-1]==="=",a=(1<<t)-1;let c="",p=0,f=0;for(let y=0;y<i.length;++y)for(f=f<<8|i[y],p+=8;p>t;)p-=t,c+=e[a&f>>p];if(p&&(c+=e[a&f<<t-p]),s)for(;c.length*t&7;)c+="=";return c},Jt=({name:i,prefix:e,bitsPerChar:t,alphabet:s})=>Wa({prefix:e,name:i,encode(a){return U6(a,s,t)},decode(a){return F6(a,s,t,i)}}),j6=Wa({prefix:"\0",name:"identity",encode:i=>A6(i),decode:i=>C6(i)});var L6=Object.freeze({__proto__:null,identity:j6});const M6=Jt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var z6=Object.freeze({__proto__:null,base2:M6});const q6=Jt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var B6=Object.freeze({__proto__:null,base8:q6});const H6=ds({prefix:"9",name:"base10",alphabet:"0123456789"});var K6=Object.freeze({__proto__:null,base10:H6});const V6=Jt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),k6=Jt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var G6=Object.freeze({__proto__:null,base16:V6,base16upper:k6});const W6=Jt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Y6=Jt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),J6=Jt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),X6=Jt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Z6=Jt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Q6=Jt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),e2=Jt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),t2=Jt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),r2=Jt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var i2=Object.freeze({__proto__:null,base32:W6,base32upper:Y6,base32pad:J6,base32padupper:X6,base32hex:Z6,base32hexupper:Q6,base32hexpad:e2,base32hexpadupper:t2,base32z:r2});const n2=ds({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),s2=ds({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var a2=Object.freeze({__proto__:null,base36:n2,base36upper:s2});const o2=ds({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),c2=ds({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var u2=Object.freeze({__proto__:null,base58btc:o2,base58flickr:c2});const h2=Jt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),l2=Jt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),f2=Jt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),p2=Jt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var d2=Object.freeze({__proto__:null,base64:h2,base64pad:l2,base64url:f2,base64urlpad:p2});const Gp=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),g2=Gp.reduce((i,e,t)=>(i[t]=e,i),[]),y2=Gp.reduce((i,e,t)=>(i[e.codePointAt(0)]=t,i),[]);function _2(i){return i.reduce((e,t)=>(e+=g2[t],e),"")}function v2(i){const e=[];for(const t of i){const s=y2[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const m2=Wa({prefix:"ðŸš€",name:"base256emoji",encode:_2,decode:v2});var b2=Object.freeze({__proto__:null,base256emoji:m2}),w2=Wp,xf=128,E2=127,D2=~E2,I2=Math.pow(2,31);function Wp(i,e,t){e=e||[],t=t||0;for(var s=t;i>=I2;)e[t++]=i&255|xf,i/=128;for(;i&D2;)e[t++]=i&255|xf,i>>>=7;return e[t]=i|0,Wp.bytes=t-s+1,e}var S2=cu,x2=128,Of=127;function cu(i,s){var t=0,s=s||0,a=0,c=s,p,f=i.length;do{if(c>=f)throw cu.bytes=0,new RangeError("Could not decode varint");p=i[c++],t+=a<28?(p&Of)<<a:(p&Of)*Math.pow(2,a),a+=7}while(p>=x2);return cu.bytes=c-s,t}var O2=Math.pow(2,7),P2=Math.pow(2,14),C2=Math.pow(2,21),A2=Math.pow(2,28),T2=Math.pow(2,35),N2=Math.pow(2,42),R2=Math.pow(2,49),$2=Math.pow(2,56),F2=Math.pow(2,63),U2=function(i){return i<O2?1:i<P2?2:i<C2?3:i<A2?4:i<T2?5:i<N2?6:i<R2?7:i<$2?8:i<F2?9:10},j2={encode:w2,decode:S2,encodingLength:U2},Yp=j2;const Pf=(i,e,t=0)=>(Yp.encode(i,e,t),e),Cf=i=>Yp.encodingLength(i),uu=(i,e)=>{const t=e.byteLength,s=Cf(i),a=s+Cf(t),c=new Uint8Array(a+t);return Pf(i,c,0),Pf(t,c,s),c.set(e,a),new L2(i,t,e,c)};class L2{constructor(e,t,s,a){this.code=e,this.size=t,this.digest=s,this.bytes=a}}const Jp=({name:i,code:e,encode:t})=>new M2(i,e,t);class M2{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?uu(this.code,t):t.then(s=>uu(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Xp=i=>async e=>new Uint8Array(await crypto.subtle.digest(i,e)),z2=Jp({name:"sha2-256",code:18,encode:Xp("SHA-256")}),q2=Jp({name:"sha2-512",code:19,encode:Xp("SHA-512")});var B2=Object.freeze({__proto__:null,sha256:z2,sha512:q2});const Zp=0,H2="identity",Qp=Vp,K2=i=>uu(Zp,Qp(i)),V2={code:Zp,name:H2,encode:Qp,digest:K2};var k2=Object.freeze({__proto__:null,identity:V2});new TextEncoder,new TextDecoder;const Af={...L6,...z6,...B6,...K6,...G6,...i2,...a2,...u2,...d2,...b2};({...B2,...k2});function ed(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function G2(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?ed(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function td(i,e,t,s){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:t},decoder:{decode:s}}}const Tf=td("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),Rc=td("ascii","a",i=>{let e="a";for(let t=0;t<i.length;t++)e+=String.fromCharCode(i[t]);return e},i=>{i=i.substring(1);const e=G2(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}),W2={utf8:Tf,"utf-8":Tf,hex:Af.base16,latin1:Rc,ascii:Rc,binary:Rc,...Af};function Y2(i,e="utf8"){const t=W2[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?ed(globalThis.Buffer.from(i,"utf-8")):t.decoder.decode(`${t.prefix}${i}`)}const rd="wc",J2=2,Nu="core",Ci=`${rd}@2:${Nu}:`,X2={name:Nu,logger:"error"},Z2={database:":memory:"},Q2="crypto",Nf="client_ed25519_seed",eD=_e.ONE_DAY,tD="keychain",rD="0.3",iD="messages",nD="0.3",sD=_e.SIX_HOURS,aD="publisher",id="irn",oD="error",nd="wss://relay.walletconnect.com",Rf="wss://relay.walletconnect.org",cD="relayer",Ot={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},uD="_subscription",Qn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},hD=_e.ONE_SECOND/2,lD="2.9.0",fD=1e4,pD="0.3",dD="WALLETCONNECT_CLIENT_ID",Qr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},gD="subscription",yD="0.3",_D=_e.FIVE_SECONDS*1e3,vD="pairing",mD="0.3",es={wc_pairingDelete:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:0},res:{ttl:_e.ONE_DAY,prompt:!1,tag:0}}},Zr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},bD="history",wD="0.3",ED="expirer",Ur={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},DD="0.3",$c="verify-api",$f="https://verify.walletconnect.com";class ID{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=tD,this.version=rD,this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,a)=>{this.isInitialized(),this.keychain.set(s,a),await this.persist()},this.get=s=>{this.isInitialized();const a=this.keychain.get(s);if(typeof a>"u"){const{message:c}=ue("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(c)}return a},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=e,this.logger=Qe.generateChildLogger(t,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Pp(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Cp(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class SD{constructor(e,t,s){this.core=e,this.logger=t,this.name=Q2,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),c=Df(a);return Kp(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=_w();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const c=await this.getClientSeed(),p=Df(c),f=Qc();return await m6(f,a,eD,p)},this.generateSharedKey=(a,c,p)=>{this.isInitialized();const f=this.getPrivateKey(a),y=vw(f,c);return this.setSymKey(y,p)},this.setSymKey=async(a,c)=>{this.isInitialized();const p=c||mw(a);return await this.keychain.set(p,a),p},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,c,p)=>{this.isInitialized();const f=xp(p),y=us(c);if(Zl(f)){const D=f.senderPublicKey,O=f.receiverPublicKey;a=await this.generateSharedKey(D,O)}const d=this.getSymKey(a),{type:_,senderPublicKey:I}=f;return ww({type:_,symKey:d,message:y,senderPublicKey:I})},this.decode=async(a,c,p)=>{this.isInitialized();const f=Iw(c,p);if(Zl(f)){const _=f.receiverPublicKey,I=f.senderPublicKey;a=await this.generateSharedKey(_,I)}const y=this.getSymKey(a),d=Ew({symKey:y,encoded:c});return Ma(d)},this.getPayloadType=a=>{const c=Na(a);return fs(c.type)},this.getPayloadSenderPublicKey=a=>{const c=Na(a);return c.senderPublicKey?ur(c.senderPublicKey,cr):void 0},this.core=e,this.logger=Qe.generateChildLogger(t,this.name),this.keychain=s||new ID(this.core,this.logger)}get context(){return Qe.getLoggerContext(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Nf)}catch{e=Qc(),await this.keychain.set(Nf,e)}return Y2(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class xD extends X3{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=iD,this.version=nD,this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,a)=>{this.isInitialized();const c=Sn(a);let p=this.messages.get(s);return typeof p>"u"&&(p={}),typeof p[c]<"u"||(p[c]=a,this.messages.set(s,p),await this.persist()),c},this.get=s=>{this.isInitialized();let a=this.messages.get(s);return typeof a>"u"&&(a={}),a},this.has=(s,a)=>{this.isInitialized();const c=this.get(s),p=Sn(a);return typeof c[p]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Qe.generateChildLogger(e,this.name),this.core=t}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Pp(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Cp(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class OD extends Z3{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new ti.EventEmitter,this.name=aD,this.queue=new Map,this.publishTimeout=_e.toMiliseconds(_e.TEN_SECONDS),this.queueTimeout=_e.toMiliseconds(_e.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,a,c)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:c}});try{const p=(c==null?void 0:c.ttl)||sD,f=eu(c),y=(c==null?void 0:c.prompt)||!1,d=(c==null?void 0:c.tag)||0,_=(c==null?void 0:c.id)||np().toString(),I={topic:s,message:a,opts:{ttl:p,relay:f,prompt:y,tag:d,id:_}},D=setTimeout(()=>this.queue.set(_,I),this.queueTimeout);try{await await Ra(this.rpcPublish(s,a,p,f,y,d,_),this.publishTimeout),clearTimeout(D),this.relayer.events.emit(Ot.publish,I)}catch{this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:c}})}catch(p){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(p),p}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.relayer=e,this.logger=Qe.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return Qe.getLoggerContext(this.logger)}rpcPublish(e,t,s,a,c,p,f){var y,d,_,I;const D={method:Sa(a.protocol).publish,params:{topic:e,message:t,ttl:s,prompt:c,tag:p},id:f};return or((y=D.params)==null?void 0:y.prompt)&&((d=D.params)==null||delete d.prompt),or((_=D.params)==null?void 0:_.tag)&&((I=D.params)==null||delete I.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:D}),this.relayer.request(D)}onPublish(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:s,opts:a}=e;await this.publish(t,s,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(Cn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Ot.connection_stalled);return}this.checkQueue()}),this.relayer.on(Ot.message_ack,e=>{this.onPublish(e.id.toString())})}}class PD{constructor(){this.map=new Map,this.set=(e,t)=>{const s=this.get(e);this.exists(e,t)||this.map.set(e,[...s,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const s=this.get(e);if(!this.exists(e,t))return;const a=s.filter(c=>c!==t);if(!a.length){this.map.delete(e);return}this.map.set(e,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var CD=Object.defineProperty,AD=Object.defineProperties,TD=Object.getOwnPropertyDescriptors,Ff=Object.getOwnPropertySymbols,ND=Object.prototype.hasOwnProperty,RD=Object.prototype.propertyIsEnumerable,Uf=(i,e,t)=>e in i?CD(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ts=(i,e)=>{for(var t in e||(e={}))ND.call(e,t)&&Uf(i,t,e[t]);if(Ff)for(var t of Ff(e))RD.call(e,t)&&Uf(i,t,e[t]);return i},Fc=(i,e)=>AD(i,TD(e));class $D extends t6{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new PD,this.events=new ti.EventEmitter,this.name=gD,this.version=yD,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ci,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}});try{const c=eu(a),p={topic:s,relay:c};this.pending.set(s,p);const f=await this.rpcSubscribe(s,c);return this.onSubscribe(f,p),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}}),f}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(s,a.id,a):await this.unsubscribeByTopic(s,a)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((a,c)=>{const p=new _e.Watch;p.start(this.pendingSubscriptionWatchLabel);const f=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(f),p.stop(this.pendingSubscriptionWatchLabel),a(!0)),p.elapsed(this.pendingSubscriptionWatchLabel)>=_D&&(clearInterval(f),p.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Qe.generateChildLogger(t,this.name),this.clientId=""}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let s=!1;try{s=this.getSubscription(e).topic===t}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const s=this.topicMap.get(e);await Promise.all(s.map(async a=>await this.unsubscribeById(e,a,t)))}async unsubscribeById(e,t,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}});try{const a=eu(s);await this.rpcUnsubscribe(e,t,a);const c=Nt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(e,t){const s={method:Sa(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Ra(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Ot.connection_stalled)}return Sn(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,s={method:Sa(t.protocol).batchSubscribe,params:{topics:e.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Ra(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Ot.connection_stalled)}}rpcUnsubscribe(e,t,s){const a={method:Sa(s.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(e,t){this.setSubscription(e,Fc(ts({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,ts({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,s){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,s),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,ts({},t)),this.topicMap.set(t.topic,e),this.events.emit(Qr.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const s=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(s.topic,e),this.events.emit(Qr.deleted,Fc(ts({},s),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Qr.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Qr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);ei(t)&&this.onBatchSubscribe(t.map((s,a)=>Fc(ts({},e[a]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(Cn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Ot.connect,async()=>{await this.onConnect()}),this.relayer.on(Ot.disconnect,()=>{this.onDisconnect()}),this.events.on(Qr.created,async e=>{const t=Qr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(Qr.deleted,async e=>{const t=Qr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var FD=Object.defineProperty,jf=Object.getOwnPropertySymbols,UD=Object.prototype.hasOwnProperty,jD=Object.prototype.propertyIsEnumerable,Lf=(i,e,t)=>e in i?FD(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,LD=(i,e)=>{for(var t in e||(e={}))UD.call(e,t)&&Lf(i,t,e[t]);if(jf)for(var t of jf(e))jD.call(e,t)&&Lf(i,t,e[t]);return i};class MD extends Q3{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new ti.EventEmitter,this.name=cD,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async t=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(t)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Qe.generateChildLogger(e.logger,this.name):Qe.pino(Qe.getDefaultLoggerOptions({level:e.logger||oD})),this.messages=new xD(this.logger,e.core),this.subscriber=new $D(this,this.logger),this.publisher=new OD(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||nd,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Rf}...`),await this.restartTransport(Rf)}this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},fD)}get context(){return Qe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,t,s){this.isInitialized(),await this.publisher.publish(e,t,s),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}async subscribe(e,t){var s;this.isInitialized();let a=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"";return a||(await Promise.all([new Promise(c=>{this.subscriber.once(Qr.created,p=>{p.topic===e&&c()})}),new Promise(async c=>{a=await this.subscriber.subscribe(e,t),c()})]),a)}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(Ot.transport_closed))}async transportOpen(e){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=e||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(t=>{this.initialized||t(),this.subscriber.once(Qr.resubscribed,()=>{t()})}),await Promise.race([new Promise(async(t,s)=>{await Ra(this.provider.connect(),5e3,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(a=>s(a)).then(()=>t()).finally(()=>this.removeListener(Ot.transport_closed,this.rejectTransportOpen))}),new Promise(t=>this.once(Ot.transport_closed,this.rejectTransportOpen))])])}catch(t){this.logger.error(t);const s=t;if(!this.isConnectionStalled(s.message))throw t;this.events.emit(Ot.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=e||this.relayUrl,this.connected&&await Promise.all([new Promise(t=>{this.provider.once(Qn.disconnect,()=>{t()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ai(new D6(Fw({sdkVersion:lD,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:s}=e;await this.messages.set(t,s)}async shouldIgnoreMessageEvent(e){const{topic:t,message:s}=e;return await this.subscriber.isSubscribed(t)?this.messages.has(t,s):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),yu(e)){if(!e.method.endsWith(uD))return;const t=e.params,{topic:s,message:a,publishedAt:c}=t.data,p={topic:s,message:a,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(LD({type:"event",event:t.id},p)),this.events.emit(t.id,p),await this.acknowledgePayload(e),await this.onMessageEvent(p)}else _u(e)&&this.events.emit(Ot.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Ot.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=vu(e.id,!0);await this.provider.connection.send(t)}registerProviderListeners(){this.provider.on(Qn.payload,e=>this.onProviderPayload(e)),this.provider.on(Qn.connect,()=>{this.events.emit(Ot.connect)}),this.provider.on(Qn.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(Qn.error,e=>{this.logger.error(e),this.events.emit(Ot.error,e)})}registerEventListeners(){this.events.on(Ot.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(Ot.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},_e.toMiliseconds(hD))}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(e=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var zD=Object.defineProperty,Mf=Object.getOwnPropertySymbols,qD=Object.prototype.hasOwnProperty,BD=Object.prototype.propertyIsEnumerable,zf=(i,e,t)=>e in i?zD(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,qf=(i,e)=>{for(var t in e||(e={}))qD.call(e,t)&&zf(i,t,e[t]);if(Mf)for(var t of Mf(e))BD.call(e,t)&&zf(i,t,e[t]);return i};class Ya extends e6{constructor(e,t,s,a=Ci,c=void 0){super(e,t,s,a),this.core=e,this.logger=t,this.name=s,this.map=new Map,this.version=pD,this.cached=[],this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(p=>{this.getKey&&p!==null&&!or(p)?this.map.set(this.getKey(p),p):nE(p)?this.map.set(p.id,p):sE(p)&&this.map.set(p.topic,p)}),this.cached=[],this.initialized=!0)},this.set=async(p,f)=>{this.isInitialized(),this.map.has(p)?await this.update(p,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:p,value:f}),this.map.set(p,f),await this.persist())},this.get=p=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:p}),this.getData(p)),this.getAll=p=>(this.isInitialized(),p?this.values.filter(f=>Object.keys(p).every(y=>S6(f[y],p[y]))):this.values),this.update=async(p,f)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:p,update:f});const y=qf(qf({},this.getData(p)),f);this.map.set(p,y),await this.persist()},this.delete=async(p,f)=>{this.isInitialized(),this.map.has(p)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:p,reason:f}),this.map.delete(p),await this.persist())},this.logger=Qe.generateChildLogger(t,this.name),this.storagePrefix=a,this.getKey=c}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class HD{constructor(e,t){this.core=e,this.logger=t,this.name=vD,this.version=mD,this.events=new du,this.initialized=!1,this.storagePrefix=Ci,this.ignoredPayloadTypes=[Qi],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Qc(),a=await this.core.crypto.setSymKey(s),c=Kr(_e.FIVE_MINUTES),p={protocol:id},f={topic:a,expiry:c,relay:p,active:!1},y=Ww({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:s,relay:p});return await this.pairings.set(a,f),await this.core.relayer.subscribe(a),this.core.expirer.set(a,c),{topic:a,uri:y}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:a,symKey:c,relay:p}=Vw(s.uri);if(this.pairings.keys.includes(a))throw new Error(`Pairing already exists: ${a}`);if(this.core.crypto.hasKeys(a))throw new Error(`Keychain already exists: ${a}`);const f=Kr(_e.FIVE_MINUTES),y={topic:a,relay:p,expiry:f,active:!1};return await this.pairings.set(a,y),await this.core.crypto.setSymKey(c,a),await this.core.relayer.subscribe(a,{relay:p}),this.core.expirer.set(a,f),s.activatePairing&&await this.activate({topic:a}),y},this.activate=async({topic:s})=>{this.isInitialized();const a=Kr(_e.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:a}),this.core.expirer.set(s,a)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:a}=s;if(this.pairings.keys.includes(a)){const c=await this.sendRequest(a,"wc_pairingPing",{}),{done:p,resolve:f,reject:y}=In();this.events.once(qt("pairing_ping",c),({error:d})=>{d?y(d):f()}),await p()}},this.updateExpiry=async({topic:s,expiry:a})=>{this.isInitialized(),await this.pairings.update(s,{expiry:a})},this.updateMetadata=async({topic:s,metadata:a})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:a}=s;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",Nt("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(s,a,c)=>{const p=mu(a,c),f=await this.core.crypto.encode(s,p),y=es[a].req;return this.core.history.set(s,p),this.core.relayer.publish(s,f,y),p.id},this.sendResult=async(s,a,c)=>{const p=vu(s,c),f=await this.core.crypto.encode(a,p),y=await this.core.history.get(a,s),d=es[y.request.method].res;await this.core.relayer.publish(a,f,d),await this.core.history.resolve(p)},this.sendError=async(s,a,c)=>{const p=gu(s,c),f=await this.core.crypto.encode(a,p),y=await this.core.history.get(a,s),d=es[y.request.method]?es[y.request.method].res:es.unregistered_method.res;await this.core.relayer.publish(a,f,d),await this.core.history.resolve(p)},this.deletePairing=async(s,a)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,Nt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),a?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(a=>Oi(a.expiry));await Promise.all(s.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=s=>{const{topic:a,payload:c}=s,p=c.method;if(this.pairings.keys.includes(a))switch(p){case"wc_pairingPing":return this.onPairingPingRequest(a,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,c);default:return this.onUnknownRpcMethodRequest(a,c)}},this.onRelayEventResponse=async s=>{const{topic:a,payload:c}=s,p=(await this.core.history.get(a,c.id)).request.method;if(this.pairings.keys.includes(a))switch(p){case"wc_pairingPing":return this.onPairingPingResponse(a,c);default:return this.onUnknownRpcMethodResponse(p)}},this.onPairingPingRequest=async(s,a)=>{const{id:c}=a;try{this.isValidPing({topic:s}),await this.sendResult(c,s,!0),this.events.emit("pairing_ping",{id:c,topic:s})}catch(p){await this.sendError(c,s,p),this.logger.error(p)}},this.onPairingPingResponse=(s,a)=>{const{id:c}=a;setTimeout(()=>{xi(a)?this.events.emit(qt("pairing_ping",c),{}):di(a)&&this.events.emit(qt("pairing_ping",c),{error:a.error})},500)},this.onPairingDeleteRequest=async(s,a)=>{const{id:c}=a;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit("pairing_delete",{id:c,topic:s})}catch(p){await this.sendError(c,s,p),this.logger.error(p)}},this.onUnknownRpcMethodRequest=async(s,a)=>{const{id:c,method:p}=a;try{if(this.registeredMethods.includes(p))return;const f=Nt("WC_METHOD_UNSUPPORTED",p);await this.sendError(c,s,f),this.logger.error(f)}catch(f){await this.sendError(c,s,f),this.logger.error(f)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(Nt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!_r(s)){const{message:a}=ue("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(a)}if(!iE(s.uri)){const{message:a}=ue("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(a)}},this.isValidPing=async s=>{if(!_r(s)){const{message:c}=ue("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(c)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidDisconnect=async s=>{if(!_r(s)){const{message:c}=ue("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(c)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async s=>{if(!Gt(s,!1)){const{message:a}=ue("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(a)}if(!this.pairings.keys.includes(s)){const{message:a}=ue("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(a)}if(Oi(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:a}=ue("EXPIRED",`pairing topic: ${s}`);throw new Error(a)}},this.core=e,this.logger=Qe.generateChildLogger(t,this.name),this.pairings=new Ya(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Qe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Ot.message,async e=>{const{topic:t,message:s}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const a=await this.core.crypto.decode(t,s);yu(a)?(this.core.history.set(t,a),this.onRelayEventRequest({topic:t,payload:a})):_u(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:t,payload:a}),this.core.history.delete(t,a.id))})}registerExpirerEvents(){this.core.expirer.on(Ur.expired,async e=>{const{topic:t}=Tp(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit("pairing_expire",{topic:t}))})}}class KD extends J3{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new ti.EventEmitter,this.name=bD,this.version=wD,this.cached=[],this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,a,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:a,chainId:c}),this.records.has(a.id))return;const p={id:a.id,topic:s,request:{method:a.method,params:a.params||null},chainId:c,expiry:Kr(_e.THIRTY_DAYS)};this.records.set(p.id,p),this.events.emit(Zr.created,p)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const a=await this.getRecord(s.id);typeof a.response>"u"&&(a.response=di(s)?{error:s.error}:{result:s.result},this.records.set(a.id,a),this.events.emit(Zr.updated,a))},this.get=async(s,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:a}),await this.getRecord(a)),this.delete=(s,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(c=>{if(c.topic===s){if(typeof a<"u"&&c.id!==a)return;this.records.delete(c.id),this.events.emit(Zr.deleted,c)}})},this.exists=async(s,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===s:!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Qe.generateChildLogger(t,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const s={topic:t.topic,request:mu(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(s)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Zr.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Zr.created,e=>{const t=Zr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(Zr.updated,e=>{const t=Zr.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(Zr.deleted,e=>{const t=Zr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.core.heartbeat.on(Cn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{_e.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class VD extends r6{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new ti.EventEmitter,this.name=ED,this.version=DD,this.cached=[],this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const a=this.formatTarget(s);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(s,a)=>{this.isInitialized();const c=this.formatTarget(s),p={target:c,expiry:a};this.expirations.set(c,p),this.checkExpiry(c,p),this.events.emit(Ur.created,{target:c,expiration:p})},this.get=s=>{this.isInitialized();const a=this.formatTarget(s);return this.getExpiration(a)},this.del=s=>{if(this.isInitialized(),this.has(s)){const a=this.formatTarget(s),c=this.getExpiration(a);this.expirations.delete(a),this.events.emit(Ur.deleted,{target:a,expiration:c})}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Qe.generateChildLogger(t,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Uw(e);if(typeof e=="number")return jw(e);const{message:t}=ue("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Ur.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}checkExpiry(e,t){const{expiry:s}=t;_e.toMiliseconds(s)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(Ur.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(Cn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Ur.created,e=>{const t=Ur.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Ur.expired,e=>{const t=Ur.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Ur.deleted,e=>{const t=Ur.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class kD extends i6{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.name=$c,this.initialized=!1,this.init=async s=>{Op()||!Ou()||(this.verifyUrl=(s==null?void 0:s.verifyUrl)||$f,await this.createIframe())},this.register=async s=>{var a;if(this.initialized||await this.init(),!!this.iframe)try{(a=this.iframe.contentWindow)==null||a.postMessage(s.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${s.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async s=>{var a;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${s.attestationId}`);const c=this.startAbortTimer(_e.FIVE_SECONDS),p=await fetch(`${this.verifyUrl}/attestation/${s.attestationId}`,{signal:this.abortController.signal});return clearTimeout(c),p.status===200?(a=await p.json())==null?void 0:a.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((s,a)=>{if(document.getElementById($c))return s();const c=document.createElement("iframe");c.setAttribute("id",$c),c.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),c.style.display="none",c.addEventListener("load",()=>{this.initialized=!0,s()}),c.addEventListener("error",p=>{a(p)}),document.body.append(c),this.iframe=c}),new Promise(s=>{setTimeout(()=>s("iframe load timeout"),_e.toMiliseconds(_e.ONE_SECOND/2))})])}catch(s){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(s)}},this.logger=Qe.generateChildLogger(t,this.name),this.verifyUrl=$f,this.abortController=new AbortController,this.isDevEnv=xu()&&{}.IS_VITEST}get context(){return Qe.getLoggerContext(this.logger)}startAbortTimer(e){return setTimeout(()=>this.abortController.abort(),_e.toMiliseconds(e))}}var GD=Object.defineProperty,Bf=Object.getOwnPropertySymbols,WD=Object.prototype.hasOwnProperty,YD=Object.prototype.propertyIsEnumerable,Hf=(i,e,t)=>e in i?GD(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Kf=(i,e)=>{for(var t in e||(e={}))WD.call(e,t)&&Hf(i,t,e[t]);if(Bf)for(var t of Bf(e))YD.call(e,t)&&Hf(i,t,e[t]);return i};class Ru extends Y3{constructor(e){super(e),this.protocol=rd,this.version=J2,this.name=Nu,this.events=new ti.EventEmitter,this.initialized=!1,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||nd;const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||X2.logger}));this.logger=Qe.generateChildLogger(t,this.name),this.heartbeat=new Cn.HeartBeat,this.crypto=new SD(this,this.logger,e==null?void 0:e.keychain),this.history=new KD(this,this.logger),this.expirer=new VD(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new QE(Kf(Kf({},Z2),e==null?void 0:e.storageOptions)),this.relayer=new MD({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new HD(this,this.logger),this.verify=new kD(this.projectId||"",this.logger)}static async init(e){const t=new Ru(e);await t.initialize();const s=await t.crypto.getClientId();return await t.storage.setItem(dD,s),t}get context(){return Qe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const JD=Ru,sd="wc",ad=2,od="client",$u=`${sd}@${ad}:${od}:`,Uc={name:od,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},XD="WALLETCONNECT_DEEPLINK_CHOICE",ZD="proposal",cd="Proposal expired",QD="session",Ea=_e.SEVEN_DAYS,e5="engine",rs={wc_sessionPropose:{req:{ttl:_e.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1104},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1106},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:_e.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:_e.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1112},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1115}}},jc={min:_e.FIVE_MINUTES,max:_e.SEVEN_DAYS},t5="request",r5=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var i5=Object.defineProperty,n5=Object.defineProperties,s5=Object.getOwnPropertyDescriptors,Vf=Object.getOwnPropertySymbols,a5=Object.prototype.hasOwnProperty,o5=Object.prototype.propertyIsEnumerable,kf=(i,e,t)=>e in i?i5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Fr=(i,e)=>{for(var t in e||(e={}))a5.call(e,t)&&kf(i,t,e[t]);if(Vf)for(var t of Vf(e))o5.call(e,t)&&kf(i,t,e[t]);return i},Lc=(i,e)=>n5(i,s5(e));class c5 extends s6{constructor(e){super(e),this.name=e5,this.events=new du,this.initialized=!1,this.ignoredPayloadTypes=[Qi],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(rs)}),this.initialized=!0)},this.connect=async t=>{this.isInitialized();const s=Lc(Fr({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:a,requiredNamespaces:c,optionalNamespaces:p,sessionProperties:f,relays:y}=s;let d=a,_,I=!1;if(d&&(I=this.client.core.pairing.pairings.get(d).active),!d||!I){const{topic:j,uri:x}=await this.client.core.pairing.create();d=j,_=x}const D=await this.client.core.crypto.generateKeyPair(),O=Fr({requiredNamespaces:c,optionalNamespaces:p,relays:y??[{protocol:id}],proposer:{publicKey:D,metadata:this.client.metadata}},f&&{sessionProperties:f}),{reject:A,resolve:B,done:G}=In(_e.FIVE_MINUTES,cd);if(this.events.once(qt("session_connect"),async({error:j,session:x})=>{if(j)A(j);else if(x){x.self.publicKey=D;const C=Lc(Fr({},x),{requiredNamespaces:x.requiredNamespaces,optionalNamespaces:x.optionalNamespaces});await this.client.session.set(x.topic,C),await this.setExpiry(x.topic,x.expiry),d&&await this.client.core.pairing.updateMetadata({topic:d,metadata:x.peer.metadata}),B(C)}}),!d){const{message:j}=ue("NO_MATCHING_KEY",`connect() pairing topic: ${d}`);throw new Error(j)}const ie=await this.sendRequest(d,"wc_sessionPropose",O),N=Kr(_e.FIVE_MINUTES);return await this.setProposal(ie,Fr({id:ie,expiry:N},O)),{uri:_,approval:G}},this.pair=async t=>(this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{this.isInitialized(),await this.isValidApprove(t);const{id:s,relayProtocol:a,namespaces:c,sessionProperties:p}=t,f=this.client.proposal.get(s);let{pairingTopic:y,proposer:d,requiredNamespaces:_,optionalNamespaces:I}=f;y=y||"",xn(_)||(_=Zw(c,"approve()"));const D=await this.client.core.crypto.generateKeyPair(),O=d.publicKey,A=await this.client.core.crypto.generateSharedKey(D,O);y&&s&&(await this.client.core.pairing.updateMetadata({topic:y,metadata:d.metadata}),await this.sendResult(s,y,{relay:{protocol:a??"irn"},responderPublicKey:D}),await this.client.proposal.delete(s,Nt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:y}));const B=Fr({relay:{protocol:a??"irn"},namespaces:c,requiredNamespaces:_,optionalNamespaces:I,pairingTopic:y,controller:{publicKey:D,metadata:this.client.metadata},expiry:Kr(Ea)},p&&{sessionProperties:p});await this.client.core.relayer.subscribe(A),await this.sendRequest(A,"wc_sessionSettle",B);const G=Lc(Fr({},B),{topic:A,pairingTopic:y,acknowledged:!1,self:B.controller,peer:{publicKey:d.publicKey,metadata:d.metadata},controller:D});return await this.client.session.set(A,G),await this.setExpiry(A,Kr(Ea)),{topic:A,acknowledged:()=>new Promise(ie=>setTimeout(()=>ie(this.client.session.get(A)),500))}},this.reject=async t=>{this.isInitialized(),await this.isValidReject(t);const{id:s,reason:a}=t,{pairingTopic:c}=this.client.proposal.get(s);c&&(await this.sendError(s,c,a),await this.client.proposal.delete(s,Nt("USER_DISCONNECTED")))},this.update=async t=>{this.isInitialized(),await this.isValidUpdate(t);const{topic:s,namespaces:a}=t,c=await this.sendRequest(s,"wc_sessionUpdate",{namespaces:a}),{done:p,resolve:f,reject:y}=In();return this.events.once(qt("session_update",c),({error:d})=>{d?y(d):f()}),await this.client.session.update(s,{namespaces:a}),{acknowledged:p}},this.extend=async t=>{this.isInitialized(),await this.isValidExtend(t);const{topic:s}=t,a=await this.sendRequest(s,"wc_sessionExtend",{}),{done:c,resolve:p,reject:f}=In();return this.events.once(qt("session_extend",a),({error:y})=>{y?f(y):p()}),await this.setExpiry(s,Kr(Ea)),{acknowledged:c}},this.request=async t=>{this.isInitialized(),await this.isValidRequest(t);const{chainId:s,request:a,topic:c,expiry:p}=t,f=await this.sendRequest(c,"wc_sessionRequest",{request:a,chainId:s},p),{done:y,resolve:d,reject:_}=In(p);this.events.once(qt("session_request",f),({error:D,result:O})=>{D?_(D):d(O)}),this.client.events.emit("session_request_sent",{topic:c,request:a,chainId:s,id:f});const I=await this.client.core.storage.getItem(XD);return Lw({id:f,topic:c,wcDeepLink:I}),await y()},this.respond=async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:s,response:a}=t,{id:c}=a;xi(a)?await this.sendResult(c,s,a.result):di(a)&&await this.sendError(c,s,a.error),this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0})},this.ping=async t=>{this.isInitialized(),await this.isValidPing(t);const{topic:s}=t;if(this.client.session.keys.includes(s)){const a=await this.sendRequest(s,"wc_sessionPing",{}),{done:c,resolve:p,reject:f}=In();this.events.once(qt("session_ping",a),({error:y})=>{y?f(y):p()}),await c()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async t=>{this.isInitialized(),await this.isValidEmit(t);const{topic:s,event:a,chainId:c}=t;await this.sendRequest(s,"wc_sessionEvent",{event:a,chainId:c})},this.disconnect=async t=>{this.isInitialized(),await this.isValidDisconnect(t);const{topic:s}=t;if(this.client.session.keys.includes(s)){const a=np().toString();let c;const p=f=>{(f==null?void 0:f.id.toString())===a&&(this.client.core.relayer.events.removeListener(Ot.message_ack,p),c())};await Promise.all([new Promise(f=>{c=f,this.client.core.relayer.on(Ot.message_ack,p)}),this.sendRequest(s,"wc_sessionDelete",Nt("USER_DISCONNECTED"),void 0,a)]),await this.deleteSession(s)}else await this.client.core.pairing.disconnect({topic:s})},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(s=>tE(s,t))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const s=this.client.core.pairing.pairings.get(t.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(c=>{var p,f;return((p=c.peerMetadata)==null?void 0:p.url)&&((f=c.peerMetadata)==null?void 0:f.url)===t.peer.metadata.url&&c.topic&&c.topic!==s.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(t,s)=>{const{self:a}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),this.client.session.delete(t,Nt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(t)&&await this.client.core.crypto.deleteSymKey(t),s||this.client.core.expirer.del(t)},this.deleteProposal=async(t,s)=>{await Promise.all([this.client.proposal.delete(t,Nt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,s,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,s),a?Promise.resolve():this.client.core.expirer.del(t)])},this.setExpiry=async(t,s)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:s}),this.client.core.expirer.set(t,s)},this.setProposal=async(t,s)=>{await this.client.proposal.set(t,s),this.client.core.expirer.set(t,s.expiry)},this.setPendingSessionRequest=async t=>{const s=rs.wc_sessionRequest.req.ttl,{id:a,topic:c,params:p}=t;await this.client.pendingRequest.set(a,{id:a,topic:c,params:p}),s&&this.client.core.expirer.set(a,Kr(s))},this.sendRequest=async(t,s,a,c,p)=>{const f=mu(s,a);if(Ou()&&r5.includes(s)){const _=Sn(JSON.stringify(f));await this.client.core.verify.register({attestationId:_})}const y=await this.client.core.crypto.encode(t,f),d=rs[s].req;return c&&(d.ttl=c),p&&(d.id=p),this.client.core.history.set(t,f),this.client.core.relayer.publish(t,y,d),f.id},this.sendResult=async(t,s,a)=>{const c=vu(t,a),p=await this.client.core.crypto.encode(s,c),f=await this.client.core.history.get(s,t),y=rs[f.request.method].res;this.client.core.relayer.publish(s,p,y),await this.client.core.history.resolve(c)},this.sendError=async(t,s,a)=>{const c=gu(t,a),p=await this.client.core.crypto.encode(s,c),f=await this.client.core.history.get(s,t),y=rs[f.request.method].res;this.client.core.relayer.publish(s,p,y),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const t=[],s=[];this.client.session.getAll().forEach(a=>{Oi(a.expiry)&&t.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{Oi(a.expiry)&&s.push(a.id)}),await Promise.all([...t.map(a=>this.deleteSession(a)),...s.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=t=>{const{topic:s,payload:a}=t,c=a.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(s,a);case"wc_sessionSettle":return this.onSessionSettleRequest(s,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,a);case"wc_sessionExtend":return this.onSessionExtendRequest(s,a);case"wc_sessionPing":return this.onSessionPingRequest(s,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,a);case"wc_sessionRequest":return this.onSessionRequest(s,a);case"wc_sessionEvent":return this.onSessionEventRequest(s,a);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async t=>{const{topic:s,payload:a}=t,c=(await this.client.core.history.get(s,a.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(s,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,a);case"wc_sessionExtend":return this.onSessionExtendResponse(s,a);case"wc_sessionPing":return this.onSessionPingResponse(s,a);case"wc_sessionRequest":return this.onSessionRequestResponse(s,a);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:s}=t,{message:a}=ue("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(t,s)=>{const{params:a,id:c}=s;try{this.isValidConnect(Fr({},s.params));const p=Kr(_e.FIVE_MINUTES),f=Fr({id:c,pairingTopic:t,expiry:p},a);await this.setProposal(c,f);const y=Sn(JSON.stringify(s)),d=await this.getVerifyContext(y,f.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:f,verifyContext:d})}catch(p){await this.sendError(c,t,p),this.client.logger.error(p)}},this.onSessionProposeResponse=async(t,s)=>{const{id:a}=s;if(xi(s)){const{result:c}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const p=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:p});const f=p.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});const y=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:y});const d=await this.client.core.crypto.generateSharedKey(f,y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:d});const _=await this.client.core.relayer.subscribe(d);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:_}),await this.client.core.pairing.activate({topic:t})}else di(s)&&(await this.client.proposal.delete(a,Nt("USER_DISCONNECTED")),this.events.emit(qt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(t,s)=>{const{id:a,params:c}=s;try{this.isValidSessionSettleRequest(c);const{relay:p,controller:f,expiry:y,namespaces:d,requiredNamespaces:_,optionalNamespaces:I,sessionProperties:D,pairingTopic:O}=s.params,A=Fr({topic:t,relay:p,expiry:y,namespaces:d,acknowledged:!0,pairingTopic:O,requiredNamespaces:_,optionalNamespaces:I,controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},D&&{sessionProperties:D});await this.sendResult(s.id,t,!0),this.events.emit(qt("session_connect"),{session:A}),this.cleanupDuplicatePairings(A)}catch(p){await this.sendError(a,t,p),this.client.logger.error(p)}},this.onSessionSettleResponse=async(t,s)=>{const{id:a}=s;xi(s)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(qt("session_approve",a),{})):di(s)&&(await this.client.session.delete(t,Nt("USER_DISCONNECTED")),this.events.emit(qt("session_approve",a),{error:s.error}))},this.onSessionUpdateRequest=async(t,s)=>{const{params:a,id:c}=s;try{this.isValidUpdate(Fr({topic:t},a)),await this.client.session.update(t,{namespaces:a.namespaces}),await this.sendResult(c,t,!0),this.client.events.emit("session_update",{id:c,topic:t,params:a})}catch(p){await this.sendError(c,t,p),this.client.logger.error(p)}},this.onSessionUpdateResponse=(t,s)=>{const{id:a}=s;xi(s)?this.events.emit(qt("session_update",a),{}):di(s)&&this.events.emit(qt("session_update",a),{error:s.error})},this.onSessionExtendRequest=async(t,s)=>{const{id:a}=s;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Kr(Ea)),await this.sendResult(a,t,!0),this.client.events.emit("session_extend",{id:a,topic:t})}catch(c){await this.sendError(a,t,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(t,s)=>{const{id:a}=s;xi(s)?this.events.emit(qt("session_extend",a),{}):di(s)&&this.events.emit(qt("session_extend",a),{error:s.error})},this.onSessionPingRequest=async(t,s)=>{const{id:a}=s;try{this.isValidPing({topic:t}),await this.sendResult(a,t,!0),this.client.events.emit("session_ping",{id:a,topic:t})}catch(c){await this.sendError(a,t,c),this.client.logger.error(c)}},this.onSessionPingResponse=(t,s)=>{const{id:a}=s;setTimeout(()=>{xi(s)?this.events.emit(qt("session_ping",a),{}):di(s)&&this.events.emit(qt("session_ping",a),{error:s.error})},500)},this.onSessionDeleteRequest=async(t,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:t,reason:s.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(Ot.publish,async()=>{c(await this.deleteSession(t))})}),this.sendResult(a,t,!0)]),this.client.events.emit("session_delete",{id:a,topic:t})}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(t,s)=>{const{id:a,params:c}=s;try{this.isValidRequest(Fr({topic:t},c)),await this.setPendingSessionRequest({id:a,topic:t,params:c});const p=Sn(JSON.stringify(s)),f=this.client.session.get(t),y=await this.getVerifyContext(p,f.peer.metadata);this.client.events.emit("session_request",{id:a,topic:t,params:c,verifyContext:y})}catch(p){await this.sendError(a,t,p),this.client.logger.error(p)}},this.onSessionRequestResponse=(t,s)=>{const{id:a}=s;xi(s)?this.events.emit(qt("session_request",a),{result:s.result}):di(s)&&this.events.emit(qt("session_request",a),{error:s.error})},this.onSessionEventRequest=async(t,s)=>{const{id:a,params:c}=s;try{this.isValidEmit(Fr({topic:t},c)),this.client.events.emit("session_event",{id:a,topic:t,params:c})}catch(p){await this.sendError(a,t,p),this.client.logger.error(p)}},this.isValidConnect=async t=>{if(!_r(t)){const{message:y}=ue("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(y)}const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:c,sessionProperties:p,relays:f}=t;if(or(s)||await this.isValidPairingTopic(s),!pE(f,!0)){const{message:y}=ue("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(y)}!or(a)&&xn(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!or(c)&&xn(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),or(p)||this.validateSessionProps(p,"sessionProperties")},this.validateNamespaces=(t,s)=>{const a=fE(t,"connect()",s);if(a)throw new Error(a.message)},this.isValidApprove=async t=>{if(!_r(t))throw new Error(ue("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:s,namespaces:a,relayProtocol:c,sessionProperties:p}=t;await this.isValidProposalId(s);const f=this.client.proposal.get(s),y=Oa(a,"approve()");if(y)throw new Error(y.message);const d=of(f.requiredNamespaces,a,"approve()");if(d)throw new Error(d.message);if(!Gt(c,!0)){const{message:_}=ue("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(_)}or(p)||this.validateSessionProps(p,"sessionProperties")},this.isValidReject=async t=>{if(!_r(t)){const{message:c}=ue("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(c)}const{id:s,reason:a}=t;if(await this.isValidProposalId(s),!gE(a)){const{message:c}=ue("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(c)}},this.isValidSessionSettleRequest=t=>{if(!_r(t)){const{message:d}=ue("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(d)}const{relay:s,controller:a,namespaces:c,expiry:p}=t;if(!Rp(s)){const{message:d}=ue("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(d)}const f=aE(a,"onSessionSettleRequest()");if(f)throw new Error(f.message);const y=Oa(c,"onSessionSettleRequest()");if(y)throw new Error(y.message);if(Oi(p)){const{message:d}=ue("EXPIRED","onSessionSettleRequest()");throw new Error(d)}},this.isValidUpdate=async t=>{if(!_r(t)){const{message:y}=ue("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(y)}const{topic:s,namespaces:a}=t;await this.isValidSessionTopic(s);const c=this.client.session.get(s),p=Oa(a,"update()");if(p)throw new Error(p.message);const f=of(c.requiredNamespaces,a,"update()");if(f)throw new Error(f.message)},this.isValidExtend=async t=>{if(!_r(t)){const{message:a}=ue("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(a)}const{topic:s}=t;await this.isValidSessionTopic(s)},this.isValidRequest=async t=>{if(!_r(t)){const{message:y}=ue("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(y)}const{topic:s,request:a,chainId:c,expiry:p}=t;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!af(f,c)){const{message:y}=ue("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(y)}if(!yE(a)){const{message:y}=ue("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(y)}if(!mE(f,c,a.method)){const{message:y}=ue("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(y)}if(p&&!DE(p,jc)){const{message:y}=ue("MISSING_OR_INVALID",`request() expiry: ${p}. Expiry must be a number (in seconds) between ${jc.min} and ${jc.max}`);throw new Error(y)}},this.isValidRespond=async t=>{if(!_r(t)){const{message:c}=ue("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(c)}const{topic:s,response:a}=t;if(await this.isValidSessionTopic(s),!_E(a)){const{message:c}=ue("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(c)}},this.isValidPing=async t=>{if(!_r(t)){const{message:a}=ue("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(a)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async t=>{if(!_r(t)){const{message:f}=ue("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(f)}const{topic:s,event:a,chainId:c}=t;await this.isValidSessionTopic(s);const{namespaces:p}=this.client.session.get(s);if(!af(p,c)){const{message:f}=ue("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(f)}if(!vE(a)){const{message:f}=ue("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(f)}if(!bE(p,c,a.name)){const{message:f}=ue("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(f)}},this.isValidDisconnect=async t=>{if(!_r(t)){const{message:a}=ue("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(a)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(t,s)=>{const a={verified:{verifyUrl:s.verifyUrl||"",validation:"UNKNOWN",origin:s.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:t,verifyUrl:s.verifyUrl});c&&(a.verified.origin=c,a.verified.validation=c===s.url?"VALID":"INVALID")}catch(c){this.client.logger.error(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(t,s)=>{Object.values(t).forEach(a=>{if(!Gt(a,!1)){const{message:c}=ue("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(c)}})}}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(Ot.message,async e=>{const{topic:t,message:s}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const a=await this.client.core.crypto.decode(t,s);yu(a)?(this.client.core.history.set(t,a),this.onRelayEventRequest({topic:t,payload:a})):_u(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:t,payload:a}),this.client.core.history.delete(t,a.id)):this.onRelayEventUnknownPayload({topic:t,payload:a})})}registerExpirerEvents(){this.client.core.expirer.on(Ur.expired,async e=>{const{topic:t,id:s}=Tp(e.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ue("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession(t,!0),this.client.events.emit("session_expire",{topic:t})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}isValidPairingTopic(e){if(!Gt(e,!1)){const{message:t}=ue("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=ue("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(Oi(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=ue("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Gt(e,!1)){const{message:t}=ue("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){const{message:t}=ue("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(Oi(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:t}=ue("EXPIRED",`session topic: ${e}`);throw new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Gt(e,!1)){const{message:t}=ue("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=ue("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!dE(e)){const{message:t}=ue("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=ue("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(Oi(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:t}=ue("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class u5 extends Ya{constructor(e,t){super(e,t,ZD,$u),this.core=e,this.logger=t}}class h5 extends Ya{constructor(e,t){super(e,t,QD,$u),this.core=e,this.logger=t}}class l5 extends Ya{constructor(e,t){super(e,t,t5,$u,s=>s.id),this.core=e,this.logger=t}}let f5=class ud extends n6{constructor(e){super(e),this.protocol=sd,this.version=ad,this.name=Uc.name,this.events=new ti.EventEmitter,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(a){throw this.logger.error(a.message),a}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(a){throw this.logger.error(a.message),a}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(a){throw this.logger.error(a.message),a}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(a){throw this.logger.error(a.message),a}},this.update=async s=>{try{return await this.engine.update(s)}catch(a){throw this.logger.error(a.message),a}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(a){throw this.logger.error(a.message),a}},this.request=async s=>{try{return await this.engine.request(s)}catch(a){throw this.logger.error(a.message),a}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(a){throw this.logger.error(a.message),a}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(a){throw this.logger.error(a.message),a}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(a){throw this.logger.error(a.message),a}},this.find=s=>{try{return this.engine.find(s)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(e==null?void 0:e.name)||Uc.name,this.metadata=(e==null?void 0:e.metadata)||Tw();const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||Uc.logger}));this.core=(e==null?void 0:e.core)||new JD(e),this.logger=Qe.generateChildLogger(t,this.name),this.session=new h5(this.core,this.logger),this.proposal=new u5(this.core,this.logger),this.pendingRequest=new l5(this.core,this.logger),this.engine=new c5(this)}static async init(e){const t=new ud(e);return await t.initialize(),t}get context(){return Qe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};const Gf="error",p5="wss://relay.walletconnect.com",d5="wc",g5="universal_provider",Wf=`${d5}@2:${g5}:`,y5="https://rpc.walletconnect.com/v1",Ni={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var is=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},hu={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(i,e){(function(){var t,s="4.17.21",a=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",p="Expected a function",f="Invalid `variable` option passed into `_.template`",y="__lodash_hash_undefined__",d=500,_="__lodash_placeholder__",I=1,D=2,O=4,A=1,B=2,G=1,ie=2,N=4,j=8,x=16,C=32,w=64,u=128,b=256,K=512,k=30,ae="...",ce=800,ge=16,$=1,q=2,le=3,te=1/0,W=9007199254740991,ee=17976931348623157e292,Y=0/0,re=4294967295,xe=re-1,ne=re>>>1,be=[["ary",u],["bind",G],["bindKey",ie],["curry",j],["curryRight",x],["flip",K],["partial",C],["partialRight",w],["rearg",b]],he="[object Arguments]",ve="[object Array]",z="[object AsyncFunction]",M="[object Boolean]",R="[object Date]",l="[object DOMException]",P="[object Error]",se="[object Function]",fe="[object GeneratorFunction]",Ie="[object Map]",Be="[object Number]",Ve="[object Null]",je="[object Object]",pt="[object Promise]",dt="[object Proxy]",Me="[object RegExp]",Se="[object Set]",Re="[object String]",$e="[object Symbol]",ze="[object Undefined]",Pe="[object WeakMap]",Fe="[object WeakSet]",De="[object ArrayBuffer]",Ce="[object DataView]",He="[object Float32Array]",Oe="[object Float64Array]",ke="[object Int8Array]",We="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Je="[object Uint8ClampedArray]",er="[object Uint16Array]",hr="[object Uint32Array]",Vr=/\b__p \+= '';/g,tr=/\b(__p \+=) '' \+/g,ri=/(__e\(.*?\)|\b__t\)) \+\n'';/g,gi=/&(?:amp|lt|gt|quot|#39);/g,Ri=/[&<>"']/g,bt=RegExp(gi.source),gt=RegExp(Ri.source),wt=/<%-([\s\S]+?)%>/g,Et=/<%([\s\S]+?)%>/g,vt=/<%=([\s\S]+?)%>/g,yt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$t=/^\w*$/,Ft=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Dt=/[\\^$.*+?()[\]{}|]/g,Ut=RegExp(Dt.source),It=/^\s+/,Pt=/\s/,St=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ht=/\{\n\/\* \[wrapped with (.+)\] \*/,jt=/,? & /,Lt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ja=/[()=,{}\[\]\/\s]/,Xa=/\\(\\)?/g,Za=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,xr=/\w*$/,Qa=/^[-+]0x[0-9a-f]+$/i,eo=/^0b[01]+$/i,to=/^\[object .+?Constructor\]$/,ro=/^0o[0-7]+$/i,io=/^(?:0|[1-9]\d*)$/,ii=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,rn=/($^)/,no=/['\n\r\u2028\u2029\\]/g,nn="\\ud800-\\udfff",so="\\u0300-\\u036f",ao="\\ufe20-\\ufe2f",sn="\\u20d0-\\u20ff",gs=so+ao+sn,ys="\\u2700-\\u27bf",Lr="a-z\\xdf-\\xf6\\xf8-\\xff",oo="\\xac\\xb1\\xd7\\xf7",co="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",uo="\\u2000-\\u206f",ho=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",_s="A-Z\\xc0-\\xd6\\xd8-\\xde",vs="\\ufe0e\\ufe0f",$i=oo+co+uo+ho,An="['â€™]",Fi="["+nn+"]",Tn="["+$i+"]",Ui="["+gs+"]",ms="\\d+",lo="["+ys+"]",bs="["+Lr+"]",ws="[^"+nn+$i+ms+ys+Lr+_s+"]",an="\\ud83c[\\udffb-\\udfff]",fo="(?:"+Ui+"|"+an+")",Es="[^"+nn+"]",on="(?:\\ud83c[\\udde6-\\uddff]){2}",yi="[\\ud800-\\udbff][\\udc00-\\udfff]",mr="["+_s+"]",Ds="\\u200d",Is="(?:"+bs+"|"+ws+")",kr="(?:"+mr+"|"+ws+")",Ss="(?:"+An+"(?:d|ll|m|re|s|t|ve))?",xs="(?:"+An+"(?:D|LL|M|RE|S|T|VE))?",Os=fo+"?",Ps="["+vs+"]?",po="(?:"+Ds+"(?:"+[Es,on,yi].join("|")+")"+Ps+Os+")*",ni="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Cs="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",As=Ps+Os+po,cn="(?:"+[lo,on,yi].join("|")+")"+As,go="(?:"+[Es+Ui+"?",Ui,on,yi,Fi].join("|")+")",Nn=RegExp(An,"g"),yo=RegExp(Ui,"g"),un=RegExp(an+"(?="+an+")|"+go+As,"g"),Ts=RegExp([mr+"?"+bs+"+"+Ss+"(?="+[Tn,mr,"$"].join("|")+")",kr+"+"+xs+"(?="+[Tn,mr+Is,"$"].join("|")+")",mr+"?"+Is+"+"+Ss,mr+"+"+xs,Cs,ni,ms,cn].join("|"),"g"),Ns=RegExp("["+Ds+nn+gs+vs+"]"),ji=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Rs=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],_o=-1,at={};at[He]=at[Oe]=at[ke]=at[We]=at[et]=at[tt]=at[Je]=at[er]=at[hr]=!0,at[he]=at[ve]=at[De]=at[M]=at[Ce]=at[R]=at[P]=at[se]=at[Ie]=at[Be]=at[je]=at[Me]=at[Se]=at[Re]=at[Pe]=!1;var st={};st[he]=st[ve]=st[De]=st[Ce]=st[M]=st[R]=st[He]=st[Oe]=st[ke]=st[We]=st[et]=st[Ie]=st[Be]=st[je]=st[Me]=st[Se]=st[Re]=st[$e]=st[tt]=st[Je]=st[er]=st[hr]=!0,st[P]=st[se]=st[Pe]=!1;var E={Ã€:"A",Ã:"A",Ã‚:"A",Ãƒ:"A",Ã„:"A",Ã…:"A",Ã :"a",Ã¡:"a",Ã¢:"a",Ã£:"a",Ã¤:"a",Ã¥:"a",Ã‡:"C",Ã§:"c",Ã:"D",Ã°:"d",Ãˆ:"E",Ã‰:"E",ÃŠ:"E",Ã‹:"E",Ã¨:"e",Ã©:"e",Ãª:"e",Ã«:"e",ÃŒ:"I",Ã:"I",ÃŽ:"I",Ã:"I",Ã¬:"i",Ã­:"i",Ã®:"i",Ã¯:"i",Ã‘:"N",Ã±:"n",Ã’:"O",Ã“:"O",Ã”:"O",Ã•:"O",Ã–:"O",Ã˜:"O",Ã²:"o",Ã³:"o",Ã´:"o",Ãµ:"o",Ã¶:"o",Ã¸:"o",Ã™:"U",Ãš:"U",Ã›:"U",Ãœ:"U",Ã¹:"u",Ãº:"u",Ã»:"u",Ã¼:"u",Ã:"Y",Ã½:"y",Ã¿:"y",Ã†:"Ae",Ã¦:"ae",Ãž:"Th",Ã¾:"th",ÃŸ:"ss",Ä€:"A",Ä‚:"A",Ä„:"A",Ä:"a",Äƒ:"a",Ä…:"a",Ä†:"C",Äˆ:"C",ÄŠ:"C",ÄŒ:"C",Ä‡:"c",Ä‰:"c",Ä‹:"c",Ä:"c",ÄŽ:"D",Ä:"D",Ä:"d",Ä‘:"d",Ä’:"E",Ä”:"E",Ä–:"E",Ä˜:"E",Äš:"E",Ä“:"e",Ä•:"e",Ä—:"e",Ä™:"e",Ä›:"e",Äœ:"G",Äž:"G",Ä :"G",Ä¢:"G",Ä:"g",ÄŸ:"g",Ä¡:"g",Ä£:"g",Ä¤:"H",Ä¦:"H",Ä¥:"h",Ä§:"h",Ä¨:"I",Äª:"I",Ä¬:"I",Ä®:"I",Ä°:"I",Ä©:"i",Ä«:"i",Ä­:"i",Ä¯:"i",Ä±:"i",Ä´:"J",Äµ:"j",Ä¶:"K",Ä·:"k",Ä¸:"k",Ä¹:"L",Ä»:"L",Ä½:"L",Ä¿:"L",Å:"L",Äº:"l",Ä¼:"l",Ä¾:"l",Å€:"l",Å‚:"l",Åƒ:"N",Å…:"N",Å‡:"N",ÅŠ:"N",Å„:"n",Å†:"n",Åˆ:"n",Å‹:"n",ÅŒ:"O",ÅŽ:"O",Å:"O",Å:"o",Å:"o",Å‘:"o",Å”:"R",Å–:"R",Å˜:"R",Å•:"r",Å—:"r",Å™:"r",Åš:"S",Åœ:"S",Åž:"S",Å :"S",Å›:"s",Å:"s",ÅŸ:"s",Å¡:"s",Å¢:"T",Å¤:"T",Å¦:"T",Å£:"t",Å¥:"t",Å§:"t",Å¨:"U",Åª:"U",Å¬:"U",Å®:"U",Å°:"U",Å²:"U",Å©:"u",Å«:"u",Å­:"u",Å¯:"u",Å±:"u",Å³:"u",Å´:"W",Åµ:"w",Å¶:"Y",Å·:"y",Å¸:"Y",Å¹:"Z",Å»:"Z",Å½:"Z",Åº:"z",Å¼:"z",Å¾:"z",Ä²:"IJ",Ä³:"ij",Å’:"Oe",Å“:"oe",Å‰:"'n",Å¿:"s"},F={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Z={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ot=parseFloat,Te=parseInt,lt=typeof is=="object"&&is&&is.Object===Object&&is,Mt=typeof self=="object"&&self&&self.Object===Object&&self,Xe=lt||Mt||Function("return this")(),ct=e&&!e.nodeType&&e,Ct=ct&&!0&&i&&!i.nodeType&&i,lr=Ct&&Ct.exports===ct,zt=lr&&lt.process,ft=function(){try{var U=Ct&&Ct.require&&Ct.require("util").types;return U||zt&&zt.binding&&zt.binding("util")}catch{}}(),rr=ft&&ft.isArrayBuffer,Mr=ft&&ft.isDate,Or=ft&&ft.isMap,Gr=ft&&ft.isRegExp,Rn=ft&&ft.isSet,Li=ft&&ft.isTypedArray;function Kt(U,V,H){switch(H.length){case 0:return U.call(V);case 1:return U.call(V,H[0]);case 2:return U.call(V,H[0],H[1]);case 3:return U.call(V,H[0],H[1],H[2])}return U.apply(V,H)}function fd(U,V,H,de){for(var Ae=-1,rt=U==null?0:U.length;++Ae<rt;){var Bt=U[Ae];V(de,Bt,H(Bt),U)}return de}function Pr(U,V){for(var H=-1,de=U==null?0:U.length;++H<de&&V(U[H],H,U)!==!1;);return U}function pd(U,V){for(var H=U==null?0:U.length;H--&&V(U[H],H,U)!==!1;);return U}function ju(U,V){for(var H=-1,de=U==null?0:U.length;++H<de;)if(!V(U[H],H,U))return!1;return!0}function _i(U,V){for(var H=-1,de=U==null?0:U.length,Ae=0,rt=[];++H<de;){var Bt=U[H];V(Bt,H,U)&&(rt[Ae++]=Bt)}return rt}function $s(U,V){var H=U==null?0:U.length;return!!H&&hn(U,V,0)>-1}function vo(U,V,H){for(var de=-1,Ae=U==null?0:U.length;++de<Ae;)if(H(V,U[de]))return!0;return!1}function _t(U,V){for(var H=-1,de=U==null?0:U.length,Ae=Array(de);++H<de;)Ae[H]=V(U[H],H,U);return Ae}function vi(U,V){for(var H=-1,de=V.length,Ae=U.length;++H<de;)U[Ae+H]=V[H];return U}function mo(U,V,H,de){var Ae=-1,rt=U==null?0:U.length;for(de&&rt&&(H=U[++Ae]);++Ae<rt;)H=V(H,U[Ae],Ae,U);return H}function dd(U,V,H,de){var Ae=U==null?0:U.length;for(de&&Ae&&(H=U[--Ae]);Ae--;)H=V(H,U[Ae],Ae,U);return H}function bo(U,V){for(var H=-1,de=U==null?0:U.length;++H<de;)if(V(U[H],H,U))return!0;return!1}var gd=wo("length");function yd(U){return U.split("")}function _d(U){return U.match(Lt)||[]}function Lu(U,V,H){var de;return H(U,function(Ae,rt,Bt){if(V(Ae,rt,Bt))return de=rt,!1}),de}function Fs(U,V,H,de){for(var Ae=U.length,rt=H+(de?1:-1);de?rt--:++rt<Ae;)if(V(U[rt],rt,U))return rt;return-1}function hn(U,V,H){return V===V?Cd(U,V,H):Fs(U,Mu,H)}function vd(U,V,H,de){for(var Ae=H-1,rt=U.length;++Ae<rt;)if(de(U[Ae],V))return Ae;return-1}function Mu(U){return U!==U}function zu(U,V){var H=U==null?0:U.length;return H?Do(U,V)/H:Y}function wo(U){return function(V){return V==null?t:V[U]}}function Eo(U){return function(V){return U==null?t:U[V]}}function qu(U,V,H,de,Ae){return Ae(U,function(rt,Bt,ut){H=de?(de=!1,rt):V(H,rt,Bt,ut)}),H}function md(U,V){var H=U.length;for(U.sort(V);H--;)U[H]=U[H].value;return U}function Do(U,V){for(var H,de=-1,Ae=U.length;++de<Ae;){var rt=V(U[de]);rt!==t&&(H=H===t?rt:H+rt)}return H}function Io(U,V){for(var H=-1,de=Array(U);++H<U;)de[H]=V(H);return de}function bd(U,V){return _t(V,function(H){return[H,U[H]]})}function Bu(U){return U&&U.slice(0,ku(U)+1).replace(It,"")}function br(U){return function(V){return U(V)}}function So(U,V){return _t(V,function(H){return U[H]})}function $n(U,V){return U.has(V)}function Hu(U,V){for(var H=-1,de=U.length;++H<de&&hn(V,U[H],0)>-1;);return H}function Ku(U,V){for(var H=U.length;H--&&hn(V,U[H],0)>-1;);return H}function wd(U,V){for(var H=U.length,de=0;H--;)U[H]===V&&++de;return de}var Ed=Eo(E),Dd=Eo(F);function Id(U){return"\\"+pe[U]}function Sd(U,V){return U==null?t:U[V]}function ln(U){return Ns.test(U)}function xd(U){return ji.test(U)}function Od(U){for(var V,H=[];!(V=U.next()).done;)H.push(V.value);return H}function xo(U){var V=-1,H=Array(U.size);return U.forEach(function(de,Ae){H[++V]=[Ae,de]}),H}function Vu(U,V){return function(H){return U(V(H))}}function mi(U,V){for(var H=-1,de=U.length,Ae=0,rt=[];++H<de;){var Bt=U[H];(Bt===V||Bt===_)&&(U[H]=_,rt[Ae++]=H)}return rt}function Us(U){var V=-1,H=Array(U.size);return U.forEach(function(de){H[++V]=de}),H}function Pd(U){var V=-1,H=Array(U.size);return U.forEach(function(de){H[++V]=[de,de]}),H}function Cd(U,V,H){for(var de=H-1,Ae=U.length;++de<Ae;)if(U[de]===V)return de;return-1}function Ad(U,V,H){for(var de=H+1;de--;)if(U[de]===V)return de;return de}function fn(U){return ln(U)?Nd(U):gd(U)}function zr(U){return ln(U)?Rd(U):yd(U)}function ku(U){for(var V=U.length;V--&&Pt.test(U.charAt(V)););return V}var Td=Eo(Z);function Nd(U){for(var V=un.lastIndex=0;un.test(U);)++V;return V}function Rd(U){return U.match(un)||[]}function $d(U){return U.match(Ts)||[]}var Fd=function U(V){V=V==null?Xe:pn.defaults(Xe.Object(),V,pn.pick(Xe,Rs));var H=V.Array,de=V.Date,Ae=V.Error,rt=V.Function,Bt=V.Math,ut=V.Object,Oo=V.RegExp,Ud=V.String,Cr=V.TypeError,js=H.prototype,jd=rt.prototype,dn=ut.prototype,Ls=V["__core-js_shared__"],Ms=jd.toString,nt=dn.hasOwnProperty,Ld=0,Gu=function(){var r=/[^.]+$/.exec(Ls&&Ls.keys&&Ls.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),zs=dn.toString,Md=Ms.call(ut),zd=Xe._,qd=Oo("^"+Ms.call(nt).replace(Dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),qs=lr?V.Buffer:t,bi=V.Symbol,Bs=V.Uint8Array,Wu=qs?qs.allocUnsafe:t,Hs=Vu(ut.getPrototypeOf,ut),Yu=ut.create,Ju=dn.propertyIsEnumerable,Ks=js.splice,Xu=bi?bi.isConcatSpreadable:t,Fn=bi?bi.iterator:t,Mi=bi?bi.toStringTag:t,Vs=function(){try{var r=Ki(ut,"defineProperty");return r({},"",{}),r}catch{}}(),Bd=V.clearTimeout!==Xe.clearTimeout&&V.clearTimeout,Hd=de&&de.now!==Xe.Date.now&&de.now,Kd=V.setTimeout!==Xe.setTimeout&&V.setTimeout,ks=Bt.ceil,Gs=Bt.floor,Po=ut.getOwnPropertySymbols,Vd=qs?qs.isBuffer:t,Zu=V.isFinite,kd=js.join,Gd=Vu(ut.keys,ut),Ht=Bt.max,Xt=Bt.min,Wd=de.now,Yd=V.parseInt,Qu=Bt.random,Jd=js.reverse,Co=Ki(V,"DataView"),Un=Ki(V,"Map"),Ao=Ki(V,"Promise"),gn=Ki(V,"Set"),jn=Ki(V,"WeakMap"),Ln=Ki(ut,"create"),Ws=jn&&new jn,yn={},Xd=Vi(Co),Zd=Vi(Un),Qd=Vi(Ao),eg=Vi(gn),tg=Vi(jn),Ys=bi?bi.prototype:t,Mn=Ys?Ys.valueOf:t,eh=Ys?Ys.toString:t;function v(r){if(xt(r)&&!Ne(r)&&!(r instanceof Ye)){if(r instanceof Ar)return r;if(nt.call(r,"__wrapped__"))return tl(r)}return new Ar(r)}var _n=function(){function r(){}return function(n){if(!mt(n))return{};if(Yu)return Yu(n);r.prototype=n;var o=new r;return r.prototype=t,o}}();function Js(){}function Ar(r,n){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=t}v.templateSettings={escape:wt,evaluate:Et,interpolate:vt,variable:"",imports:{_:v}},v.prototype=Js.prototype,v.prototype.constructor=v,Ar.prototype=_n(Js.prototype),Ar.prototype.constructor=Ar;function Ye(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function rg(){var r=new Ye(this.__wrapped__);return r.__actions__=fr(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=fr(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=fr(this.__views__),r}function ig(){if(this.__filtered__){var r=new Ye(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function ng(){var r=this.__wrapped__.value(),n=this.__dir__,o=Ne(r),h=n<0,g=o?r.length:0,m=y0(0,g,this.__views__),S=m.start,T=m.end,L=T-S,J=h?T:S-1,X=this.__iteratees__,Q=X.length,oe=0,ye=Xt(L,this.__takeCount__);if(!o||!h&&g==L&&ye==L)return Ih(r,this.__actions__);var we=[];e:for(;L--&&oe<ye;){J+=n;for(var qe=-1,Ee=r[J];++qe<Q;){var Ge=X[qe],Ze=Ge.iteratee,Dr=Ge.type,sr=Ze(Ee);if(Dr==q)Ee=sr;else if(!sr){if(Dr==$)continue e;break e}}we[oe++]=Ee}return we}Ye.prototype=_n(Js.prototype),Ye.prototype.constructor=Ye;function zi(r){var n=-1,o=r==null?0:r.length;for(this.clear();++n<o;){var h=r[n];this.set(h[0],h[1])}}function sg(){this.__data__=Ln?Ln(null):{},this.size=0}function ag(r){var n=this.has(r)&&delete this.__data__[r];return this.size-=n?1:0,n}function og(r){var n=this.__data__;if(Ln){var o=n[r];return o===y?t:o}return nt.call(n,r)?n[r]:t}function cg(r){var n=this.__data__;return Ln?n[r]!==t:nt.call(n,r)}function ug(r,n){var o=this.__data__;return this.size+=this.has(r)?0:1,o[r]=Ln&&n===t?y:n,this}zi.prototype.clear=sg,zi.prototype.delete=ag,zi.prototype.get=og,zi.prototype.has=cg,zi.prototype.set=ug;function si(r){var n=-1,o=r==null?0:r.length;for(this.clear();++n<o;){var h=r[n];this.set(h[0],h[1])}}function hg(){this.__data__=[],this.size=0}function lg(r){var n=this.__data__,o=Xs(n,r);if(o<0)return!1;var h=n.length-1;return o==h?n.pop():Ks.call(n,o,1),--this.size,!0}function fg(r){var n=this.__data__,o=Xs(n,r);return o<0?t:n[o][1]}function pg(r){return Xs(this.__data__,r)>-1}function dg(r,n){var o=this.__data__,h=Xs(o,r);return h<0?(++this.size,o.push([r,n])):o[h][1]=n,this}si.prototype.clear=hg,si.prototype.delete=lg,si.prototype.get=fg,si.prototype.has=pg,si.prototype.set=dg;function ai(r){var n=-1,o=r==null?0:r.length;for(this.clear();++n<o;){var h=r[n];this.set(h[0],h[1])}}function gg(){this.size=0,this.__data__={hash:new zi,map:new(Un||si),string:new zi}}function yg(r){var n=ua(this,r).delete(r);return this.size-=n?1:0,n}function _g(r){return ua(this,r).get(r)}function vg(r){return ua(this,r).has(r)}function mg(r,n){var o=ua(this,r),h=o.size;return o.set(r,n),this.size+=o.size==h?0:1,this}ai.prototype.clear=gg,ai.prototype.delete=yg,ai.prototype.get=_g,ai.prototype.has=vg,ai.prototype.set=mg;function qi(r){var n=-1,o=r==null?0:r.length;for(this.__data__=new ai;++n<o;)this.add(r[n])}function bg(r){return this.__data__.set(r,y),this}function wg(r){return this.__data__.has(r)}qi.prototype.add=qi.prototype.push=bg,qi.prototype.has=wg;function qr(r){var n=this.__data__=new si(r);this.size=n.size}function Eg(){this.__data__=new si,this.size=0}function Dg(r){var n=this.__data__,o=n.delete(r);return this.size=n.size,o}function Ig(r){return this.__data__.get(r)}function Sg(r){return this.__data__.has(r)}function xg(r,n){var o=this.__data__;if(o instanceof si){var h=o.__data__;if(!Un||h.length<a-1)return h.push([r,n]),this.size=++o.size,this;o=this.__data__=new ai(h)}return o.set(r,n),this.size=o.size,this}qr.prototype.clear=Eg,qr.prototype.delete=Dg,qr.prototype.get=Ig,qr.prototype.has=Sg,qr.prototype.set=xg;function th(r,n){var o=Ne(r),h=!o&&ki(r),g=!o&&!h&&Si(r),m=!o&&!h&&!g&&wn(r),S=o||h||g||m,T=S?Io(r.length,Ud):[],L=T.length;for(var J in r)(n||nt.call(r,J))&&!(S&&(J=="length"||g&&(J=="offset"||J=="parent")||m&&(J=="buffer"||J=="byteLength"||J=="byteOffset")||hi(J,L)))&&T.push(J);return T}function rh(r){var n=r.length;return n?r[qo(0,n-1)]:t}function Og(r,n){return ha(fr(r),Bi(n,0,r.length))}function Pg(r){return ha(fr(r))}function To(r,n,o){(o!==t&&!Br(r[n],o)||o===t&&!(n in r))&&oi(r,n,o)}function zn(r,n,o){var h=r[n];(!(nt.call(r,n)&&Br(h,o))||o===t&&!(n in r))&&oi(r,n,o)}function Xs(r,n){for(var o=r.length;o--;)if(Br(r[o][0],n))return o;return-1}function Cg(r,n,o,h){return wi(r,function(g,m,S){n(h,g,o(g),S)}),h}function ih(r,n){return r&&Yr(n,Vt(n),r)}function Ag(r,n){return r&&Yr(n,dr(n),r)}function oi(r,n,o){n=="__proto__"&&Vs?Vs(r,n,{configurable:!0,enumerable:!0,value:o,writable:!0}):r[n]=o}function No(r,n){for(var o=-1,h=n.length,g=H(h),m=r==null;++o<h;)g[o]=m?t:fc(r,n[o]);return g}function Bi(r,n,o){return r===r&&(o!==t&&(r=r<=o?r:o),n!==t&&(r=r>=n?r:n)),r}function Tr(r,n,o,h,g,m){var S,T=n&I,L=n&D,J=n&O;if(o&&(S=g?o(r,h,g,m):o(r)),S!==t)return S;if(!mt(r))return r;var X=Ne(r);if(X){if(S=v0(r),!T)return fr(r,S)}else{var Q=Zt(r),oe=Q==se||Q==fe;if(Si(r))return Oh(r,T);if(Q==je||Q==he||oe&&!g){if(S=L||oe?{}:kh(r),!T)return L?o0(r,Ag(S,r)):a0(r,ih(S,r))}else{if(!st[Q])return g?r:{};S=m0(r,Q,T)}}m||(m=new qr);var ye=m.get(r);if(ye)return ye;m.set(r,S),wl(r)?r.forEach(function(Ee){S.add(Tr(Ee,n,o,Ee,r,m))}):ml(r)&&r.forEach(function(Ee,Ge){S.set(Ge,Tr(Ee,n,o,Ge,r,m))});var we=J?L?Zo:Xo:L?dr:Vt,qe=X?t:we(r);return Pr(qe||r,function(Ee,Ge){qe&&(Ge=Ee,Ee=r[Ge]),zn(S,Ge,Tr(Ee,n,o,Ge,r,m))}),S}function Tg(r){var n=Vt(r);return function(o){return nh(o,r,n)}}function nh(r,n,o){var h=o.length;if(r==null)return!h;for(r=ut(r);h--;){var g=o[h],m=n[g],S=r[g];if(S===t&&!(g in r)||!m(S))return!1}return!0}function sh(r,n,o){if(typeof r!="function")throw new Cr(p);return Gn(function(){r.apply(t,o)},n)}function qn(r,n,o,h){var g=-1,m=$s,S=!0,T=r.length,L=[],J=n.length;if(!T)return L;o&&(n=_t(n,br(o))),h?(m=vo,S=!1):n.length>=a&&(m=$n,S=!1,n=new qi(n));e:for(;++g<T;){var X=r[g],Q=o==null?X:o(X);if(X=h||X!==0?X:0,S&&Q===Q){for(var oe=J;oe--;)if(n[oe]===Q)continue e;L.push(X)}else m(n,Q,h)||L.push(X)}return L}var wi=Nh(Wr),ah=Nh($o,!0);function Ng(r,n){var o=!0;return wi(r,function(h,g,m){return o=!!n(h,g,m),o}),o}function Zs(r,n,o){for(var h=-1,g=r.length;++h<g;){var m=r[h],S=n(m);if(S!=null&&(T===t?S===S&&!Er(S):o(S,T)))var T=S,L=m}return L}function Rg(r,n,o,h){var g=r.length;for(o=Le(o),o<0&&(o=-o>g?0:g+o),h=h===t||h>g?g:Le(h),h<0&&(h+=g),h=o>h?0:Dl(h);o<h;)r[o++]=n;return r}function oh(r,n){var o=[];return wi(r,function(h,g,m){n(h,g,m)&&o.push(h)}),o}function Wt(r,n,o,h,g){var m=-1,S=r.length;for(o||(o=w0),g||(g=[]);++m<S;){var T=r[m];n>0&&o(T)?n>1?Wt(T,n-1,o,h,g):vi(g,T):h||(g[g.length]=T)}return g}var Ro=Rh(),ch=Rh(!0);function Wr(r,n){return r&&Ro(r,n,Vt)}function $o(r,n){return r&&ch(r,n,Vt)}function Qs(r,n){return _i(n,function(o){return li(r[o])})}function Hi(r,n){n=Di(n,r);for(var o=0,h=n.length;r!=null&&o<h;)r=r[Jr(n[o++])];return o&&o==h?r:t}function uh(r,n,o){var h=n(r);return Ne(r)?h:vi(h,o(r))}function ir(r){return r==null?r===t?ze:Ve:Mi&&Mi in ut(r)?g0(r):P0(r)}function Fo(r,n){return r>n}function $g(r,n){return r!=null&&nt.call(r,n)}function Fg(r,n){return r!=null&&n in ut(r)}function Ug(r,n,o){return r>=Xt(n,o)&&r<Ht(n,o)}function Uo(r,n,o){for(var h=o?vo:$s,g=r[0].length,m=r.length,S=m,T=H(m),L=1/0,J=[];S--;){var X=r[S];S&&n&&(X=_t(X,br(n))),L=Xt(X.length,L),T[S]=!o&&(n||g>=120&&X.length>=120)?new qi(S&&X):t}X=r[0];var Q=-1,oe=T[0];e:for(;++Q<g&&J.length<L;){var ye=X[Q],we=n?n(ye):ye;if(ye=o||ye!==0?ye:0,!(oe?$n(oe,we):h(J,we,o))){for(S=m;--S;){var qe=T[S];if(!(qe?$n(qe,we):h(r[S],we,o)))continue e}oe&&oe.push(we),J.push(ye)}}return J}function jg(r,n,o,h){return Wr(r,function(g,m,S){n(h,o(g),m,S)}),h}function Bn(r,n,o){n=Di(n,r),r=Jh(r,n);var h=r==null?r:r[Jr(Rr(n))];return h==null?t:Kt(h,r,o)}function hh(r){return xt(r)&&ir(r)==he}function Lg(r){return xt(r)&&ir(r)==De}function Mg(r){return xt(r)&&ir(r)==R}function Hn(r,n,o,h,g){return r===n?!0:r==null||n==null||!xt(r)&&!xt(n)?r!==r&&n!==n:zg(r,n,o,h,Hn,g)}function zg(r,n,o,h,g,m){var S=Ne(r),T=Ne(n),L=S?ve:Zt(r),J=T?ve:Zt(n);L=L==he?je:L,J=J==he?je:J;var X=L==je,Q=J==je,oe=L==J;if(oe&&Si(r)){if(!Si(n))return!1;S=!0,X=!1}if(oe&&!X)return m||(m=new qr),S||wn(r)?Hh(r,n,o,h,g,m):p0(r,n,L,o,h,g,m);if(!(o&A)){var ye=X&&nt.call(r,"__wrapped__"),we=Q&&nt.call(n,"__wrapped__");if(ye||we){var qe=ye?r.value():r,Ee=we?n.value():n;return m||(m=new qr),g(qe,Ee,o,h,m)}}return oe?(m||(m=new qr),d0(r,n,o,h,g,m)):!1}function qg(r){return xt(r)&&Zt(r)==Ie}function jo(r,n,o,h){var g=o.length,m=g,S=!h;if(r==null)return!m;for(r=ut(r);g--;){var T=o[g];if(S&&T[2]?T[1]!==r[T[0]]:!(T[0]in r))return!1}for(;++g<m;){T=o[g];var L=T[0],J=r[L],X=T[1];if(S&&T[2]){if(J===t&&!(L in r))return!1}else{var Q=new qr;if(h)var oe=h(J,X,L,r,n,Q);if(!(oe===t?Hn(X,J,A|B,h,Q):oe))return!1}}return!0}function lh(r){if(!mt(r)||D0(r))return!1;var n=li(r)?qd:to;return n.test(Vi(r))}function Bg(r){return xt(r)&&ir(r)==Me}function Hg(r){return xt(r)&&Zt(r)==Se}function Kg(r){return xt(r)&&ya(r.length)&&!!at[ir(r)]}function fh(r){return typeof r=="function"?r:r==null?gr:typeof r=="object"?Ne(r)?gh(r[0],r[1]):dh(r):$l(r)}function Lo(r){if(!kn(r))return Gd(r);var n=[];for(var o in ut(r))nt.call(r,o)&&o!="constructor"&&n.push(o);return n}function Vg(r){if(!mt(r))return O0(r);var n=kn(r),o=[];for(var h in r)h=="constructor"&&(n||!nt.call(r,h))||o.push(h);return o}function Mo(r,n){return r<n}function ph(r,n){var o=-1,h=pr(r)?H(r.length):[];return wi(r,function(g,m,S){h[++o]=n(g,m,S)}),h}function dh(r){var n=ec(r);return n.length==1&&n[0][2]?Wh(n[0][0],n[0][1]):function(o){return o===r||jo(o,r,n)}}function gh(r,n){return rc(r)&&Gh(n)?Wh(Jr(r),n):function(o){var h=fc(o,r);return h===t&&h===n?pc(o,r):Hn(n,h,A|B)}}function ea(r,n,o,h,g){r!==n&&Ro(n,function(m,S){if(g||(g=new qr),mt(m))kg(r,n,S,o,ea,h,g);else{var T=h?h(nc(r,S),m,S+"",r,n,g):t;T===t&&(T=m),To(r,S,T)}},dr)}function kg(r,n,o,h,g,m,S){var T=nc(r,o),L=nc(n,o),J=S.get(L);if(J){To(r,o,J);return}var X=m?m(T,L,o+"",r,n,S):t,Q=X===t;if(Q){var oe=Ne(L),ye=!oe&&Si(L),we=!oe&&!ye&&wn(L);X=L,oe||ye||we?Ne(T)?X=T:At(T)?X=fr(T):ye?(Q=!1,X=Oh(L,!0)):we?(Q=!1,X=Ph(L,!0)):X=[]:Wn(L)||ki(L)?(X=T,ki(T)?X=Il(T):(!mt(T)||li(T))&&(X=kh(L))):Q=!1}Q&&(S.set(L,X),g(X,L,h,m,S),S.delete(L)),To(r,o,X)}function yh(r,n){var o=r.length;if(o)return n+=n<0?o:0,hi(n,o)?r[n]:t}function _h(r,n,o){n.length?n=_t(n,function(m){return Ne(m)?function(S){return Hi(S,m.length===1?m[0]:m)}:m}):n=[gr];var h=-1;n=_t(n,br(me()));var g=ph(r,function(m,S,T){var L=_t(n,function(J){return J(m)});return{criteria:L,index:++h,value:m}});return md(g,function(m,S){return s0(m,S,o)})}function Gg(r,n){return vh(r,n,function(o,h){return pc(r,h)})}function vh(r,n,o){for(var h=-1,g=n.length,m={};++h<g;){var S=n[h],T=Hi(r,S);o(T,S)&&Kn(m,Di(S,r),T)}return m}function Wg(r){return function(n){return Hi(n,r)}}function zo(r,n,o,h){var g=h?vd:hn,m=-1,S=n.length,T=r;for(r===n&&(n=fr(n)),o&&(T=_t(r,br(o)));++m<S;)for(var L=0,J=n[m],X=o?o(J):J;(L=g(T,X,L,h))>-1;)T!==r&&Ks.call(T,L,1),Ks.call(r,L,1);return r}function mh(r,n){for(var o=r?n.length:0,h=o-1;o--;){var g=n[o];if(o==h||g!==m){var m=g;hi(g)?Ks.call(r,g,1):Ko(r,g)}}return r}function qo(r,n){return r+Gs(Qu()*(n-r+1))}function Yg(r,n,o,h){for(var g=-1,m=Ht(ks((n-r)/(o||1)),0),S=H(m);m--;)S[h?m:++g]=r,r+=o;return S}function Bo(r,n){var o="";if(!r||n<1||n>W)return o;do n%2&&(o+=r),n=Gs(n/2),n&&(r+=r);while(n);return o}function Ke(r,n){return sc(Yh(r,n,gr),r+"")}function Jg(r){return rh(En(r))}function Xg(r,n){var o=En(r);return ha(o,Bi(n,0,o.length))}function Kn(r,n,o,h){if(!mt(r))return r;n=Di(n,r);for(var g=-1,m=n.length,S=m-1,T=r;T!=null&&++g<m;){var L=Jr(n[g]),J=o;if(L==="__proto__"||L==="constructor"||L==="prototype")return r;if(g!=S){var X=T[L];J=h?h(X,L,T):t,J===t&&(J=mt(X)?X:hi(n[g+1])?[]:{})}zn(T,L,J),T=T[L]}return r}var bh=Ws?function(r,n){return Ws.set(r,n),r}:gr,Zg=Vs?function(r,n){return Vs(r,"toString",{configurable:!0,enumerable:!1,value:gc(n),writable:!0})}:gr;function Qg(r){return ha(En(r))}function Nr(r,n,o){var h=-1,g=r.length;n<0&&(n=-n>g?0:g+n),o=o>g?g:o,o<0&&(o+=g),g=n>o?0:o-n>>>0,n>>>=0;for(var m=H(g);++h<g;)m[h]=r[h+n];return m}function e0(r,n){var o;return wi(r,function(h,g,m){return o=n(h,g,m),!o}),!!o}function ta(r,n,o){var h=0,g=r==null?h:r.length;if(typeof n=="number"&&n===n&&g<=ne){for(;h<g;){var m=h+g>>>1,S=r[m];S!==null&&!Er(S)&&(o?S<=n:S<n)?h=m+1:g=m}return g}return Ho(r,n,gr,o)}function Ho(r,n,o,h){var g=0,m=r==null?0:r.length;if(m===0)return 0;n=o(n);for(var S=n!==n,T=n===null,L=Er(n),J=n===t;g<m;){var X=Gs((g+m)/2),Q=o(r[X]),oe=Q!==t,ye=Q===null,we=Q===Q,qe=Er(Q);if(S)var Ee=h||we;else J?Ee=we&&(h||oe):T?Ee=we&&oe&&(h||!ye):L?Ee=we&&oe&&!ye&&(h||!qe):ye||qe?Ee=!1:Ee=h?Q<=n:Q<n;Ee?g=X+1:m=X}return Xt(m,xe)}function wh(r,n){for(var o=-1,h=r.length,g=0,m=[];++o<h;){var S=r[o],T=n?n(S):S;if(!o||!Br(T,L)){var L=T;m[g++]=S===0?0:S}}return m}function Eh(r){return typeof r=="number"?r:Er(r)?Y:+r}function wr(r){if(typeof r=="string")return r;if(Ne(r))return _t(r,wr)+"";if(Er(r))return eh?eh.call(r):"";var n=r+"";return n=="0"&&1/r==-te?"-0":n}function Ei(r,n,o){var h=-1,g=$s,m=r.length,S=!0,T=[],L=T;if(o)S=!1,g=vo;else if(m>=a){var J=n?null:l0(r);if(J)return Us(J);S=!1,g=$n,L=new qi}else L=n?[]:T;e:for(;++h<m;){var X=r[h],Q=n?n(X):X;if(X=o||X!==0?X:0,S&&Q===Q){for(var oe=L.length;oe--;)if(L[oe]===Q)continue e;n&&L.push(Q),T.push(X)}else g(L,Q,o)||(L!==T&&L.push(Q),T.push(X))}return T}function Ko(r,n){return n=Di(n,r),r=Jh(r,n),r==null||delete r[Jr(Rr(n))]}function Dh(r,n,o,h){return Kn(r,n,o(Hi(r,n)),h)}function ra(r,n,o,h){for(var g=r.length,m=h?g:-1;(h?m--:++m<g)&&n(r[m],m,r););return o?Nr(r,h?0:m,h?m+1:g):Nr(r,h?m+1:0,h?g:m)}function Ih(r,n){var o=r;return o instanceof Ye&&(o=o.value()),mo(n,function(h,g){return g.func.apply(g.thisArg,vi([h],g.args))},o)}function Vo(r,n,o){var h=r.length;if(h<2)return h?Ei(r[0]):[];for(var g=-1,m=H(h);++g<h;)for(var S=r[g],T=-1;++T<h;)T!=g&&(m[g]=qn(m[g]||S,r[T],n,o));return Ei(Wt(m,1),n,o)}function Sh(r,n,o){for(var h=-1,g=r.length,m=n.length,S={};++h<g;){var T=h<m?n[h]:t;o(S,r[h],T)}return S}function ko(r){return At(r)?r:[]}function Go(r){return typeof r=="function"?r:gr}function Di(r,n){return Ne(r)?r:rc(r,n)?[r]:el(it(r))}var t0=Ke;function Ii(r,n,o){var h=r.length;return o=o===t?h:o,!n&&o>=h?r:Nr(r,n,o)}var xh=Bd||function(r){return Xe.clearTimeout(r)};function Oh(r,n){if(n)return r.slice();var o=r.length,h=Wu?Wu(o):new r.constructor(o);return r.copy(h),h}function Wo(r){var n=new r.constructor(r.byteLength);return new Bs(n).set(new Bs(r)),n}function r0(r,n){var o=n?Wo(r.buffer):r.buffer;return new r.constructor(o,r.byteOffset,r.byteLength)}function i0(r){var n=new r.constructor(r.source,xr.exec(r));return n.lastIndex=r.lastIndex,n}function n0(r){return Mn?ut(Mn.call(r)):{}}function Ph(r,n){var o=n?Wo(r.buffer):r.buffer;return new r.constructor(o,r.byteOffset,r.length)}function Ch(r,n){if(r!==n){var o=r!==t,h=r===null,g=r===r,m=Er(r),S=n!==t,T=n===null,L=n===n,J=Er(n);if(!T&&!J&&!m&&r>n||m&&S&&L&&!T&&!J||h&&S&&L||!o&&L||!g)return 1;if(!h&&!m&&!J&&r<n||J&&o&&g&&!h&&!m||T&&o&&g||!S&&g||!L)return-1}return 0}function s0(r,n,o){for(var h=-1,g=r.criteria,m=n.criteria,S=g.length,T=o.length;++h<S;){var L=Ch(g[h],m[h]);if(L){if(h>=T)return L;var J=o[h];return L*(J=="desc"?-1:1)}}return r.index-n.index}function Ah(r,n,o,h){for(var g=-1,m=r.length,S=o.length,T=-1,L=n.length,J=Ht(m-S,0),X=H(L+J),Q=!h;++T<L;)X[T]=n[T];for(;++g<S;)(Q||g<m)&&(X[o[g]]=r[g]);for(;J--;)X[T++]=r[g++];return X}function Th(r,n,o,h){for(var g=-1,m=r.length,S=-1,T=o.length,L=-1,J=n.length,X=Ht(m-T,0),Q=H(X+J),oe=!h;++g<X;)Q[g]=r[g];for(var ye=g;++L<J;)Q[ye+L]=n[L];for(;++S<T;)(oe||g<m)&&(Q[ye+o[S]]=r[g++]);return Q}function fr(r,n){var o=-1,h=r.length;for(n||(n=H(h));++o<h;)n[o]=r[o];return n}function Yr(r,n,o,h){var g=!o;o||(o={});for(var m=-1,S=n.length;++m<S;){var T=n[m],L=h?h(o[T],r[T],T,o,r):t;L===t&&(L=r[T]),g?oi(o,T,L):zn(o,T,L)}return o}function a0(r,n){return Yr(r,tc(r),n)}function o0(r,n){return Yr(r,Kh(r),n)}function ia(r,n){return function(o,h){var g=Ne(o)?fd:Cg,m=n?n():{};return g(o,r,me(h,2),m)}}function vn(r){return Ke(function(n,o){var h=-1,g=o.length,m=g>1?o[g-1]:t,S=g>2?o[2]:t;for(m=r.length>3&&typeof m=="function"?(g--,m):t,S&&nr(o[0],o[1],S)&&(m=g<3?t:m,g=1),n=ut(n);++h<g;){var T=o[h];T&&r(n,T,h,m)}return n})}function Nh(r,n){return function(o,h){if(o==null)return o;if(!pr(o))return r(o,h);for(var g=o.length,m=n?g:-1,S=ut(o);(n?m--:++m<g)&&h(S[m],m,S)!==!1;);return o}}function Rh(r){return function(n,o,h){for(var g=-1,m=ut(n),S=h(n),T=S.length;T--;){var L=S[r?T:++g];if(o(m[L],L,m)===!1)break}return n}}function c0(r,n,o){var h=n&G,g=Vn(r);function m(){var S=this&&this!==Xe&&this instanceof m?g:r;return S.apply(h?o:this,arguments)}return m}function $h(r){return function(n){n=it(n);var o=ln(n)?zr(n):t,h=o?o[0]:n.charAt(0),g=o?Ii(o,1).join(""):n.slice(1);return h[r]()+g}}function mn(r){return function(n){return mo(Nl(Tl(n).replace(Nn,"")),r,"")}}function Vn(r){return function(){var n=arguments;switch(n.length){case 0:return new r;case 1:return new r(n[0]);case 2:return new r(n[0],n[1]);case 3:return new r(n[0],n[1],n[2]);case 4:return new r(n[0],n[1],n[2],n[3]);case 5:return new r(n[0],n[1],n[2],n[3],n[4]);case 6:return new r(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new r(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var o=_n(r.prototype),h=r.apply(o,n);return mt(h)?h:o}}function u0(r,n,o){var h=Vn(r);function g(){for(var m=arguments.length,S=H(m),T=m,L=bn(g);T--;)S[T]=arguments[T];var J=m<3&&S[0]!==L&&S[m-1]!==L?[]:mi(S,L);if(m-=J.length,m<o)return Mh(r,n,na,g.placeholder,t,S,J,t,t,o-m);var X=this&&this!==Xe&&this instanceof g?h:r;return Kt(X,this,S)}return g}function Fh(r){return function(n,o,h){var g=ut(n);if(!pr(n)){var m=me(o,3);n=Vt(n),o=function(T){return m(g[T],T,g)}}var S=r(n,o,h);return S>-1?g[m?n[S]:S]:t}}function Uh(r){return ui(function(n){var o=n.length,h=o,g=Ar.prototype.thru;for(r&&n.reverse();h--;){var m=n[h];if(typeof m!="function")throw new Cr(p);if(g&&!S&&ca(m)=="wrapper")var S=new Ar([],!0)}for(h=S?h:o;++h<o;){m=n[h];var T=ca(m),L=T=="wrapper"?Qo(m):t;L&&ic(L[0])&&L[1]==(u|j|C|b)&&!L[4].length&&L[9]==1?S=S[ca(L[0])].apply(S,L[3]):S=m.length==1&&ic(m)?S[T]():S.thru(m)}return function(){var J=arguments,X=J[0];if(S&&J.length==1&&Ne(X))return S.plant(X).value();for(var Q=0,oe=o?n[Q].apply(this,J):X;++Q<o;)oe=n[Q].call(this,oe);return oe}})}function na(r,n,o,h,g,m,S,T,L,J){var X=n&u,Q=n&G,oe=n&ie,ye=n&(j|x),we=n&K,qe=oe?t:Vn(r);function Ee(){for(var Ge=arguments.length,Ze=H(Ge),Dr=Ge;Dr--;)Ze[Dr]=arguments[Dr];if(ye)var sr=bn(Ee),Ir=wd(Ze,sr);if(h&&(Ze=Ah(Ze,h,g,ye)),m&&(Ze=Th(Ze,m,S,ye)),Ge-=Ir,ye&&Ge<J){var Tt=mi(Ze,sr);return Mh(r,n,na,Ee.placeholder,o,Ze,Tt,T,L,J-Ge)}var Hr=Q?o:this,pi=oe?Hr[r]:r;return Ge=Ze.length,T?Ze=C0(Ze,T):we&&Ge>1&&Ze.reverse(),X&&L<Ge&&(Ze.length=L),this&&this!==Xe&&this instanceof Ee&&(pi=qe||Vn(pi)),pi.apply(Hr,Ze)}return Ee}function jh(r,n){return function(o,h){return jg(o,r,n(h),{})}}function sa(r,n){return function(o,h){var g;if(o===t&&h===t)return n;if(o!==t&&(g=o),h!==t){if(g===t)return h;typeof o=="string"||typeof h=="string"?(o=wr(o),h=wr(h)):(o=Eh(o),h=Eh(h)),g=r(o,h)}return g}}function Yo(r){return ui(function(n){return n=_t(n,br(me())),Ke(function(o){var h=this;return r(n,function(g){return Kt(g,h,o)})})})}function aa(r,n){n=n===t?" ":wr(n);var o=n.length;if(o<2)return o?Bo(n,r):n;var h=Bo(n,ks(r/fn(n)));return ln(n)?Ii(zr(h),0,r).join(""):h.slice(0,r)}function h0(r,n,o,h){var g=n&G,m=Vn(r);function S(){for(var T=-1,L=arguments.length,J=-1,X=h.length,Q=H(X+L),oe=this&&this!==Xe&&this instanceof S?m:r;++J<X;)Q[J]=h[J];for(;L--;)Q[J++]=arguments[++T];return Kt(oe,g?o:this,Q)}return S}function Lh(r){return function(n,o,h){return h&&typeof h!="number"&&nr(n,o,h)&&(o=h=t),n=fi(n),o===t?(o=n,n=0):o=fi(o),h=h===t?n<o?1:-1:fi(h),Yg(n,o,h,r)}}function oa(r){return function(n,o){return typeof n=="string"&&typeof o=="string"||(n=$r(n),o=$r(o)),r(n,o)}}function Mh(r,n,o,h,g,m,S,T,L,J){var X=n&j,Q=X?S:t,oe=X?t:S,ye=X?m:t,we=X?t:m;n|=X?C:w,n&=~(X?w:C),n&N||(n&=~(G|ie));var qe=[r,n,g,ye,Q,we,oe,T,L,J],Ee=o.apply(t,qe);return ic(r)&&Xh(Ee,qe),Ee.placeholder=h,Zh(Ee,r,n)}function Jo(r){var n=Bt[r];return function(o,h){if(o=$r(o),h=h==null?0:Xt(Le(h),292),h&&Zu(o)){var g=(it(o)+"e").split("e"),m=n(g[0]+"e"+(+g[1]+h));return g=(it(m)+"e").split("e"),+(g[0]+"e"+(+g[1]-h))}return n(o)}}var l0=gn&&1/Us(new gn([,-0]))[1]==te?function(r){return new gn(r)}:vc;function zh(r){return function(n){var o=Zt(n);return o==Ie?xo(n):o==Se?Pd(n):bd(n,r(n))}}function ci(r,n,o,h,g,m,S,T){var L=n&ie;if(!L&&typeof r!="function")throw new Cr(p);var J=h?h.length:0;if(J||(n&=~(C|w),h=g=t),S=S===t?S:Ht(Le(S),0),T=T===t?T:Le(T),J-=g?g.length:0,n&w){var X=h,Q=g;h=g=t}var oe=L?t:Qo(r),ye=[r,n,o,h,g,X,Q,m,S,T];if(oe&&x0(ye,oe),r=ye[0],n=ye[1],o=ye[2],h=ye[3],g=ye[4],T=ye[9]=ye[9]===t?L?0:r.length:Ht(ye[9]-J,0),!T&&n&(j|x)&&(n&=~(j|x)),!n||n==G)var we=c0(r,n,o);else n==j||n==x?we=u0(r,n,T):(n==C||n==(G|C))&&!g.length?we=h0(r,n,o,h):we=na.apply(t,ye);var qe=oe?bh:Xh;return Zh(qe(we,ye),r,n)}function qh(r,n,o,h){return r===t||Br(r,dn[o])&&!nt.call(h,o)?n:r}function Bh(r,n,o,h,g,m){return mt(r)&&mt(n)&&(m.set(n,r),ea(r,n,t,Bh,m),m.delete(n)),r}function f0(r){return Wn(r)?t:r}function Hh(r,n,o,h,g,m){var S=o&A,T=r.length,L=n.length;if(T!=L&&!(S&&L>T))return!1;var J=m.get(r),X=m.get(n);if(J&&X)return J==n&&X==r;var Q=-1,oe=!0,ye=o&B?new qi:t;for(m.set(r,n),m.set(n,r);++Q<T;){var we=r[Q],qe=n[Q];if(h)var Ee=S?h(qe,we,Q,n,r,m):h(we,qe,Q,r,n,m);if(Ee!==t){if(Ee)continue;oe=!1;break}if(ye){if(!bo(n,function(Ge,Ze){if(!$n(ye,Ze)&&(we===Ge||g(we,Ge,o,h,m)))return ye.push(Ze)})){oe=!1;break}}else if(!(we===qe||g(we,qe,o,h,m))){oe=!1;break}}return m.delete(r),m.delete(n),oe}function p0(r,n,o,h,g,m,S){switch(o){case Ce:if(r.byteLength!=n.byteLength||r.byteOffset!=n.byteOffset)return!1;r=r.buffer,n=n.buffer;case De:return!(r.byteLength!=n.byteLength||!m(new Bs(r),new Bs(n)));case M:case R:case Be:return Br(+r,+n);case P:return r.name==n.name&&r.message==n.message;case Me:case Re:return r==n+"";case Ie:var T=xo;case Se:var L=h&A;if(T||(T=Us),r.size!=n.size&&!L)return!1;var J=S.get(r);if(J)return J==n;h|=B,S.set(r,n);var X=Hh(T(r),T(n),h,g,m,S);return S.delete(r),X;case $e:if(Mn)return Mn.call(r)==Mn.call(n)}return!1}function d0(r,n,o,h,g,m){var S=o&A,T=Xo(r),L=T.length,J=Xo(n),X=J.length;if(L!=X&&!S)return!1;for(var Q=L;Q--;){var oe=T[Q];if(!(S?oe in n:nt.call(n,oe)))return!1}var ye=m.get(r),we=m.get(n);if(ye&&we)return ye==n&&we==r;var qe=!0;m.set(r,n),m.set(n,r);for(var Ee=S;++Q<L;){oe=T[Q];var Ge=r[oe],Ze=n[oe];if(h)var Dr=S?h(Ze,Ge,oe,n,r,m):h(Ge,Ze,oe,r,n,m);if(!(Dr===t?Ge===Ze||g(Ge,Ze,o,h,m):Dr)){qe=!1;break}Ee||(Ee=oe=="constructor")}if(qe&&!Ee){var sr=r.constructor,Ir=n.constructor;sr!=Ir&&"constructor"in r&&"constructor"in n&&!(typeof sr=="function"&&sr instanceof sr&&typeof Ir=="function"&&Ir instanceof Ir)&&(qe=!1)}return m.delete(r),m.delete(n),qe}function ui(r){return sc(Yh(r,t,nl),r+"")}function Xo(r){return uh(r,Vt,tc)}function Zo(r){return uh(r,dr,Kh)}var Qo=Ws?function(r){return Ws.get(r)}:vc;function ca(r){for(var n=r.name+"",o=yn[n],h=nt.call(yn,n)?o.length:0;h--;){var g=o[h],m=g.func;if(m==null||m==r)return g.name}return n}function bn(r){var n=nt.call(v,"placeholder")?v:r;return n.placeholder}function me(){var r=v.iteratee||yc;return r=r===yc?fh:r,arguments.length?r(arguments[0],arguments[1]):r}function ua(r,n){var o=r.__data__;return E0(n)?o[typeof n=="string"?"string":"hash"]:o.map}function ec(r){for(var n=Vt(r),o=n.length;o--;){var h=n[o],g=r[h];n[o]=[h,g,Gh(g)]}return n}function Ki(r,n){var o=Sd(r,n);return lh(o)?o:t}function g0(r){var n=nt.call(r,Mi),o=r[Mi];try{r[Mi]=t;var h=!0}catch{}var g=zs.call(r);return h&&(n?r[Mi]=o:delete r[Mi]),g}var tc=Po?function(r){return r==null?[]:(r=ut(r),_i(Po(r),function(n){return Ju.call(r,n)}))}:mc,Kh=Po?function(r){for(var n=[];r;)vi(n,tc(r)),r=Hs(r);return n}:mc,Zt=ir;(Co&&Zt(new Co(new ArrayBuffer(1)))!=Ce||Un&&Zt(new Un)!=Ie||Ao&&Zt(Ao.resolve())!=pt||gn&&Zt(new gn)!=Se||jn&&Zt(new jn)!=Pe)&&(Zt=function(r){var n=ir(r),o=n==je?r.constructor:t,h=o?Vi(o):"";if(h)switch(h){case Xd:return Ce;case Zd:return Ie;case Qd:return pt;case eg:return Se;case tg:return Pe}return n});function y0(r,n,o){for(var h=-1,g=o.length;++h<g;){var m=o[h],S=m.size;switch(m.type){case"drop":r+=S;break;case"dropRight":n-=S;break;case"take":n=Xt(n,r+S);break;case"takeRight":r=Ht(r,n-S);break}}return{start:r,end:n}}function _0(r){var n=r.match(ht);return n?n[1].split(jt):[]}function Vh(r,n,o){n=Di(n,r);for(var h=-1,g=n.length,m=!1;++h<g;){var S=Jr(n[h]);if(!(m=r!=null&&o(r,S)))break;r=r[S]}return m||++h!=g?m:(g=r==null?0:r.length,!!g&&ya(g)&&hi(S,g)&&(Ne(r)||ki(r)))}function v0(r){var n=r.length,o=new r.constructor(n);return n&&typeof r[0]=="string"&&nt.call(r,"index")&&(o.index=r.index,o.input=r.input),o}function kh(r){return typeof r.constructor=="function"&&!kn(r)?_n(Hs(r)):{}}function m0(r,n,o){var h=r.constructor;switch(n){case De:return Wo(r);case M:case R:return new h(+r);case Ce:return r0(r,o);case He:case Oe:case ke:case We:case et:case tt:case Je:case er:case hr:return Ph(r,o);case Ie:return new h;case Be:case Re:return new h(r);case Me:return i0(r);case Se:return new h;case $e:return n0(r)}}function b0(r,n){var o=n.length;if(!o)return r;var h=o-1;return n[h]=(o>1?"& ":"")+n[h],n=n.join(o>2?", ":" "),r.replace(St,`{
/* [wrapped with `+n+`] */
`)}function w0(r){return Ne(r)||ki(r)||!!(Xu&&r&&r[Xu])}function hi(r,n){var o=typeof r;return n=n??W,!!n&&(o=="number"||o!="symbol"&&io.test(r))&&r>-1&&r%1==0&&r<n}function nr(r,n,o){if(!mt(o))return!1;var h=typeof n;return(h=="number"?pr(o)&&hi(n,o.length):h=="string"&&n in o)?Br(o[n],r):!1}function rc(r,n){if(Ne(r))return!1;var o=typeof r;return o=="number"||o=="symbol"||o=="boolean"||r==null||Er(r)?!0:$t.test(r)||!yt.test(r)||n!=null&&r in ut(n)}function E0(r){var n=typeof r;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?r!=="__proto__":r===null}function ic(r){var n=ca(r),o=v[n];if(typeof o!="function"||!(n in Ye.prototype))return!1;if(r===o)return!0;var h=Qo(o);return!!h&&r===h[0]}function D0(r){return!!Gu&&Gu in r}var I0=Ls?li:bc;function kn(r){var n=r&&r.constructor,o=typeof n=="function"&&n.prototype||dn;return r===o}function Gh(r){return r===r&&!mt(r)}function Wh(r,n){return function(o){return o==null?!1:o[r]===n&&(n!==t||r in ut(o))}}function S0(r){var n=da(r,function(h){return o.size===d&&o.clear(),h}),o=n.cache;return n}function x0(r,n){var o=r[1],h=n[1],g=o|h,m=g<(G|ie|u),S=h==u&&o==j||h==u&&o==b&&r[7].length<=n[8]||h==(u|b)&&n[7].length<=n[8]&&o==j;if(!(m||S))return r;h&G&&(r[2]=n[2],g|=o&G?0:N);var T=n[3];if(T){var L=r[3];r[3]=L?Ah(L,T,n[4]):T,r[4]=L?mi(r[3],_):n[4]}return T=n[5],T&&(L=r[5],r[5]=L?Th(L,T,n[6]):T,r[6]=L?mi(r[5],_):n[6]),T=n[7],T&&(r[7]=T),h&u&&(r[8]=r[8]==null?n[8]:Xt(r[8],n[8])),r[9]==null&&(r[9]=n[9]),r[0]=n[0],r[1]=g,r}function O0(r){var n=[];if(r!=null)for(var o in ut(r))n.push(o);return n}function P0(r){return zs.call(r)}function Yh(r,n,o){return n=Ht(n===t?r.length-1:n,0),function(){for(var h=arguments,g=-1,m=Ht(h.length-n,0),S=H(m);++g<m;)S[g]=h[n+g];g=-1;for(var T=H(n+1);++g<n;)T[g]=h[g];return T[n]=o(S),Kt(r,this,T)}}function Jh(r,n){return n.length<2?r:Hi(r,Nr(n,0,-1))}function C0(r,n){for(var o=r.length,h=Xt(n.length,o),g=fr(r);h--;){var m=n[h];r[h]=hi(m,o)?g[m]:t}return r}function nc(r,n){if(!(n==="constructor"&&typeof r[n]=="function")&&n!="__proto__")return r[n]}var Xh=Qh(bh),Gn=Kd||function(r,n){return Xe.setTimeout(r,n)},sc=Qh(Zg);function Zh(r,n,o){var h=n+"";return sc(r,b0(h,A0(_0(h),o)))}function Qh(r){var n=0,o=0;return function(){var h=Wd(),g=ge-(h-o);if(o=h,g>0){if(++n>=ce)return arguments[0]}else n=0;return r.apply(t,arguments)}}function ha(r,n){var o=-1,h=r.length,g=h-1;for(n=n===t?h:n;++o<n;){var m=qo(o,g),S=r[m];r[m]=r[o],r[o]=S}return r.length=n,r}var el=S0(function(r){var n=[];return r.charCodeAt(0)===46&&n.push(""),r.replace(Ft,function(o,h,g,m){n.push(g?m.replace(Xa,"$1"):h||o)}),n});function Jr(r){if(typeof r=="string"||Er(r))return r;var n=r+"";return n=="0"&&1/r==-te?"-0":n}function Vi(r){if(r!=null){try{return Ms.call(r)}catch{}try{return r+""}catch{}}return""}function A0(r,n){return Pr(be,function(o){var h="_."+o[0];n&o[1]&&!$s(r,h)&&r.push(h)}),r.sort()}function tl(r){if(r instanceof Ye)return r.clone();var n=new Ar(r.__wrapped__,r.__chain__);return n.__actions__=fr(r.__actions__),n.__index__=r.__index__,n.__values__=r.__values__,n}function T0(r,n,o){(o?nr(r,n,o):n===t)?n=1:n=Ht(Le(n),0);var h=r==null?0:r.length;if(!h||n<1)return[];for(var g=0,m=0,S=H(ks(h/n));g<h;)S[m++]=Nr(r,g,g+=n);return S}function N0(r){for(var n=-1,o=r==null?0:r.length,h=0,g=[];++n<o;){var m=r[n];m&&(g[h++]=m)}return g}function R0(){var r=arguments.length;if(!r)return[];for(var n=H(r-1),o=arguments[0],h=r;h--;)n[h-1]=arguments[h];return vi(Ne(o)?fr(o):[o],Wt(n,1))}var $0=Ke(function(r,n){return At(r)?qn(r,Wt(n,1,At,!0)):[]}),F0=Ke(function(r,n){var o=Rr(n);return At(o)&&(o=t),At(r)?qn(r,Wt(n,1,At,!0),me(o,2)):[]}),U0=Ke(function(r,n){var o=Rr(n);return At(o)&&(o=t),At(r)?qn(r,Wt(n,1,At,!0),t,o):[]});function j0(r,n,o){var h=r==null?0:r.length;return h?(n=o||n===t?1:Le(n),Nr(r,n<0?0:n,h)):[]}function L0(r,n,o){var h=r==null?0:r.length;return h?(n=o||n===t?1:Le(n),n=h-n,Nr(r,0,n<0?0:n)):[]}function M0(r,n){return r&&r.length?ra(r,me(n,3),!0,!0):[]}function z0(r,n){return r&&r.length?ra(r,me(n,3),!0):[]}function q0(r,n,o,h){var g=r==null?0:r.length;return g?(o&&typeof o!="number"&&nr(r,n,o)&&(o=0,h=g),Rg(r,n,o,h)):[]}function rl(r,n,o){var h=r==null?0:r.length;if(!h)return-1;var g=o==null?0:Le(o);return g<0&&(g=Ht(h+g,0)),Fs(r,me(n,3),g)}function il(r,n,o){var h=r==null?0:r.length;if(!h)return-1;var g=h-1;return o!==t&&(g=Le(o),g=o<0?Ht(h+g,0):Xt(g,h-1)),Fs(r,me(n,3),g,!0)}function nl(r){var n=r==null?0:r.length;return n?Wt(r,1):[]}function B0(r){var n=r==null?0:r.length;return n?Wt(r,te):[]}function H0(r,n){var o=r==null?0:r.length;return o?(n=n===t?1:Le(n),Wt(r,n)):[]}function K0(r){for(var n=-1,o=r==null?0:r.length,h={};++n<o;){var g=r[n];h[g[0]]=g[1]}return h}function sl(r){return r&&r.length?r[0]:t}function V0(r,n,o){var h=r==null?0:r.length;if(!h)return-1;var g=o==null?0:Le(o);return g<0&&(g=Ht(h+g,0)),hn(r,n,g)}function k0(r){var n=r==null?0:r.length;return n?Nr(r,0,-1):[]}var G0=Ke(function(r){var n=_t(r,ko);return n.length&&n[0]===r[0]?Uo(n):[]}),W0=Ke(function(r){var n=Rr(r),o=_t(r,ko);return n===Rr(o)?n=t:o.pop(),o.length&&o[0]===r[0]?Uo(o,me(n,2)):[]}),Y0=Ke(function(r){var n=Rr(r),o=_t(r,ko);return n=typeof n=="function"?n:t,n&&o.pop(),o.length&&o[0]===r[0]?Uo(o,t,n):[]});function J0(r,n){return r==null?"":kd.call(r,n)}function Rr(r){var n=r==null?0:r.length;return n?r[n-1]:t}function X0(r,n,o){var h=r==null?0:r.length;if(!h)return-1;var g=h;return o!==t&&(g=Le(o),g=g<0?Ht(h+g,0):Xt(g,h-1)),n===n?Ad(r,n,g):Fs(r,Mu,g,!0)}function Z0(r,n){return r&&r.length?yh(r,Le(n)):t}var Q0=Ke(al);function al(r,n){return r&&r.length&&n&&n.length?zo(r,n):r}function e1(r,n,o){return r&&r.length&&n&&n.length?zo(r,n,me(o,2)):r}function t1(r,n,o){return r&&r.length&&n&&n.length?zo(r,n,t,o):r}var r1=ui(function(r,n){var o=r==null?0:r.length,h=No(r,n);return mh(r,_t(n,function(g){return hi(g,o)?+g:g}).sort(Ch)),h});function i1(r,n){var o=[];if(!(r&&r.length))return o;var h=-1,g=[],m=r.length;for(n=me(n,3);++h<m;){var S=r[h];n(S,h,r)&&(o.push(S),g.push(h))}return mh(r,g),o}function ac(r){return r==null?r:Jd.call(r)}function n1(r,n,o){var h=r==null?0:r.length;return h?(o&&typeof o!="number"&&nr(r,n,o)?(n=0,o=h):(n=n==null?0:Le(n),o=o===t?h:Le(o)),Nr(r,n,o)):[]}function s1(r,n){return ta(r,n)}function a1(r,n,o){return Ho(r,n,me(o,2))}function o1(r,n){var o=r==null?0:r.length;if(o){var h=ta(r,n);if(h<o&&Br(r[h],n))return h}return-1}function c1(r,n){return ta(r,n,!0)}function u1(r,n,o){return Ho(r,n,me(o,2),!0)}function h1(r,n){var o=r==null?0:r.length;if(o){var h=ta(r,n,!0)-1;if(Br(r[h],n))return h}return-1}function l1(r){return r&&r.length?wh(r):[]}function f1(r,n){return r&&r.length?wh(r,me(n,2)):[]}function p1(r){var n=r==null?0:r.length;return n?Nr(r,1,n):[]}function d1(r,n,o){return r&&r.length?(n=o||n===t?1:Le(n),Nr(r,0,n<0?0:n)):[]}function g1(r,n,o){var h=r==null?0:r.length;return h?(n=o||n===t?1:Le(n),n=h-n,Nr(r,n<0?0:n,h)):[]}function y1(r,n){return r&&r.length?ra(r,me(n,3),!1,!0):[]}function _1(r,n){return r&&r.length?ra(r,me(n,3)):[]}var v1=Ke(function(r){return Ei(Wt(r,1,At,!0))}),m1=Ke(function(r){var n=Rr(r);return At(n)&&(n=t),Ei(Wt(r,1,At,!0),me(n,2))}),b1=Ke(function(r){var n=Rr(r);return n=typeof n=="function"?n:t,Ei(Wt(r,1,At,!0),t,n)});function w1(r){return r&&r.length?Ei(r):[]}function E1(r,n){return r&&r.length?Ei(r,me(n,2)):[]}function D1(r,n){return n=typeof n=="function"?n:t,r&&r.length?Ei(r,t,n):[]}function oc(r){if(!(r&&r.length))return[];var n=0;return r=_i(r,function(o){if(At(o))return n=Ht(o.length,n),!0}),Io(n,function(o){return _t(r,wo(o))})}function ol(r,n){if(!(r&&r.length))return[];var o=oc(r);return n==null?o:_t(o,function(h){return Kt(n,t,h)})}var I1=Ke(function(r,n){return At(r)?qn(r,n):[]}),S1=Ke(function(r){return Vo(_i(r,At))}),x1=Ke(function(r){var n=Rr(r);return At(n)&&(n=t),Vo(_i(r,At),me(n,2))}),O1=Ke(function(r){var n=Rr(r);return n=typeof n=="function"?n:t,Vo(_i(r,At),t,n)}),P1=Ke(oc);function C1(r,n){return Sh(r||[],n||[],zn)}function A1(r,n){return Sh(r||[],n||[],Kn)}var T1=Ke(function(r){var n=r.length,o=n>1?r[n-1]:t;return o=typeof o=="function"?(r.pop(),o):t,ol(r,o)});function cl(r){var n=v(r);return n.__chain__=!0,n}function N1(r,n){return n(r),r}function la(r,n){return n(r)}var R1=ui(function(r){var n=r.length,o=n?r[0]:0,h=this.__wrapped__,g=function(m){return No(m,r)};return n>1||this.__actions__.length||!(h instanceof Ye)||!hi(o)?this.thru(g):(h=h.slice(o,+o+(n?1:0)),h.__actions__.push({func:la,args:[g],thisArg:t}),new Ar(h,this.__chain__).thru(function(m){return n&&!m.length&&m.push(t),m}))});function $1(){return cl(this)}function F1(){return new Ar(this.value(),this.__chain__)}function U1(){this.__values__===t&&(this.__values__=El(this.value()));var r=this.__index__>=this.__values__.length,n=r?t:this.__values__[this.__index__++];return{done:r,value:n}}function j1(){return this}function L1(r){for(var n,o=this;o instanceof Js;){var h=tl(o);h.__index__=0,h.__values__=t,n?g.__wrapped__=h:n=h;var g=h;o=o.__wrapped__}return g.__wrapped__=r,n}function M1(){var r=this.__wrapped__;if(r instanceof Ye){var n=r;return this.__actions__.length&&(n=new Ye(this)),n=n.reverse(),n.__actions__.push({func:la,args:[ac],thisArg:t}),new Ar(n,this.__chain__)}return this.thru(ac)}function z1(){return Ih(this.__wrapped__,this.__actions__)}var q1=ia(function(r,n,o){nt.call(r,o)?++r[o]:oi(r,o,1)});function B1(r,n,o){var h=Ne(r)?ju:Ng;return o&&nr(r,n,o)&&(n=t),h(r,me(n,3))}function H1(r,n){var o=Ne(r)?_i:oh;return o(r,me(n,3))}var K1=Fh(rl),V1=Fh(il);function k1(r,n){return Wt(fa(r,n),1)}function G1(r,n){return Wt(fa(r,n),te)}function W1(r,n,o){return o=o===t?1:Le(o),Wt(fa(r,n),o)}function ul(r,n){var o=Ne(r)?Pr:wi;return o(r,me(n,3))}function hl(r,n){var o=Ne(r)?pd:ah;return o(r,me(n,3))}var Y1=ia(function(r,n,o){nt.call(r,o)?r[o].push(n):oi(r,o,[n])});function J1(r,n,o,h){r=pr(r)?r:En(r),o=o&&!h?Le(o):0;var g=r.length;return o<0&&(o=Ht(g+o,0)),_a(r)?o<=g&&r.indexOf(n,o)>-1:!!g&&hn(r,n,o)>-1}var X1=Ke(function(r,n,o){var h=-1,g=typeof n=="function",m=pr(r)?H(r.length):[];return wi(r,function(S){m[++h]=g?Kt(n,S,o):Bn(S,n,o)}),m}),Z1=ia(function(r,n,o){oi(r,o,n)});function fa(r,n){var o=Ne(r)?_t:ph;return o(r,me(n,3))}function Q1(r,n,o,h){return r==null?[]:(Ne(n)||(n=n==null?[]:[n]),o=h?t:o,Ne(o)||(o=o==null?[]:[o]),_h(r,n,o))}var ey=ia(function(r,n,o){r[o?0:1].push(n)},function(){return[[],[]]});function ty(r,n,o){var h=Ne(r)?mo:qu,g=arguments.length<3;return h(r,me(n,4),o,g,wi)}function ry(r,n,o){var h=Ne(r)?dd:qu,g=arguments.length<3;return h(r,me(n,4),o,g,ah)}function iy(r,n){var o=Ne(r)?_i:oh;return o(r,ga(me(n,3)))}function ny(r){var n=Ne(r)?rh:Jg;return n(r)}function sy(r,n,o){(o?nr(r,n,o):n===t)?n=1:n=Le(n);var h=Ne(r)?Og:Xg;return h(r,n)}function ay(r){var n=Ne(r)?Pg:Qg;return n(r)}function oy(r){if(r==null)return 0;if(pr(r))return _a(r)?fn(r):r.length;var n=Zt(r);return n==Ie||n==Se?r.size:Lo(r).length}function cy(r,n,o){var h=Ne(r)?bo:e0;return o&&nr(r,n,o)&&(n=t),h(r,me(n,3))}var uy=Ke(function(r,n){if(r==null)return[];var o=n.length;return o>1&&nr(r,n[0],n[1])?n=[]:o>2&&nr(n[0],n[1],n[2])&&(n=[n[0]]),_h(r,Wt(n,1),[])}),pa=Hd||function(){return Xe.Date.now()};function hy(r,n){if(typeof n!="function")throw new Cr(p);return r=Le(r),function(){if(--r<1)return n.apply(this,arguments)}}function ll(r,n,o){return n=o?t:n,n=r&&n==null?r.length:n,ci(r,u,t,t,t,t,n)}function fl(r,n){var o;if(typeof n!="function")throw new Cr(p);return r=Le(r),function(){return--r>0&&(o=n.apply(this,arguments)),r<=1&&(n=t),o}}var cc=Ke(function(r,n,o){var h=G;if(o.length){var g=mi(o,bn(cc));h|=C}return ci(r,h,n,o,g)}),pl=Ke(function(r,n,o){var h=G|ie;if(o.length){var g=mi(o,bn(pl));h|=C}return ci(n,h,r,o,g)});function dl(r,n,o){n=o?t:n;var h=ci(r,j,t,t,t,t,t,n);return h.placeholder=dl.placeholder,h}function gl(r,n,o){n=o?t:n;var h=ci(r,x,t,t,t,t,t,n);return h.placeholder=gl.placeholder,h}function yl(r,n,o){var h,g,m,S,T,L,J=0,X=!1,Q=!1,oe=!0;if(typeof r!="function")throw new Cr(p);n=$r(n)||0,mt(o)&&(X=!!o.leading,Q="maxWait"in o,m=Q?Ht($r(o.maxWait)||0,n):m,oe="trailing"in o?!!o.trailing:oe);function ye(Tt){var Hr=h,pi=g;return h=g=t,J=Tt,S=r.apply(pi,Hr),S}function we(Tt){return J=Tt,T=Gn(Ge,n),X?ye(Tt):S}function qe(Tt){var Hr=Tt-L,pi=Tt-J,Fl=n-Hr;return Q?Xt(Fl,m-pi):Fl}function Ee(Tt){var Hr=Tt-L,pi=Tt-J;return L===t||Hr>=n||Hr<0||Q&&pi>=m}function Ge(){var Tt=pa();if(Ee(Tt))return Ze(Tt);T=Gn(Ge,qe(Tt))}function Ze(Tt){return T=t,oe&&h?ye(Tt):(h=g=t,S)}function Dr(){T!==t&&xh(T),J=0,h=L=g=T=t}function sr(){return T===t?S:Ze(pa())}function Ir(){var Tt=pa(),Hr=Ee(Tt);if(h=arguments,g=this,L=Tt,Hr){if(T===t)return we(L);if(Q)return xh(T),T=Gn(Ge,n),ye(L)}return T===t&&(T=Gn(Ge,n)),S}return Ir.cancel=Dr,Ir.flush=sr,Ir}var ly=Ke(function(r,n){return sh(r,1,n)}),fy=Ke(function(r,n,o){return sh(r,$r(n)||0,o)});function py(r){return ci(r,K)}function da(r,n){if(typeof r!="function"||n!=null&&typeof n!="function")throw new Cr(p);var o=function(){var h=arguments,g=n?n.apply(this,h):h[0],m=o.cache;if(m.has(g))return m.get(g);var S=r.apply(this,h);return o.cache=m.set(g,S)||m,S};return o.cache=new(da.Cache||ai),o}da.Cache=ai;function ga(r){if(typeof r!="function")throw new Cr(p);return function(){var n=arguments;switch(n.length){case 0:return!r.call(this);case 1:return!r.call(this,n[0]);case 2:return!r.call(this,n[0],n[1]);case 3:return!r.call(this,n[0],n[1],n[2])}return!r.apply(this,n)}}function dy(r){return fl(2,r)}var gy=t0(function(r,n){n=n.length==1&&Ne(n[0])?_t(n[0],br(me())):_t(Wt(n,1),br(me()));var o=n.length;return Ke(function(h){for(var g=-1,m=Xt(h.length,o);++g<m;)h[g]=n[g].call(this,h[g]);return Kt(r,this,h)})}),uc=Ke(function(r,n){var o=mi(n,bn(uc));return ci(r,C,t,n,o)}),_l=Ke(function(r,n){var o=mi(n,bn(_l));return ci(r,w,t,n,o)}),yy=ui(function(r,n){return ci(r,b,t,t,t,n)});function _y(r,n){if(typeof r!="function")throw new Cr(p);return n=n===t?n:Le(n),Ke(r,n)}function vy(r,n){if(typeof r!="function")throw new Cr(p);return n=n==null?0:Ht(Le(n),0),Ke(function(o){var h=o[n],g=Ii(o,0,n);return h&&vi(g,h),Kt(r,this,g)})}function my(r,n,o){var h=!0,g=!0;if(typeof r!="function")throw new Cr(p);return mt(o)&&(h="leading"in o?!!o.leading:h,g="trailing"in o?!!o.trailing:g),yl(r,n,{leading:h,maxWait:n,trailing:g})}function by(r){return ll(r,1)}function wy(r,n){return uc(Go(n),r)}function Ey(){if(!arguments.length)return[];var r=arguments[0];return Ne(r)?r:[r]}function Dy(r){return Tr(r,O)}function Iy(r,n){return n=typeof n=="function"?n:t,Tr(r,O,n)}function Sy(r){return Tr(r,I|O)}function xy(r,n){return n=typeof n=="function"?n:t,Tr(r,I|O,n)}function Oy(r,n){return n==null||nh(r,n,Vt(n))}function Br(r,n){return r===n||r!==r&&n!==n}var Py=oa(Fo),Cy=oa(function(r,n){return r>=n}),ki=hh(function(){return arguments}())?hh:function(r){return xt(r)&&nt.call(r,"callee")&&!Ju.call(r,"callee")},Ne=H.isArray,Ay=rr?br(rr):Lg;function pr(r){return r!=null&&ya(r.length)&&!li(r)}function At(r){return xt(r)&&pr(r)}function Ty(r){return r===!0||r===!1||xt(r)&&ir(r)==M}var Si=Vd||bc,Ny=Mr?br(Mr):Mg;function Ry(r){return xt(r)&&r.nodeType===1&&!Wn(r)}function $y(r){if(r==null)return!0;if(pr(r)&&(Ne(r)||typeof r=="string"||typeof r.splice=="function"||Si(r)||wn(r)||ki(r)))return!r.length;var n=Zt(r);if(n==Ie||n==Se)return!r.size;if(kn(r))return!Lo(r).length;for(var o in r)if(nt.call(r,o))return!1;return!0}function Fy(r,n){return Hn(r,n)}function Uy(r,n,o){o=typeof o=="function"?o:t;var h=o?o(r,n):t;return h===t?Hn(r,n,t,o):!!h}function hc(r){if(!xt(r))return!1;var n=ir(r);return n==P||n==l||typeof r.message=="string"&&typeof r.name=="string"&&!Wn(r)}function jy(r){return typeof r=="number"&&Zu(r)}function li(r){if(!mt(r))return!1;var n=ir(r);return n==se||n==fe||n==z||n==dt}function vl(r){return typeof r=="number"&&r==Le(r)}function ya(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=W}function mt(r){var n=typeof r;return r!=null&&(n=="object"||n=="function")}function xt(r){return r!=null&&typeof r=="object"}var ml=Or?br(Or):qg;function Ly(r,n){return r===n||jo(r,n,ec(n))}function My(r,n,o){return o=typeof o=="function"?o:t,jo(r,n,ec(n),o)}function zy(r){return bl(r)&&r!=+r}function qy(r){if(I0(r))throw new Ae(c);return lh(r)}function By(r){return r===null}function Hy(r){return r==null}function bl(r){return typeof r=="number"||xt(r)&&ir(r)==Be}function Wn(r){if(!xt(r)||ir(r)!=je)return!1;var n=Hs(r);if(n===null)return!0;var o=nt.call(n,"constructor")&&n.constructor;return typeof o=="function"&&o instanceof o&&Ms.call(o)==Md}var lc=Gr?br(Gr):Bg;function Ky(r){return vl(r)&&r>=-W&&r<=W}var wl=Rn?br(Rn):Hg;function _a(r){return typeof r=="string"||!Ne(r)&&xt(r)&&ir(r)==Re}function Er(r){return typeof r=="symbol"||xt(r)&&ir(r)==$e}var wn=Li?br(Li):Kg;function Vy(r){return r===t}function ky(r){return xt(r)&&Zt(r)==Pe}function Gy(r){return xt(r)&&ir(r)==Fe}var Wy=oa(Mo),Yy=oa(function(r,n){return r<=n});function El(r){if(!r)return[];if(pr(r))return _a(r)?zr(r):fr(r);if(Fn&&r[Fn])return Od(r[Fn]());var n=Zt(r),o=n==Ie?xo:n==Se?Us:En;return o(r)}function fi(r){if(!r)return r===0?r:0;if(r=$r(r),r===te||r===-te){var n=r<0?-1:1;return n*ee}return r===r?r:0}function Le(r){var n=fi(r),o=n%1;return n===n?o?n-o:n:0}function Dl(r){return r?Bi(Le(r),0,re):0}function $r(r){if(typeof r=="number")return r;if(Er(r))return Y;if(mt(r)){var n=typeof r.valueOf=="function"?r.valueOf():r;r=mt(n)?n+"":n}if(typeof r!="string")return r===0?r:+r;r=Bu(r);var o=eo.test(r);return o||ro.test(r)?Te(r.slice(2),o?2:8):Qa.test(r)?Y:+r}function Il(r){return Yr(r,dr(r))}function Jy(r){return r?Bi(Le(r),-W,W):r===0?r:0}function it(r){return r==null?"":wr(r)}var Xy=vn(function(r,n){if(kn(n)||pr(n)){Yr(n,Vt(n),r);return}for(var o in n)nt.call(n,o)&&zn(r,o,n[o])}),Sl=vn(function(r,n){Yr(n,dr(n),r)}),va=vn(function(r,n,o,h){Yr(n,dr(n),r,h)}),Zy=vn(function(r,n,o,h){Yr(n,Vt(n),r,h)}),Qy=ui(No);function e_(r,n){var o=_n(r);return n==null?o:ih(o,n)}var t_=Ke(function(r,n){r=ut(r);var o=-1,h=n.length,g=h>2?n[2]:t;for(g&&nr(n[0],n[1],g)&&(h=1);++o<h;)for(var m=n[o],S=dr(m),T=-1,L=S.length;++T<L;){var J=S[T],X=r[J];(X===t||Br(X,dn[J])&&!nt.call(r,J))&&(r[J]=m[J])}return r}),r_=Ke(function(r){return r.push(t,Bh),Kt(xl,t,r)});function i_(r,n){return Lu(r,me(n,3),Wr)}function n_(r,n){return Lu(r,me(n,3),$o)}function s_(r,n){return r==null?r:Ro(r,me(n,3),dr)}function a_(r,n){return r==null?r:ch(r,me(n,3),dr)}function o_(r,n){return r&&Wr(r,me(n,3))}function c_(r,n){return r&&$o(r,me(n,3))}function u_(r){return r==null?[]:Qs(r,Vt(r))}function h_(r){return r==null?[]:Qs(r,dr(r))}function fc(r,n,o){var h=r==null?t:Hi(r,n);return h===t?o:h}function l_(r,n){return r!=null&&Vh(r,n,$g)}function pc(r,n){return r!=null&&Vh(r,n,Fg)}var f_=jh(function(r,n,o){n!=null&&typeof n.toString!="function"&&(n=zs.call(n)),r[n]=o},gc(gr)),p_=jh(function(r,n,o){n!=null&&typeof n.toString!="function"&&(n=zs.call(n)),nt.call(r,n)?r[n].push(o):r[n]=[o]},me),d_=Ke(Bn);function Vt(r){return pr(r)?th(r):Lo(r)}function dr(r){return pr(r)?th(r,!0):Vg(r)}function g_(r,n){var o={};return n=me(n,3),Wr(r,function(h,g,m){oi(o,n(h,g,m),h)}),o}function y_(r,n){var o={};return n=me(n,3),Wr(r,function(h,g,m){oi(o,g,n(h,g,m))}),o}var __=vn(function(r,n,o){ea(r,n,o)}),xl=vn(function(r,n,o,h){ea(r,n,o,h)}),v_=ui(function(r,n){var o={};if(r==null)return o;var h=!1;n=_t(n,function(m){return m=Di(m,r),h||(h=m.length>1),m}),Yr(r,Zo(r),o),h&&(o=Tr(o,I|D|O,f0));for(var g=n.length;g--;)Ko(o,n[g]);return o});function m_(r,n){return Ol(r,ga(me(n)))}var b_=ui(function(r,n){return r==null?{}:Gg(r,n)});function Ol(r,n){if(r==null)return{};var o=_t(Zo(r),function(h){return[h]});return n=me(n),vh(r,o,function(h,g){return n(h,g[0])})}function w_(r,n,o){n=Di(n,r);var h=-1,g=n.length;for(g||(g=1,r=t);++h<g;){var m=r==null?t:r[Jr(n[h])];m===t&&(h=g,m=o),r=li(m)?m.call(r):m}return r}function E_(r,n,o){return r==null?r:Kn(r,n,o)}function D_(r,n,o,h){return h=typeof h=="function"?h:t,r==null?r:Kn(r,n,o,h)}var Pl=zh(Vt),Cl=zh(dr);function I_(r,n,o){var h=Ne(r),g=h||Si(r)||wn(r);if(n=me(n,4),o==null){var m=r&&r.constructor;g?o=h?new m:[]:mt(r)?o=li(m)?_n(Hs(r)):{}:o={}}return(g?Pr:Wr)(r,function(S,T,L){return n(o,S,T,L)}),o}function S_(r,n){return r==null?!0:Ko(r,n)}function x_(r,n,o){return r==null?r:Dh(r,n,Go(o))}function O_(r,n,o,h){return h=typeof h=="function"?h:t,r==null?r:Dh(r,n,Go(o),h)}function En(r){return r==null?[]:So(r,Vt(r))}function P_(r){return r==null?[]:So(r,dr(r))}function C_(r,n,o){return o===t&&(o=n,n=t),o!==t&&(o=$r(o),o=o===o?o:0),n!==t&&(n=$r(n),n=n===n?n:0),Bi($r(r),n,o)}function A_(r,n,o){return n=fi(n),o===t?(o=n,n=0):o=fi(o),r=$r(r),Ug(r,n,o)}function T_(r,n,o){if(o&&typeof o!="boolean"&&nr(r,n,o)&&(n=o=t),o===t&&(typeof n=="boolean"?(o=n,n=t):typeof r=="boolean"&&(o=r,r=t)),r===t&&n===t?(r=0,n=1):(r=fi(r),n===t?(n=r,r=0):n=fi(n)),r>n){var h=r;r=n,n=h}if(o||r%1||n%1){var g=Qu();return Xt(r+g*(n-r+ot("1e-"+((g+"").length-1))),n)}return qo(r,n)}var N_=mn(function(r,n,o){return n=n.toLowerCase(),r+(o?Al(n):n)});function Al(r){return dc(it(r).toLowerCase())}function Tl(r){return r=it(r),r&&r.replace(ii,Ed).replace(yo,"")}function R_(r,n,o){r=it(r),n=wr(n);var h=r.length;o=o===t?h:Bi(Le(o),0,h);var g=o;return o-=n.length,o>=0&&r.slice(o,g)==n}function $_(r){return r=it(r),r&&gt.test(r)?r.replace(Ri,Dd):r}function F_(r){return r=it(r),r&&Ut.test(r)?r.replace(Dt,"\\$&"):r}var U_=mn(function(r,n,o){return r+(o?"-":"")+n.toLowerCase()}),j_=mn(function(r,n,o){return r+(o?" ":"")+n.toLowerCase()}),L_=$h("toLowerCase");function M_(r,n,o){r=it(r),n=Le(n);var h=n?fn(r):0;if(!n||h>=n)return r;var g=(n-h)/2;return aa(Gs(g),o)+r+aa(ks(g),o)}function z_(r,n,o){r=it(r),n=Le(n);var h=n?fn(r):0;return n&&h<n?r+aa(n-h,o):r}function q_(r,n,o){r=it(r),n=Le(n);var h=n?fn(r):0;return n&&h<n?aa(n-h,o)+r:r}function B_(r,n,o){return o||n==null?n=0:n&&(n=+n),Yd(it(r).replace(It,""),n||0)}function H_(r,n,o){return(o?nr(r,n,o):n===t)?n=1:n=Le(n),Bo(it(r),n)}function K_(){var r=arguments,n=it(r[0]);return r.length<3?n:n.replace(r[1],r[2])}var V_=mn(function(r,n,o){return r+(o?"_":"")+n.toLowerCase()});function k_(r,n,o){return o&&typeof o!="number"&&nr(r,n,o)&&(n=o=t),o=o===t?re:o>>>0,o?(r=it(r),r&&(typeof n=="string"||n!=null&&!lc(n))&&(n=wr(n),!n&&ln(r))?Ii(zr(r),0,o):r.split(n,o)):[]}var G_=mn(function(r,n,o){return r+(o?" ":"")+dc(n)});function W_(r,n,o){return r=it(r),o=o==null?0:Bi(Le(o),0,r.length),n=wr(n),r.slice(o,o+n.length)==n}function Y_(r,n,o){var h=v.templateSettings;o&&nr(r,n,o)&&(n=t),r=it(r),n=va({},n,h,qh);var g=va({},n.imports,h.imports,qh),m=Vt(g),S=So(g,m),T,L,J=0,X=n.interpolate||rn,Q="__p += '",oe=Oo((n.escape||rn).source+"|"+X.source+"|"+(X===vt?Za:rn).source+"|"+(n.evaluate||rn).source+"|$","g"),ye="//# sourceURL="+(nt.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++_o+"]")+`
`;r.replace(oe,function(Ee,Ge,Ze,Dr,sr,Ir){return Ze||(Ze=Dr),Q+=r.slice(J,Ir).replace(no,Id),Ge&&(T=!0,Q+=`' +
__e(`+Ge+`) +
'`),sr&&(L=!0,Q+=`';
`+sr+`;
__p += '`),Ze&&(Q+=`' +
((__t = (`+Ze+`)) == null ? '' : __t) +
'`),J=Ir+Ee.length,Ee}),Q+=`';
`;var we=nt.call(n,"variable")&&n.variable;if(!we)Q=`with (obj) {
`+Q+`
}
`;else if(Ja.test(we))throw new Ae(f);Q=(L?Q.replace(Vr,""):Q).replace(tr,"$1").replace(ri,"$1;"),Q="function("+(we||"obj")+`) {
`+(we?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(T?", __e = _.escape":"")+(L?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Q+`return __p
}`;var qe=Rl(function(){return rt(m,ye+"return "+Q).apply(t,S)});if(qe.source=Q,hc(qe))throw qe;return qe}function J_(r){return it(r).toLowerCase()}function X_(r){return it(r).toUpperCase()}function Z_(r,n,o){if(r=it(r),r&&(o||n===t))return Bu(r);if(!r||!(n=wr(n)))return r;var h=zr(r),g=zr(n),m=Hu(h,g),S=Ku(h,g)+1;return Ii(h,m,S).join("")}function Q_(r,n,o){if(r=it(r),r&&(o||n===t))return r.slice(0,ku(r)+1);if(!r||!(n=wr(n)))return r;var h=zr(r),g=Ku(h,zr(n))+1;return Ii(h,0,g).join("")}function ev(r,n,o){if(r=it(r),r&&(o||n===t))return r.replace(It,"");if(!r||!(n=wr(n)))return r;var h=zr(r),g=Hu(h,zr(n));return Ii(h,g).join("")}function tv(r,n){var o=k,h=ae;if(mt(n)){var g="separator"in n?n.separator:g;o="length"in n?Le(n.length):o,h="omission"in n?wr(n.omission):h}r=it(r);var m=r.length;if(ln(r)){var S=zr(r);m=S.length}if(o>=m)return r;var T=o-fn(h);if(T<1)return h;var L=S?Ii(S,0,T).join(""):r.slice(0,T);if(g===t)return L+h;if(S&&(T+=L.length-T),lc(g)){if(r.slice(T).search(g)){var J,X=L;for(g.global||(g=Oo(g.source,it(xr.exec(g))+"g")),g.lastIndex=0;J=g.exec(X);)var Q=J.index;L=L.slice(0,Q===t?T:Q)}}else if(r.indexOf(wr(g),T)!=T){var oe=L.lastIndexOf(g);oe>-1&&(L=L.slice(0,oe))}return L+h}function rv(r){return r=it(r),r&&bt.test(r)?r.replace(gi,Td):r}var iv=mn(function(r,n,o){return r+(o?" ":"")+n.toUpperCase()}),dc=$h("toUpperCase");function Nl(r,n,o){return r=it(r),n=o?t:n,n===t?xd(r)?$d(r):_d(r):r.match(n)||[]}var Rl=Ke(function(r,n){try{return Kt(r,t,n)}catch(o){return hc(o)?o:new Ae(o)}}),nv=ui(function(r,n){return Pr(n,function(o){o=Jr(o),oi(r,o,cc(r[o],r))}),r});function sv(r){var n=r==null?0:r.length,o=me();return r=n?_t(r,function(h){if(typeof h[1]!="function")throw new Cr(p);return[o(h[0]),h[1]]}):[],Ke(function(h){for(var g=-1;++g<n;){var m=r[g];if(Kt(m[0],this,h))return Kt(m[1],this,h)}})}function av(r){return Tg(Tr(r,I))}function gc(r){return function(){return r}}function ov(r,n){return r==null||r!==r?n:r}var cv=Uh(),uv=Uh(!0);function gr(r){return r}function yc(r){return fh(typeof r=="function"?r:Tr(r,I))}function hv(r){return dh(Tr(r,I))}function lv(r,n){return gh(r,Tr(n,I))}var fv=Ke(function(r,n){return function(o){return Bn(o,r,n)}}),pv=Ke(function(r,n){return function(o){return Bn(r,o,n)}});function _c(r,n,o){var h=Vt(n),g=Qs(n,h);o==null&&!(mt(n)&&(g.length||!h.length))&&(o=n,n=r,r=this,g=Qs(n,Vt(n)));var m=!(mt(o)&&"chain"in o)||!!o.chain,S=li(r);return Pr(g,function(T){var L=n[T];r[T]=L,S&&(r.prototype[T]=function(){var J=this.__chain__;if(m||J){var X=r(this.__wrapped__),Q=X.__actions__=fr(this.__actions__);return Q.push({func:L,args:arguments,thisArg:r}),X.__chain__=J,X}return L.apply(r,vi([this.value()],arguments))})}),r}function dv(){return Xe._===this&&(Xe._=zd),this}function vc(){}function gv(r){return r=Le(r),Ke(function(n){return yh(n,r)})}var yv=Yo(_t),_v=Yo(ju),vv=Yo(bo);function $l(r){return rc(r)?wo(Jr(r)):Wg(r)}function mv(r){return function(n){return r==null?t:Hi(r,n)}}var bv=Lh(),wv=Lh(!0);function mc(){return[]}function bc(){return!1}function Ev(){return{}}function Dv(){return""}function Iv(){return!0}function Sv(r,n){if(r=Le(r),r<1||r>W)return[];var o=re,h=Xt(r,re);n=me(n),r-=re;for(var g=Io(h,n);++o<r;)n(o);return g}function xv(r){return Ne(r)?_t(r,Jr):Er(r)?[r]:fr(el(it(r)))}function Ov(r){var n=++Ld;return it(r)+n}var Pv=sa(function(r,n){return r+n},0),Cv=Jo("ceil"),Av=sa(function(r,n){return r/n},1),Tv=Jo("floor");function Nv(r){return r&&r.length?Zs(r,gr,Fo):t}function Rv(r,n){return r&&r.length?Zs(r,me(n,2),Fo):t}function $v(r){return zu(r,gr)}function Fv(r,n){return zu(r,me(n,2))}function Uv(r){return r&&r.length?Zs(r,gr,Mo):t}function jv(r,n){return r&&r.length?Zs(r,me(n,2),Mo):t}var Lv=sa(function(r,n){return r*n},1),Mv=Jo("round"),zv=sa(function(r,n){return r-n},0);function qv(r){return r&&r.length?Do(r,gr):0}function Bv(r,n){return r&&r.length?Do(r,me(n,2)):0}return v.after=hy,v.ary=ll,v.assign=Xy,v.assignIn=Sl,v.assignInWith=va,v.assignWith=Zy,v.at=Qy,v.before=fl,v.bind=cc,v.bindAll=nv,v.bindKey=pl,v.castArray=Ey,v.chain=cl,v.chunk=T0,v.compact=N0,v.concat=R0,v.cond=sv,v.conforms=av,v.constant=gc,v.countBy=q1,v.create=e_,v.curry=dl,v.curryRight=gl,v.debounce=yl,v.defaults=t_,v.defaultsDeep=r_,v.defer=ly,v.delay=fy,v.difference=$0,v.differenceBy=F0,v.differenceWith=U0,v.drop=j0,v.dropRight=L0,v.dropRightWhile=M0,v.dropWhile=z0,v.fill=q0,v.filter=H1,v.flatMap=k1,v.flatMapDeep=G1,v.flatMapDepth=W1,v.flatten=nl,v.flattenDeep=B0,v.flattenDepth=H0,v.flip=py,v.flow=cv,v.flowRight=uv,v.fromPairs=K0,v.functions=u_,v.functionsIn=h_,v.groupBy=Y1,v.initial=k0,v.intersection=G0,v.intersectionBy=W0,v.intersectionWith=Y0,v.invert=f_,v.invertBy=p_,v.invokeMap=X1,v.iteratee=yc,v.keyBy=Z1,v.keys=Vt,v.keysIn=dr,v.map=fa,v.mapKeys=g_,v.mapValues=y_,v.matches=hv,v.matchesProperty=lv,v.memoize=da,v.merge=__,v.mergeWith=xl,v.method=fv,v.methodOf=pv,v.mixin=_c,v.negate=ga,v.nthArg=gv,v.omit=v_,v.omitBy=m_,v.once=dy,v.orderBy=Q1,v.over=yv,v.overArgs=gy,v.overEvery=_v,v.overSome=vv,v.partial=uc,v.partialRight=_l,v.partition=ey,v.pick=b_,v.pickBy=Ol,v.property=$l,v.propertyOf=mv,v.pull=Q0,v.pullAll=al,v.pullAllBy=e1,v.pullAllWith=t1,v.pullAt=r1,v.range=bv,v.rangeRight=wv,v.rearg=yy,v.reject=iy,v.remove=i1,v.rest=_y,v.reverse=ac,v.sampleSize=sy,v.set=E_,v.setWith=D_,v.shuffle=ay,v.slice=n1,v.sortBy=uy,v.sortedUniq=l1,v.sortedUniqBy=f1,v.split=k_,v.spread=vy,v.tail=p1,v.take=d1,v.takeRight=g1,v.takeRightWhile=y1,v.takeWhile=_1,v.tap=N1,v.throttle=my,v.thru=la,v.toArray=El,v.toPairs=Pl,v.toPairsIn=Cl,v.toPath=xv,v.toPlainObject=Il,v.transform=I_,v.unary=by,v.union=v1,v.unionBy=m1,v.unionWith=b1,v.uniq=w1,v.uniqBy=E1,v.uniqWith=D1,v.unset=S_,v.unzip=oc,v.unzipWith=ol,v.update=x_,v.updateWith=O_,v.values=En,v.valuesIn=P_,v.without=I1,v.words=Nl,v.wrap=wy,v.xor=S1,v.xorBy=x1,v.xorWith=O1,v.zip=P1,v.zipObject=C1,v.zipObjectDeep=A1,v.zipWith=T1,v.entries=Pl,v.entriesIn=Cl,v.extend=Sl,v.extendWith=va,_c(v,v),v.add=Pv,v.attempt=Rl,v.camelCase=N_,v.capitalize=Al,v.ceil=Cv,v.clamp=C_,v.clone=Dy,v.cloneDeep=Sy,v.cloneDeepWith=xy,v.cloneWith=Iy,v.conformsTo=Oy,v.deburr=Tl,v.defaultTo=ov,v.divide=Av,v.endsWith=R_,v.eq=Br,v.escape=$_,v.escapeRegExp=F_,v.every=B1,v.find=K1,v.findIndex=rl,v.findKey=i_,v.findLast=V1,v.findLastIndex=il,v.findLastKey=n_,v.floor=Tv,v.forEach=ul,v.forEachRight=hl,v.forIn=s_,v.forInRight=a_,v.forOwn=o_,v.forOwnRight=c_,v.get=fc,v.gt=Py,v.gte=Cy,v.has=l_,v.hasIn=pc,v.head=sl,v.identity=gr,v.includes=J1,v.indexOf=V0,v.inRange=A_,v.invoke=d_,v.isArguments=ki,v.isArray=Ne,v.isArrayBuffer=Ay,v.isArrayLike=pr,v.isArrayLikeObject=At,v.isBoolean=Ty,v.isBuffer=Si,v.isDate=Ny,v.isElement=Ry,v.isEmpty=$y,v.isEqual=Fy,v.isEqualWith=Uy,v.isError=hc,v.isFinite=jy,v.isFunction=li,v.isInteger=vl,v.isLength=ya,v.isMap=ml,v.isMatch=Ly,v.isMatchWith=My,v.isNaN=zy,v.isNative=qy,v.isNil=Hy,v.isNull=By,v.isNumber=bl,v.isObject=mt,v.isObjectLike=xt,v.isPlainObject=Wn,v.isRegExp=lc,v.isSafeInteger=Ky,v.isSet=wl,v.isString=_a,v.isSymbol=Er,v.isTypedArray=wn,v.isUndefined=Vy,v.isWeakMap=ky,v.isWeakSet=Gy,v.join=J0,v.kebabCase=U_,v.last=Rr,v.lastIndexOf=X0,v.lowerCase=j_,v.lowerFirst=L_,v.lt=Wy,v.lte=Yy,v.max=Nv,v.maxBy=Rv,v.mean=$v,v.meanBy=Fv,v.min=Uv,v.minBy=jv,v.stubArray=mc,v.stubFalse=bc,v.stubObject=Ev,v.stubString=Dv,v.stubTrue=Iv,v.multiply=Lv,v.nth=Z0,v.noConflict=dv,v.noop=vc,v.now=pa,v.pad=M_,v.padEnd=z_,v.padStart=q_,v.parseInt=B_,v.random=T_,v.reduce=ty,v.reduceRight=ry,v.repeat=H_,v.replace=K_,v.result=w_,v.round=Mv,v.runInContext=U,v.sample=ny,v.size=oy,v.snakeCase=V_,v.some=cy,v.sortedIndex=s1,v.sortedIndexBy=a1,v.sortedIndexOf=o1,v.sortedLastIndex=c1,v.sortedLastIndexBy=u1,v.sortedLastIndexOf=h1,v.startCase=G_,v.startsWith=W_,v.subtract=zv,v.sum=qv,v.sumBy=Bv,v.template=Y_,v.times=Sv,v.toFinite=fi,v.toInteger=Le,v.toLength=Dl,v.toLower=J_,v.toNumber=$r,v.toSafeInteger=Jy,v.toString=it,v.toUpper=X_,v.trim=Z_,v.trimEnd=Q_,v.trimStart=ev,v.truncate=tv,v.unescape=rv,v.uniqueId=Ov,v.upperCase=iv,v.upperFirst=dc,v.each=ul,v.eachRight=hl,v.first=sl,_c(v,function(){var r={};return Wr(v,function(n,o){nt.call(v.prototype,o)||(r[o]=n)}),r}(),{chain:!1}),v.VERSION=s,Pr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){v[r].placeholder=v}),Pr(["drop","take"],function(r,n){Ye.prototype[r]=function(o){o=o===t?1:Ht(Le(o),0);var h=this.__filtered__&&!n?new Ye(this):this.clone();return h.__filtered__?h.__takeCount__=Xt(o,h.__takeCount__):h.__views__.push({size:Xt(o,re),type:r+(h.__dir__<0?"Right":"")}),h},Ye.prototype[r+"Right"]=function(o){return this.reverse()[r](o).reverse()}}),Pr(["filter","map","takeWhile"],function(r,n){var o=n+1,h=o==$||o==le;Ye.prototype[r]=function(g){var m=this.clone();return m.__iteratees__.push({iteratee:me(g,3),type:o}),m.__filtered__=m.__filtered__||h,m}}),Pr(["head","last"],function(r,n){var o="take"+(n?"Right":"");Ye.prototype[r]=function(){return this[o](1).value()[0]}}),Pr(["initial","tail"],function(r,n){var o="drop"+(n?"":"Right");Ye.prototype[r]=function(){return this.__filtered__?new Ye(this):this[o](1)}}),Ye.prototype.compact=function(){return this.filter(gr)},Ye.prototype.find=function(r){return this.filter(r).head()},Ye.prototype.findLast=function(r){return this.reverse().find(r)},Ye.prototype.invokeMap=Ke(function(r,n){return typeof r=="function"?new Ye(this):this.map(function(o){return Bn(o,r,n)})}),Ye.prototype.reject=function(r){return this.filter(ga(me(r)))},Ye.prototype.slice=function(r,n){r=Le(r);var o=this;return o.__filtered__&&(r>0||n<0)?new Ye(o):(r<0?o=o.takeRight(-r):r&&(o=o.drop(r)),n!==t&&(n=Le(n),o=n<0?o.dropRight(-n):o.take(n-r)),o)},Ye.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},Ye.prototype.toArray=function(){return this.take(re)},Wr(Ye.prototype,function(r,n){var o=/^(?:filter|find|map|reject)|While$/.test(n),h=/^(?:head|last)$/.test(n),g=v[h?"take"+(n=="last"?"Right":""):n],m=h||/^find/.test(n);g&&(v.prototype[n]=function(){var S=this.__wrapped__,T=h?[1]:arguments,L=S instanceof Ye,J=T[0],X=L||Ne(S),Q=function(Ge){var Ze=g.apply(v,vi([Ge],T));return h&&oe?Ze[0]:Ze};X&&o&&typeof J=="function"&&J.length!=1&&(L=X=!1);var oe=this.__chain__,ye=!!this.__actions__.length,we=m&&!oe,qe=L&&!ye;if(!m&&X){S=qe?S:new Ye(this);var Ee=r.apply(S,T);return Ee.__actions__.push({func:la,args:[Q],thisArg:t}),new Ar(Ee,oe)}return we&&qe?r.apply(this,T):(Ee=this.thru(Q),we?h?Ee.value()[0]:Ee.value():Ee)})}),Pr(["pop","push","shift","sort","splice","unshift"],function(r){var n=js[r],o=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",h=/^(?:pop|shift)$/.test(r);v.prototype[r]=function(){var g=arguments;if(h&&!this.__chain__){var m=this.value();return n.apply(Ne(m)?m:[],g)}return this[o](function(S){return n.apply(Ne(S)?S:[],g)})}}),Wr(Ye.prototype,function(r,n){var o=v[n];if(o){var h=o.name+"";nt.call(yn,h)||(yn[h]=[]),yn[h].push({name:n,func:o})}}),yn[na(t,ie).name]=[{name:"wrapper",func:t}],Ye.prototype.clone=rg,Ye.prototype.reverse=ig,Ye.prototype.value=ng,v.prototype.at=R1,v.prototype.chain=$1,v.prototype.commit=F1,v.prototype.next=U1,v.prototype.plant=L1,v.prototype.reverse=M1,v.prototype.toJSON=v.prototype.valueOf=v.prototype.value=z1,v.prototype.first=v.prototype.head,Fn&&(v.prototype[Fn]=j1),v},pn=Fd();Ct?((Ct.exports=pn)._=pn,ct._=pn):Xe._=pn}).call(is)})(hu,hu.exports);var _5=Object.defineProperty,v5=Object.defineProperties,m5=Object.getOwnPropertyDescriptors,Yf=Object.getOwnPropertySymbols,b5=Object.prototype.hasOwnProperty,w5=Object.prototype.propertyIsEnumerable,Jf=(i,e,t)=>e in i?_5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Da=(i,e)=>{for(var t in e||(e={}))b5.call(e,t)&&Jf(i,t,e[t]);if(Yf)for(var t of Yf(e))w5.call(e,t)&&Jf(i,t,e[t]);return i},E5=(i,e)=>v5(i,m5(e));function jr(i,e,t){let s;const a=lu(i);return e.rpcMap&&(s=e.rpcMap[a]),s||(s=`${y5}?chainId=eip155:${a}&projectId=${t}`),s}function lu(i){return i.includes("eip155")?Number(i.split(":")[1]):Number(i)}function hd(i){return i.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function D5(i,e){const t=Object.keys(e.namespaces).filter(a=>a.includes(i));if(!t.length)return[];const s=[];return t.forEach(a=>{const c=e.namespaces[a].accounts;s.push(...c)}),s}function I5(i={},e={}){const t=Xf(i),s=Xf(e);return hu.exports.merge(t,s)}function Xf(i){var e,t,s,a;const c={};if(!xn(i))return c;for(const[p,f]of Object.entries(i)){const y=Cu(p)?[p]:f.chains,d=f.methods||[],_=f.events||[],I=f.rpcMap||{},D=xa(p);c[D]=E5(Da(Da({},c[D]),f),{chains:xc(y,(e=c[D])==null?void 0:e.chains),methods:xc(d,(t=c[D])==null?void 0:t.methods),events:xc(_,(s=c[D])==null?void 0:s.events),rpcMap:Da(Da({},I),(a=c[D])==null?void 0:a.rpcMap)})}return c}function S5(i){return i.includes(":")?i.split(":")[2]:i}function x5(i){const e={};for(const[t,s]of Object.entries(i)){const a=s.methods||[],c=s.events||[],p=s.accounts||[],f=Cu(t)?[t]:s.chains?s.chains:hd(s.accounts);e[t]={chains:f,methods:a,events:c,accounts:p}}return e}const ld={},Rt=i=>ld[i],Mc=(i,e)=>{ld[i]=e};class O5{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=Rt("events"),this.client=Rt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||jr(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Ni.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||jr(e,this.namespace);return typeof s>"u"?void 0:new Ai(new Zi(s,Rt("disableProviderPing")))}}class P5{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=Rt("events"),this.client=Rt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){const s=lu(e);if(!this.httpProviders[s]){const a=t||jr(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!a)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,a)}this.chainId=s,this.events.emit(Ni.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const s=t||jr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ai(new Zi(s,Rt("disableProviderPing")))}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const a=lu(t);e[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,s;let a=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const c=parseInt(a,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:a}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}}class C5{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=Rt("events"),this.client=Rt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||jr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(Ni.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||jr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ai(new Zi(s,Rt("disableProviderPing")))}}class A5{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=Rt("events"),this.client=Rt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||jr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Ni.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||jr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ai(new Zi(s,Rt("disableProviderPing")))}}class T5{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=Rt("events"),this.client=Rt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Ni.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const s=this.getCardanoRPCUrl(t);e[t]=this.createHttpProvider(t,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||this.getCardanoRPCUrl(e);return typeof s>"u"?void 0:new Ai(new Zi(s,Rt("disableProviderPing")))}}class N5{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=Rt("events"),this.client=Rt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||jr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(Ni.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||jr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ai(new Zi(s,Rt("disableProviderPing")))}}class R5{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=Rt("events"),this.client=Rt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||jr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(Ni.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||jr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ai(new Zi(s,Rt("disableProviderPing")))}}var $5=Object.defineProperty,F5=Object.defineProperties,U5=Object.getOwnPropertyDescriptors,Zf=Object.getOwnPropertySymbols,j5=Object.prototype.hasOwnProperty,L5=Object.prototype.propertyIsEnumerable,Qf=(i,e,t)=>e in i?$5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Ia=(i,e)=>{for(var t in e||(e={}))j5.call(e,t)&&Qf(i,t,e[t]);if(Zf)for(var t of Zf(e))L5.call(e,t)&&Qf(i,t,e[t]);return i},zc=(i,e)=>F5(i,U5(e));class Fu{constructor(e){this.events=new du,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||Gf})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new Fu(e);return await t.initialize(),t}async request(e,t){const[s,a]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Ia({},e),chainId:`${s}:${a}`,topic:this.session.topic})}sendAsync(e,t,s){this.request(e,s).then(a=>t(null,a)).catch(a=>t(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Nt("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:a}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await a().then(c=>{this.session=c,this.namespaces||(this.namespaces=x5(c.namespaces),this.persist("namespaces",this.namespaces))}).catch(c=>{if(c.message!==cd)throw c;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[s,a]=this.validateChain(e);this.getProvider(s).setDefaultChain(a,t)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(ei(t)){for(const s of t)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await f5.init({logger:this.providerOpts.logger||Gf,relayUrl:this.providerOpts.relayUrl||p5,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>xa(t)))];Mc("client",this.client),Mc("events",this.events),Mc("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const s=D5(t,this.session),a=hd(s),c=I5(this.namespaces,this.optionalNamespaces),p=zc(Ia({},c[t]),{accounts:s,chains:a});switch(t){case"eip155":this.rpcProviders[t]=new P5({namespace:p});break;case"solana":this.rpcProviders[t]=new C5({namespace:p});break;case"cosmos":this.rpcProviders[t]=new A5({namespace:p});break;case"polkadot":this.rpcProviders[t]=new O5({namespace:p});break;case"cip34":this.rpcProviders[t]=new T5({namespace:p});break;case"elrond":this.rpcProviders[t]=new N5({namespace:p});break;case"multiversx":this.rpcProviders[t]=new R5({namespace:p});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:s}=t;if(s.name==="accountsChanged"){const a=s.data;a&&ei(a)&&this.events.emit("accountsChanged",a.map(S5))}else s.name==="chainChanged"?this.onChainChanged(t.chainId):this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var s;const{namespaces:a}=t,c=(s=this.client)==null?void 0:s.session.get(e);this.session=zc(Ia({},c),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",zc(Ia({},Nt("USER_DISCONNECTED")),{data:e.topic}))}),this.on(Ni.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:s,sessionProperties:a}=e;t&&Object.keys(t).length&&(this.namespaces=t),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=a,this.persist("namespaces",t),this.persist("optionalNamespaces",s)}validateChain(e){const[t,s]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,s];if(t&&!Object.keys(this.namespaces||{}).map(p=>xa(p)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&s)return[t,s];const a=xa(Object.keys(this.namespaces)[0]),c=this.rpcProviders[a].getDefaultChain();return[a,c]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){var s;if(!this.namespaces)return;const[a,c]=this.validateChain(e);t||this.getProvider(a).setDefaultChain(c),((s=this.namespaces[a])!=null?s:this.namespaces[`${a}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${Wf}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${Wf}/${e}`)}}const M5=Fu,z5="wc",q5="ethereum_provider",B5=`${z5}@2:${q5}:`,H5="https://rpc.walletconnect.com/v1/",fu=["eth_sendTransaction","personal_sign"],K5=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],pu=["chainChanged","accountsChanged"],V5=["message","disconnect","connect"];var k5=Object.defineProperty,G5=Object.defineProperties,W5=Object.getOwnPropertyDescriptors,ep=Object.getOwnPropertySymbols,Y5=Object.prototype.hasOwnProperty,J5=Object.prototype.propertyIsEnumerable,tp=(i,e,t)=>e in i?k5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ns=(i,e)=>{for(var t in e||(e={}))Y5.call(e,t)&&tp(i,t,e[t]);if(ep)for(var t of ep(e))J5.call(e,t)&&tp(i,t,e[t]);return i},rp=(i,e)=>G5(i,W5(e));function ja(i){return Number(i[0].split(":")[1])}function qc(i){return`0x${i.toString(16)}`}function X5(i){const{chains:e,optionalChains:t,methods:s,optionalMethods:a,events:c,optionalEvents:p,rpcMap:f}=i;if(!ei(e))throw new Error("Invalid chains");const y={chains:e,methods:s||fu,events:c||pu,rpcMap:ns({},e.length?{[ja(e)]:f[ja(e)]}:{})},d=c==null?void 0:c.filter(O=>!pu.includes(O)),_=s==null?void 0:s.filter(O=>!fu.includes(O));if(!t&&!p&&!a&&!(d!=null&&d.length)&&!(_!=null&&_.length))return{required:e.length?y:void 0};const I=(d==null?void 0:d.length)&&(_==null?void 0:_.length)||!t,D={chains:[...new Set(I?y.chains.concat(t||[]):t)],methods:[...new Set(y.methods.concat(a!=null&&a.length?a:K5))],events:[...new Set(y.events.concat(p||V5))],rpcMap:f};return{required:e.length?y:void 0,optional:t.length?D:void 0}}class Uu{constructor(){this.events=new ti.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=B5,this.on=(e,t)=>(this.events.on(e,t),this),this.once=(e,t)=>(this.events.once(e,t),this),this.removeListener=(e,t)=>(this.events.removeListener(e,t),this),this.off=(e,t)=>(this.events.off(e,t),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const t=new Uu;return await t.initialize(e),t}async request(e){return await this.signer.request(e,this.formatChainId(this.chainId))}sendAsync(e,t){this.signer.sendAsync(e,t,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:t,optional:s}=X5(this.rpc);try{const a=await new Promise(async(p,f)=>{var y;this.rpc.showQrModal&&((y=this.modal)==null||y.subscribeModal(d=>{!d.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),f(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(rp(ns({namespaces:ns({},t&&{[this.namespace]:t})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(d=>{p(d)}).catch(d=>{f(new Error(d.message))})});if(!a)return;this.setChainIds(this.rpc.chains);const c=gw(a.namespaces,[this.namespace]);this.setAccounts(c),this.events.emit("connect",{chainId:qc(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:s}=t;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",qc(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",rp(ns({},Nt("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,s;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(s=this.modal)==null||s.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",qc(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,s,a]=e.split(":");return{chainId:`${t}:${s}`,address:a}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,s;const a=(t=e==null?void 0:e.chains)!=null?t:[],c=(s=e==null?void 0:e.optionalChains)!=null?s:[],p=a.concat(c);if(!p.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const f=a.length?(e==null?void 0:e.methods)||fu:[],y=a.length?(e==null?void 0:e.events)||pu:[],d=(e==null?void 0:e.optionalMethods)||[],_=(e==null?void 0:e.optionalEvents)||[],I=(e==null?void 0:e.rpcMap)||this.buildRpcMap(p,e.projectId),D=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:a==null?void 0:a.map(O=>this.formatChainId(O)),optionalChains:c.map(O=>this.formatChainId(O)),methods:f,events:y,optionalMethods:d,optionalEvents:_,rpcMap:I,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:D,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const s={};return e.forEach(a=>{s[a]=this.getRpcUrl(a,t)}),s}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?ja(this.rpc.chains):ja(this.rpc.optionalChains),this.signer=await M5.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:s}=await Vv(()=>import("./index-113c3cf5.js").then(a=>a.i),["assets/index-113c3cf5.js","assets/index-0c2dd713.js","assets/index-1e9ceaf1.css"]);t=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(ns({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:s,rpcMap:a}=e;t&&ei(t)&&(this.rpc.chains=t.map(c=>this.formatChainId(c)),t.forEach(c=>{this.rpc.rpcMap[c]=(a==null?void 0:a[c])||this.getRpcUrl(c)})),s&&ei(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(c=>this.formatChainId(c)),s.forEach(c=>{this.rpc.rpcMap[c]=(a==null?void 0:a[c])||this.getRpcUrl(c)}))}getRpcUrl(e,t){var s;return((s=this.rpc.rpcMap)==null?void 0:s[e])||`${H5}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}const hI=Uu;export{hI as EthereumProvider,V5 as OPTIONAL_EVENTS,K5 as OPTIONAL_METHODS,pu as REQUIRED_EVENTS,fu as REQUIRED_METHODS,Uu as default};
